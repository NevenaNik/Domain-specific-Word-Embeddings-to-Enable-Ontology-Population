Abstract The objective of system safety engineering is to develop a system with no
unreasonable risk. To this end, risks caused by the electrical and/or electronic (E/E)
system that could potentially harm persons must be analyzed, and appropriate risk
reduction measures have to be considered in an early phase of development. This
requires a close collaboration between different engineering disciplines in order to
specify a comprehensive description of risk reduction and mitigation measures—the
safety concept. The international functional safety standard ISO 26262 has to be
considered for the development of E/E systems within road vehicles up to 3.5 tons.
This standard focuses on E/E measures and considers other non-E/E measures only
after the speciﬁcation of the safety concept. In contrast, this chapter proposes a work-
ﬂow for the elaboration of an integrated safety concept including safety measures
from different engineering disciplines. Two main lessons learned were that the con-
sideration of all kinds of risk reduction measures in the concept phase improves
the understanding of the safety of the overall system, and involving various ﬁelds
of expertise enables the development of a clear safety concept. This approach will
improve the development of the overall system, while complying with the require-
ments of ISO 26262 for the development of E/E systems. The applicability of the
introduced approach is demonstrated on an automotive battery case study, where
the inﬂuence of various safety measures on the Automotive Safety Integrity Level
(ASIL) determination has been taken into account in order to reduce the costs of E/E
system development.
Hazardous voltage (HV) battery systems are a central part of battery-powered Electric
Vehicles (EVs) or Hybrid Electric Vehicles (HEVs) [8], which are becoming more
and more important. One reason is the high energy efﬁciency of E/E systems and
the zero (local) environmental pollution of EVs. Their main disadvantage is the rela-
tively short operation range, which is far less competitive compared to conventional
vehicles with internal combustion engines. Conventional vehicles provide good per-
formance and long operating ranges by utilizing the high energy-density advantages
of petroleum fuels. HEVs combine the advantages of both technologies. Some of the
main targets for batteries to be used in HEVs are low costs, high power density (e.g.
1,200 W/kg), very high cycle life time (e.g. 200,000 cycles of charge/discharge),
long life time (e.g. 9 years), and safety. With the growing importance of e-mobility,
automotive battery systems are becoming more important as well. High power (e.g.
HEV up to 250 kW to provide more dynamic driving torques) and high energy appli-
cation (e.g. EVs such as Nissan Leaf 36 kWh to allow longer driving distances) are
already being applied in series-production vehicles. Increasing power and energy
while decreasing the battery geometries leads to an increase of potential critical
effects in the case of malfunctions.

This chapter focuses on safety aspects in the context of safety-critical automotive
batteries for EVs or HEVs. Regarding functional safety (safety of the E/E system),
the IEC 615081 [3] is the basic international functional safety standard applicable to
all industries. The ISO 26262 [4] is an adaptation of this standard that is applicable
to the development of safety-related electrical and/or electronic (E/E) systems in
the automotive domain. One important aspect of functional safety is the potential
risk of electronic malfunction, e.g. malfunction of the battery control unit caused
by incorrect inputs or software errors. These malfunctions could lead to hazardous
events for passengers, other trafﬁc participants, and uninvolved parties (e.g. ﬁre
due to overcharge). The potential of malfunctions has to be lowered by gaining of
possible faults, as well as their causes and effects, and by providing solutions for
fault mitigation.

In particular, e-mobility is highly interdisciplinary, whereby risk reduction also
results from different technical disciplines (e.g. mechanics, chemistry). This means
that system safety has to consist of different safety disciplines as well (i.e. functional,
electrical, mechanical, and chemical safety). One example for electrical safety could
be the prevention of hazardous voltage through the use of galvanic disconnections or
isolation. Mechanical safety aims to prevent the deformation of the battery in the case
of an accident through the use of cell housings or the installation location for example.
Chemical safety can prevent explosions or ﬁre by using a mechanical venting outlet
for toxic gases. All of these measures are applicable for the development of a safe
system.
Functional safety covers one vital part of system safety engineering, but it is
important to realize that other safety measures have to be considered as well. This
chapter discusses some of the main issues regarding the safety of HV automotive
battery systems on different levels of abstraction such as battery cell, battery module
and battery pack.

This chapter is structured as follows: Sect. 1.2.1 starts with an introduction to
the safety lifecycle following ISO 26262. Section 1.2.2 describes the technical back-
ground consisting of the basic architecture of a battery system, together with potential
risks and risk mitigation on different levels of abstraction. To get a better understand-
ing, these safety measures are classiﬁed in Sect. 1.3. Section 1.4 introduces a modiﬁed
workﬂow, which is used to reduce the required Automotive Safety Integrity Level
(ASIL) and thereby also the development costs of the electronic system through
the deﬁnition of non-E/E measures. Section 1.5 concludes the work and provides an
outlook on how the presented work will be continued.

1.2 Technical Background

This section introduces the topic of functional safety in the context of automotive
systems. Furthermore, an overview of an HV battery system architecture is provided,
including several basic safety measures from different engineering disciplines.

1.2.1 Introduction to Functional Safety Following ISO 26262

The ISO 26262 safety lifecycle encompasses the principal safety activities during
the concept phase, product development, production, operation, service and decom-
missioning as illustrated in Fig. 1.1.

Figure 1.1 shows the safety lifecycle and highlights the concept phase and the rel-
evant parts of the product development. The concept phase starts with the deﬁnition
of the system (here called item), followed by a Hazard Analysis and Risk Assess-
ment (HA&RA), in which all identiﬁed hazardous events are evaluated according to
ISO 26262 speciﬁc risk assessment criteria (i.e. severity, exposure and controllabil-
ity). Current hazard analysis techniques can be classiﬁed on a hierarchical structure of
a system in bottom-up (e.g. FMEA) and top-down approaches (e.g. FTA). The most
important, often-cited techniques for performing a hazard analysis are Preliminary
Hazard Analysis [1, 6], Concept Failure Mode and Effects Analysis (Con-FMEA) [2],
and Hazard and Operability study (HAZOP) [5]. By performing the hazard analysis
we identiﬁed the following main hazards of the battery system: ﬁre/explosion, toxic
gases, hazardous voltage of the battery module/pack (U > 60VDC), leakage/venting
of battery cells (corrosive/toxic (e.g. hydroﬂuoric acid)), ﬁre (e.g. ﬂammable mate-
rials) and explosion (e.g. breakdown of cell safety vent).

The result of the risk assessment determines the ASIL, which indicates the risk
of occurrence of a speciﬁc failure mode2 and its necessary degree of avoidance.
ASIL values range from ASIL A (low criticality) to ASIL D (high criticality).3
Depending on the derived ASIL, the ISO 26262 recommends methods for fulﬁlling
the requirements—higher ASIL leads to higher efforts and costs during the product
development.

Based on the results of the HA&RA, safety goals4 are deﬁned for each haz-
ardous event, and the corresponding ASIL is allocated to each of them. The ﬁnal
activity of the concept phase is the elaboration of the Functional Safety Concept,
which deﬁnes safety measures that must be fulﬁlled by the design and development
of the system to avoid an unreasonable residual risk. Safety measures are activities
or technical solutions used to avoid, control or mitigate the harmful effects of sys-
tematic failures and random hardware failures. These technical solutions are imple-
mented by (i) E/E measures (e.g. E/E system with sensor → controller → actuator),
(ii) external measures (e.g. organizational measures to counter technical ﬂaws) or
(iii) other technologies (solutions from other technical domains, e.g. mechanical

2 “failure mode = manner in which an element or an item fails”. [4]
3 The class QM (quality management) denotes no requirement to comply with ISO 26262.
4 Safety goals represent top level safety requirements.

1 Holistic Safety Considerations for Automotive Battery Systems

5

Vehicle

Housing

Battery System

HV-
Fuse

I-
Sensor

BMU

HV-
Disconnection

Electrical Interconnections

Battery Module

CMU

Cell-Connections, 
Cell-Voltage, T-Sensors

y
r
e
t
t
a
B

l
l
e
C

y
r
e
t
t
a
B

l
l
e
C

….

y
r
e
t
t
a
B

l
l
e
C

 

k
c
a
P
y
r
e
t
t
a
B

….

Battery Module
CMU

Cell-Connections, 
Cell-Voltage, T-Sensors

y
r
e
t
t
a
B

l
l
e
C

y
r
e
t
t
a
B

l
l
e
C

….

y
r
e
t
t
a
B

l
l
e
C

Cooling

Cooling

Legend:

LV-wiring (incl. COM)
HV-wiring
LV-Interface
HV-Interface     
Cooling-Interface     
Mounting-Interface     
Service-Lid     
VentGas Outlet     

Fig. 1.2 Battery system architecture—Illustration of the main parts of an automotive battery and
their interrelations

fault-back solution), which detect faults or control failure modes in order to achieve
or maintain a safe state.5

1.2.2 Description of Automotive Battery System Architecture

Figure 1.2 shows a schematic representation of a system architecture of an HV
lithium-ion battery. It consists of the following main components, which already
include or represent basic safety measures:
• Battery Management Unit (BMU): The main functions of the BMU are the
electrical and thermal management, diagnosis functions, insulation monitoring,
and the communication with other parts of the vehicle. Electrical management
includes charge balancing, charge determination, and the provision of status infor-
mation, such as system voltage, system current, or power-time prediction (charg-
ing/discharging) for vehicle control functions. Thermal management functionality
is used to monitor and evaluate the temperature in the battery system. Disconnec-
tion monitoring, charge monitoring, and fault recording represent different diag-
nosis functions. The insulation monitoring in the battery system is a coordinated
function between the battery system and the vehicle.

• HV Disconnection: Its main purpose is the disconnection of the battery system
from the vehicle HV circuit, and it provides a galvanic separation of the battery
and the vehicle in case of deactivation, accident or a safety-critical malfunction.
The HV disconnection consists of special HV contactors for the plus and minus

5 “safe state = operating mode of an item without an unreasonable level of risk of the system”. [4]

6

H. Martin et al.

terminal. For the activation of the system, a speciﬁc pre-charge circuit for both
terminals has to be included to realize a soft connection to the vehicle HV circuit.
In case of an over-current, an emergency shut-off strategy has to be elaborated
because the contactors can only guarantee a limited number of switching cycles
under load over their expected lifetime.

• HV Fuse: In the case of an over-current, the HV Fuse will disconnect the battery
system from the vehicle’s HV circuit. Since an over-current causes the HV Fuse
to be heated strongly, it must be thermally decoupled from other components (in
particular the cells) to prevent a thermal breakdown.

• I-Sensor: The I-Sensor provides the current measurement of the whole vehicle
HV circuit. The measured current value is used as an input for state-of-charge
determination in the BMU and for the thermal management of the battery cells.
Each battery has a speciﬁc current operation range for charge and discharge. The
correct current is measured within this operating range of the battery system with
a speciﬁed accuracy. If the current is lower or higher than the operating range, a
special disconnection strategy has to be implemented with interaction of the HV
Disconnection and the HV Fuse.

• Electrical Interconnections: This includes all kinds of LV (low voltage wiring
including the communication) and HV connections between the battery cell pack
and the relevant E/E components of the battery system.

• Battery Cell Pack: The battery cell pack consists of serial and/or parallel-
connected battery cell modules and the battery cell module interconnection.

– Battery Cell Modules consists of battery cells that are connected in series
and/or parallel and a cell management unit (CMU). The CMU is responsible
for cell charge balancing, measurement of cell voltage and temperature, and the
communication between CMUs in different battery modules as well as between
CMU and BMU. The cell modules contain a number of redundant temperature
sensors to detect areas with critical temperatures. These sensors are connected
with the thermal management in order to prevent critical temperature in the
battery system.

– Battery Cell Module Interconnection includes all electrical, mechanical, and

thermal connections between battery modules.

• Housing and external interfaces: The main purpose of the battery housing is to
protect the battery system from environmental inﬂuences and to protect the driver
from any unintended reaction of the battery system. It prevents people from coming
into contact with any hazardous voltage. Furthermore, the housing couples the
battery system and the vehicle. It has to provide a LV (including communication),
an HV interface and an interface for cooling. The housing should provide vent gas
outlets (vent gas management), in case of an overpressure in the battery system.
For maintenance and repair of the battery system, a service outlet is available. The
mechanical mounting interface connects the battery with the vehicle bodyworks.

1 Holistic Safety Considerations for Automotive Battery Systems

7

1.3 Classiﬁcation and Application of Safety Measures

for Automotive Battery Systems

As mentioned before, it is reasonable to consider different types of measures in
order to achieve a more holistic safety concept. Some of these measures are given
by customer requirements, while others have to be introduced for additional safety
reasons. In this section, we classify them in organizational and technical measures
and show some examples.

1.3.1 Organizational and Technical Safety Measures

This work classiﬁes safety measures in two main categories:
• Organizational safety measures [ORGA] encompass:

Safety-compliant development process: The company-speciﬁc development
process has to cover relevant safety-standard-speciﬁc process activities (e.g
process audits by external bodies).

Review/Inspection/Conﬁrmation: Work products that make up the safety case

have to be checked by independent6 parties.

User safety manuals: Clear and understandable manuals and instructions for
the correct handling of the product in the native language of the end user are
required.

Warning labels and signs indicate potentially critical parts of the system that

could cause harm to people (e.g. vent gas outlet at battery housing).

Training: End users have to be informed/trained how to handle the product (e.g.
correct driver reaction in the case of malfunction of the battery system). Some
kind of safety training is also necessary for ﬁrst responders in the case of an
accident because they should be able to rescue people and should not endanger
themselves.

Transport/Storage Regulations: Test and criteria are deﬁned for transport and
storage-speciﬁc scenarios that have to be approved for the battery cells (UN/
ADR regulations e.g.UN 38.3 [10]).

Periodicity of maintenance: The proper functioning of the different safety mea-
sures has to be guaranteed until the product’s decommissioning. Instructions
for maintenance, repair and decommissioning of the product are deﬁned in the
standards as well.

• Technical safety measures encompass:

Functional safety [FUSA]: Possible malfunctions of the battery system should
be avoided, mitigated, or handled by adequate E/E safety measures (e.g.

6 The degree of independence depends on the safety integrity level, which is deﬁned in the concept
phase.

8

H. Martin et al.

detection of overcharge of battery and disconnect the battery from any external
energy source). This kind of safety measure is explicitly covered by ISO 26262.
In contrast, the following other technical safety measures are referred to as
external measures or other technologies.

Chemical [CHEM]: Any kind of reduction of toxicity of chemical substances
(e.g. chemical proof material, cell chemistry) and mitigating the effects of any
hazardous cell reaction.

Thermal [THER]: Reduction of thermal energy (e.g. cooling of cells).
Electrical [ELEC]: Avoidance of hazardous voltages for customers (e.g. elec-

Mechanical [MECH]: Mechanical construction should prevent or mitigate harm

trical insulation).

caused by external source.

1.3.2 Application of Measures at Battery System Units

Not only the incorporation of different engineering disciplines, but also the investi-
gation and coverage of safety at the appropriate level of detail is important for the
development and production of a safe system (see Fig. 1.2). This section discusses
the different levels of units of an automotive battery system. The investigation starts
from the lowest level (i.e. the cell) and ends with the highest level (i.e. the vehicle
where the battery should be integrated). The battery system is separated into different
units, and examples of safety measures are provided.

Level 4: Battery Cells (BatCel)

This level focuses on all relevant aspects of cell design and structure, cell housing,
possible vent gas outlets, cell behavior during ageing over life cycle of the battery,
and so on.

Sample safety measures:

• [ORGA] Cell production process—Establishment of battery cell production qual-
ity process, to avoid any kind of contamination of the cell during the production
process.

• [CHEM] Cell structure—Choice of chemical cell components (e.g. cathode, elec-

trolyte additives).

• [MECH] Charge Interruption Device—Mechanical construction in the cell. It is
activated if anything causes internal cell pressure to exceed the activation limit
physically, and it will irreversibly disconnect the cell from the circuit.

• [MECH]+[THERM] Thermal management—Cooling and heating of cells, if

needed.

• [ORGA]+[MECH]+[CHEM] Vent gas management—Each battery cell provides

a deﬁned mechanical venting opening in case of a cell defect.

1 Holistic Safety Considerations for Automotive Battery Systems

9

Level 3: Battery Module (BatMod)

The battery module level covers various safety measures for the different interfaces
of the cells to build up a so-called battery cell stack. One argument for the packaging
of cells in modules is the fact that modules can be replaced during maintenance.

Sample safety measures:

• [MECH]+[THERM] Use of materials that absorb thermal energy in the module

(increase of thermal capacity).

• [MECH]+[THERM] Thermal management—Cooling and heating of the cells if

needed

• [ORGA]+[MECH]+[CHEM] Vent gas management—Each battery module pro-

vides a deﬁned mechanical venting opening in case of a cell defect.

• [FUSA] Monitoring of cell balancing—If a fault is detected (e.g. overcharge),

transition to safe state in that situation.

Level 2: Battery Pack (BatPack)

The battery pack encompasses all modules and provides electrical, thermal, and
mechanical connections between them.

Sample safety measures:

needed.

• [MECH]+[THERM] Thermal management—Cooling and heating of the cells if

• [ORGA]+[MECH]+[CHEM] Vent gas management—BatPack combines all vent

gas channels from each BatMod and leads it to the BatSys.

Level 1: Battery System (BatSys)

The battery system contains the battery pack, the housing, the BMU, and other
relevant components. The BMU internally coordinates all parts of the battery and
provides an interface to the E/E system at the vehicle level. It is therefore responsible
for the detection and mitigation of errors from the external system.

Sample safety measures:

• [ORGA]+[MECH]+[CHEM]+[THERM] Fire extinguisher inlet—The BatSys
system should provide an inlet so that the ﬁre brigade could keep the ﬁre at bay
and cool down the battery cells.

• [ORGA]+[MECH]+[CHEM] Vent gas management—BatSys provides a vent gas

outlet at the battery housing for the vehicle.

• [FUSA] The BMU is an E/E system and is responsible for e.g. monitoring of
cell breakdown—If a cell break down is detected by the BMU, several actions
should be triggered: disconnection of battery, increase of cooling, communication
of critical battery fault.

Level 0: Vehicle Level (target integration of battery system)

At the vehicle level, the prerequisites for the correct functioning of the battery system
must be clearly deﬁned. Battery system vendors have to make assumptions about the

10

H. Martin et al.

Malfunction:

Safety Discipline

Level

Overcharge

Safety Measure
Vent gas management
Cell voltage monitoring
Charge Interruption Device (CID) 
Monitoring of cell balancing
Thermal management
Cell internal structure
WARNING of persons AND 
correct reaction of persons

M
E
H
C
x

x

R
E
H
T

C
E
L
E

x

x

x

x
x
x

H
C
E
M
x

x

x
x

d
o
M
t
a
B
-
3
L
x
x

x
x

k
c
a
P
t
a
B
-
2
L
x
x

x

l
e
C
t
a
B
-
4
L
x
x
x

x
x

s
y
S
t
a
B
-
1
L
x
x

x
x

x

H
E
V
-
0
L
x

x

x

A
S
U
F

x

x
x

x

A
G
R
O
x

x

Fig. 1.3 Example for malfunction Overcharge Mapping of safety measure to battery level and
safety disciplines

context in which the battery will be used. These assumptions have to be documented
and considered for use. Appropriate safety measures have to be applied in the vehicle,
in order to prevent malfunctions in the battery.

Sample safety measures:

• [ORGA]+[MECH]+[CHEM]+[ELEC] Fire extinguisher inlet—The ﬁre extin-

guisher inlet of the battery system has to be reachable for the ﬁre brigade.

• [MECH]+[THERM] Thermal management—Cooling and heating of the cells, as

requested by the battery system.

• [ORGA]+[MECH]+[CHEM] Vent gas management—The vehicle must contain

adequate outlet for the vent gas in case of a cell defect.

• [FUSA] Operational Strategy—The vehicle should manage the driving strategy
of the powertrain, and critical situations should be prevented by an overall vehicle
safety concept (e.g. overcharge, over-temperature).

• [FUSA] Warning concept—People in and around the car should be warned by

visual and acoustic signals.

Figure 1.3 shows an example for the malfunction Overcharge. It provides an
overview of possible safety measures and their mapping on the entities of the battery
system and on the different safety disciplines.

1.4 Considering non-E/E Measures in the Concept Phase

So far, we have seen that functional safety is just one aspect that has to be considered
for the development of a safe automotive system. In this section, we describe a mod-
iﬁed version of the ISO 26262 safety workﬂow, which consists of 3 main activities.
Below, these activities and our proposed modiﬁcations are described in more detail

1 Holistic Safety Considerations for Automotive Battery Systems

11

Fig. 1.4 Workﬂow of the concept phase following ISO 26262, including item deﬁnition, hazard
analysis and risk assessment, and the functional safety concept. Note A proof of the controllability
parameter, which is needed during the safety validation, is not illustrated in this ﬁgure

using the example of an HV lithium-ion battery. This work was conducted in an
internal project, and the workﬂow has previously been published in SEAA2013 [7].
The main purpose of the modiﬁed workﬂow is the holistic investigation of safety
measures from different disciplines at an early stage of development. This means that
non-E/E measures are already considered in the concept phase, whereas the original
workﬂow sees them as an add-on in later phases.

Basically, three main activities are considered here, as illustrated in Fig. 1.4: (1)
Item deﬁnition, (2) Hazard Analysis and Risk Assessment, and (3) the design of the
Functional Safety Concept. Below, these activities and the newly introduced iteration
loop are described.

1. Item (system) deﬁnition, the ﬁrst activity in the concept phase, starts with
the deﬁnition of the item—the system, its functions on vehicle level, and its
boundaries to other items. The item in this example is an hazardous voltage

12

H. Martin et al.

(HV) lithium-ion battery. The battery should be used in a Plug-in Hybrid Elec-
tric Vehicle (PHEV) with an installed capacity of 24 Ah. Potential risks of the
lithium-ion battery are hazardous voltage (U > 60VDC), leakage/venting (cor-
rosive/toxic, ﬂammable, explosive), ﬁre, and explosion.
First, all relevant and available data concerning the item (e.g. previous projects,
customer requirements, state-of-the-art, market analysis, etc.) need to be col-
lected and analyzed. The Lithium-Ion Batteries Hazard and Use Assessment
Report [9] provides a very good overview of possible hazards, failure modes
and hazard assessment, applicable standards for the US market, and ﬁre protec-
tion strategies.
It is further necessary to specify non-functional requirements with regard to stan-
dards and legal aspects. In our basic project, we scrutinized several standards
(e.g. ISO 26262 for automotive electric/electronic systems and the ECE R1007
for battery electric vehicles). Based on the results, we created a preliminary
architecture to get a better understanding of the interactions between the vari-
ous parts and to identify functions and malfunctions. Known hazards from other
projects and previous experiences have been considered to verify and complete
the description. All the results of this step are a fundamental input for the fol-
lowing safety activities.

2. The Hazard Analysis and Risk Assessment starts with the analysis of situations
and possible hazards, as identiﬁed in a preliminary hazard analysis. The follow-
ing situation analysis aims to identify all driving situations, and the combination
with possible hazards leads to hazardous events. Driving situations contain all
reasonable combinations of operational, environmental, and weather conditions.
The hazard analysis targets the identiﬁcation of potential hazards for the item
on the top level of the system.
We used a Con-FMEA, a systematic method recommended by ISO 26262, to
identify the potential hazards of the HV battery system. This approach provides
support for traceability, the possibility to verify the completeness of the hazard
analysis, and the extension of the Con-FMEA for other FMEAs in the following
development phases, as shown in Fig. 1.5. This means that the causes of the
failure modes of the Con-FMEA form the new failure modes for the System
FMEA. The connections between the identiﬁed hazards and the different kinds
of failures at different levels of development builds up a complete failure net.
This failure net is a step-by-step reﬁnement in the FMEA, which supports failure
propagation and traceability.
In our example, the hazard and situation analysis resulted in 640 hazardous
events. These hazardous events were identiﬁed by a stepwise combination and
ﬁltering of possible combinations of operational, environmental, and weather
conditions. Finally, the plausibility of each combination was checked. As a
result, we identiﬁed 121 plausible hazardous events, which were then assessed

7 ECE R100—Uniform provisions concerning the approval of vehicles with regard to speciﬁc
requirements for the electric power train.

1 Holistic Safety Considerations for Automotive Battery Systems

13

Fig. 1.5 FMEAs applied on different development levels

according to the risk assessment parameters Severity (S) [S0..S4], Exposure (E)
[E0..E4], and Controllability (C) [C0..C3]. If any of these parameters results in
a “S = 0 OR E = 0 OR C = 0” no safety development is needed—the level QM
(quality management) is sufﬁcient. The rationale behind each classiﬁcation has
to be documented appropriately because it is the basis for the ASIL determina-
tion, according to the risk graph of ISO 26262 (see Table 1.1).
Finally, safety goals have to be speciﬁed depending on the hazardous events and
risk assessment results.
Below, an exemplary classiﬁcation of a hazardous event is shown, where the
vehicle is deactivated:

• Hazardous event: Fire because of internal cell defect during parking situation

(system is deactivated)

• Individuals at risk: Persons around the vehicle (Assumption: There is noone

in the vehicle during the parking situation.)

• Possible harm: Burning of cell could cause hot smoke gas that could lead to
smoke gas contamination and burns of critical injury degree are possible.

• Perception: Unpleasant sweet smell, and visible smoke
• Severity: S2— Severe injuries possible (life-threatening, survival probable)
• Exposure: E4—The vehicle will park every day for a long time in the parking

garage.

• Controllability: C3—Less than 90 % of all drivers or other trafﬁc participants

are usually able, or barely able, to avoid harm.

One main challenge here is the fact that the E/E system of the PHEV is deac-
tivated during parking. For this speciﬁc situation, it is not possible to fulﬁll the
safety goals with E/E measures only because these measures mainly mitigate
hazardous situations during operational modes.

14

Table 1.1 Risk graph for
ASIL determination
according to ISO 26262
[Part3]

H. Martin et al.

Severity class

Probability class Controllability class
C1

C2

C3

S1

S2

S3

E1
E2
E3
E4
E1
E2
E3
E4
E1
E2
E3
E4

QM QM QM
QM QM QM
QM QM A
QM A
B
QM QM QM
QM QM A
B
QM A
A
C
B
QM QM A
B
QM A
C
B
A
D
C
B

We derived the required ASIL for our exemplary hazardous event using the risk
graph (Table 1.1) of ISO 26262 : Severity S2, Exposure E4 and Controllability
of C3 → ASIL C.
The last step is the derivation of safety goals, as in this case “Avoidance or/and
mitigation of hazards caused by internal cell defect.” with the safe state “No ﬁre
outside of the vehicle.”

3. The Functional Safety Concept (FSC) describes the derived safety measures
(see Fig. 1.6) which realize the safety goals. Following ISO 26262, there are three
different types of safety measures (E/E safety measures, other technologies and
external measures). One viable approach to fulﬁll the safety goals in this case is
the consideration of non-E/E measures in order to reduce the required ASIL.
Our modiﬁed workﬂow introduces an additional decision regarding whether or
not it is possible or better to deﬁne non-E/E measures to fulﬁll the safety goals.
If it is, we propose the identiﬁcation of non-E/E safety measures with support
from specialists from other disciplines (e.g. mechanical engineering). They need
to be involved at an early stage of development because, based on their expertise,
external measures and other technologies can be elaborated and considered. An
example of another technology measure for an HV battery is the use of ﬁre-
resistant materials for the battery housing and an external measure could be
a ﬁre detector in the parking garage. All kinds of safety measures have to be
introduced in the FSC as Functional Safety Requirements, which are linked to
the corresponding elements of the Functional Safety Architecture. The main ele-
ments of the identiﬁed E/E measure are a sensor, a processor and an actuator. The
FSC should provide a safety event chain from the detection of critical signals
(sensor) to the processing and correct decision for the safe operation (processor),
and ﬁnally the execution of a safe state (actuator) deﬁned in the top level safety
goal for the speciﬁc hazardous event.

1 Holistic Safety Considerations for Automotive Battery Systems

15

Fig. 1.6 Principle of
functional safety concept
consisting of three types of
safety measures

4. Iterative reﬁnement step, including update of functional safety concept:
After applying the different safety measures, we introduce a feedback step to
repeat the risk assessment with the new conditions. The following measures were
deﬁned for the HV battery example: (1) External measures: Fire detection unit
and ﬁre extinguisher have to be installed in the parking garage, and (2) other
technologies: Fire-resistant housing of the battery system.
The introduction of these measures changes the risk assessment as follows:
• Severity: S1—Light or moderate injuries possible (not life-threatening)
• Rationale for new S: The use of special ﬁre-resistant materials for the
mechanical construction of the housing will reduce the intensity of the harm.
• Controllability: C2—90 % or more of all drivers or other trafﬁc participants

are usually able to avoid harm.

• Rationale for new C: People will be warned by acoustic signals from the ﬁre
detection unit; a ﬁre extinguisher will be available to extinguish the ﬁre; the
ﬁre brigade will be alerted in the case of ﬁre.

This leads to the new rating result of an ASIL A classiﬁcation for the hazardous
event. Lowering the required ASIL from C to A means that the remaining risk
which has to be covered by E/E safety measures is lower, and therefore a less
complex E/E measures and less development effort are needed.
The last step is an update of the functional safety concept. Each introduced
safety measure that contributes to the risk reduction is speciﬁed as functional
safety requirements, which are mapped to the elements of the functional safety
architecture. See Fig. 1.6 for the main parts of the functional safety concept.

1.5 Discussion and Conclusion

This chapter summarized our investigations of functional safety based on ISO 26262
for HV batteries typically used in EVs or HEVs. We presented an approach for
an iterative determination of the required ASIL by applying non-E/E measures. We

16

H. Martin et al.

observed that it is often productive to consider external measures and other technolo-
gies early in the concept phase, and that the incorporation of different engineering
disciplines with different viewpoints helps to improve the safety of the entire system.

Functional Safety ⊆ System Safety

One main observation of this work was that hazards and risks result from different
technical disciplines because e-mobility is highly interdisciplinary. Functional safety
covers one part of this overall system safety. We identiﬁed several other types of safety
that are relevant in this context, i.e. electrical safety (e.g. considering hazardous
voltage), mechanical safety (e.g. concerning the deformation of the battery in the
case of an accident) and chemical safety (e.g. helps to prevent explosion or ﬁre).
One main ﬁnding of this project is the importance of a strong interaction of all these
different safety disciplines in the concept phase, which requires an organizational
safety culture that fosters interaction between different disciplines. Not all hazardous
events can be covered by E/E safety measures alone. Other technologies or external
measures are equally important in order to achieve a safe system state.

Intercultural Aspects

The discussion with other departments results in a more holistic, interdisciplinary
system and safety understanding. It also reveals how each team is able to contribute
to the safety of a system. A discussion at an early stage of the project deﬁnitely
improves the interaction between the different teams. Nevertheless, it has to be kept
in mind that different views include different opinions, and often even contradicting
opinions. All of them are correct in their speciﬁc systems or safety views. This can
result in never-ending discussions, if there is no clear moderation.
We can offer one example of a discussion about the deﬁnition of the safe state of the
system. One common function of the battery is charging. In the case of overcharge,
the engineers responsible for electrical safety deﬁne the protective safe state in any
such case for the electrical system to disconnect the HV battery from the HV net of
the vehicle. This would lead to an undeﬁned operation condition of the vehicle. The
functional safety team must think about any possible driving situations, where an
unintended loss of HV energy could lead to a critical situation. One such situation
could be an overtaking maneuver on a country road, where a signiﬁcant loss of driving
torque could lead to a dangerous situation for the driver or other trafﬁc participants.

Scope of Functional Safety

With a holistic safety view, it is often difﬁcult to deﬁne the responsibilities for dif-
ferent hazards. Sometimes hazards are not directly caused by an E/E failure, but are
an indirect consequence of a malfunctioning E/E system. Regarding the example of
electric or hybrid electric vehicles, it cannot be clearly deﬁned whether or not the
HV battery should be considered only as an E/E system.

Acknowledgments The authors would like to acknowledge the ﬁnancial support of the “COMET
K2—Competence Centres for Excellent Technologies Programme” of the Austrian Federal Ministry
for Transport, Innovation and Technology (BMVIT), the Austrian Federal Ministry of Economy,
Family and Youth (BMWFJ), the Austrian Research Promotion Agency (FFG), the Province of
Styria and the Styrian Business Promotion Agency (SFG).

1 Holistic Safety Considerations for Automotive Battery Systems

17

The research leading to these results has received funding from the ARTEMIS Joint Undertaking
under grant agreements pSafeCer n◦ 269265 and nSafeCer n◦ 295373. Further, the authors would
like to acknowledge APIS GmbH for their support by their software tool, APIS IQ FMEA PRO.


Abstract Finite element battery models used for crash simulation are effective tools
for designing safe, lightweight battery systems for electric and hybrid electric vehi-
cles. This chapter describes the currently available methods for integrating batteries
into full-vehicle crash models and discusses their limitations at the present state of
implementation. Innovative modelling approaches are able to determine the speciﬁc
battery failure modes, such as short circuits and (electrolyte-) leakage. These meth-
ods are discussed and evaluated here based on their future applicability in the vehicle
design process.
Keywords Finite element method · Crash simulation · Battery crash safety · Battery
deformation and failure · Jelly roll

2.1 Introduction

Due to the conventional areas of application for lithium-ion batteries (e.g. mobile
phones or laptops), battery research and the corresponding development of novel
modelling techniques has focussed primarily on goals such as improved capacity,
power and durability. This is also the main expertise of the battery producers and
the associated scientiﬁc community. With the increased application of lithium-ion
batteries in modern electric vehicles (EV) and hybrid electric vehicles (HEV), the
requirement of crash safety has become important. Therefore, the automotive indus-
try requires highly predictable, applicable and efﬁcient methods for simulating bat-
tery deformation and failure in crash test situations.
The demand of electric energy for high vehicle ranges in HEVs and EVs results in
batteries with weights of up to several hundred kilograms and considerable volumes.
Since the deformation of the battery can lead to hazardous situations, one aim of the
current vehicle development is to prohibit any signiﬁcant deformation of the battery
in crash tests. This can only be achieved by tightly restricting the available space for
the battery system and high—but heavy—stiffness of the battery pack.

In order to enable the development of long-range, lightweight EVs, the engineer
needs a better understanding of the battery deformation and failure characteristics, as
well as new simulation tools. These tools must have the same accuracy and reliability
as the numerical vehicle development methods in use today. In this way, it will become
possible to develop structural battery concepts with optimal use of the available space
at minimum weight and with increased crash safety.

2.1.2 Speciﬁc Hazards of Electric Vehicles

Crash safety for batteries means that an accident does not cause dangerous voltages,
vent gas, heat or ﬁres, which could harm the environment, passengers, pedestrians
or rescue teams. This can be accomplished by the battery design itself, together with
structural protection measures implemented during the vehicle integration.

Hazardous voltages of 400–800 V can lead not only to human injury, but also
to short circuits and arcing, which can generate heat and trigger additional failure
modes in the battery system.

Short circuits within the battery cells’ active material or due to contact of con-
ducting components with different potentials can cause electrolyte gas to develop
and can lead to degassing or the leakage of cell-internal ﬂuids. These vent gases and
liquids are ﬂammable and possibly toxic and therefore must not come into contact
with passengers.

The worst-case scenario in the car crash is the combination of vent gas or leaking
ﬂuids and ignition points, such as arcing or hot spots. This combination can lead to
ﬁres and exothermal reactions in the cell itself, with unpredictable consequences for
trapped passengers. As an illustrative example, Fig. 2.1 shows the exothermal reaction
of a single charged lithium-ion metal-oxide cell caused by severe deformation under
laboratory conditions.

2.1.3 Applicable Design Approach for Batteries

In order to design crash-safe batteries for EVs and HEVs, validated and highly
predictive battery models are needed in the development process. They must describe

2 Battery Modelling for Crash Safety Simulation

21

Fig. 2.1 Exothermal reaction of a single charged cell under severe deformation—test conducted
in cooperation with TU Graz, Vehicle Safety Institute

Material and Failure Models

Finite Element 
Models

Crash test 

5 Stars 

Model Evaluation 
+ Post Processing

Mechanical Battery Testing

Mechanical Testing in Cooperation 
with TU Graz, Vehicle Safety Institute

Fig. 2.2 Suggested development approach for validated ﬁnite element battery models used for the
design of crash-safe electric vehicles

deformation, mechanical and electro-chemical failure and have to be applicable in
the current car crash ﬁnite element (FE) models.

Figure 2.2 shows the steps suggested for the development of a validated FE model
of a battery. The ﬁrst step is the mechanical testing of a battery cell. This enables the
build-up of suitable models for the single cell, with characteristic deformation and
failure behaviour. Battery module or pack models can then be created by applying
state-of-the-art FE techniques. The derived models must be validated in specially
designed battery module or pack tests.

22

G. Trattnig and W. Leitgeb

Fig. 2.3 Schematic drawings of the main cell types used in the automotive industry

This chapter describes the boundary conditions of the vehicle development
process, the required tests and the individual steps for the derivation of a battery
model, followed by summary of the current state of the art and recommended further
development.

2.2 Automotive Battery Design

In order to discuss the special task of developing applicable battery crash models for
the automotive industry, it is necessary to describe brieﬂy the build-up and design
parameters of EV and HEV battery packs.

2.2.1 Modularity and Battery Components

Battery cells are the smallest unit in the battery. The three common types are the
cylindrical, the prismatic and the pouch cell, as shown in Fig. 2.3. Due to their sheet
metal casing, cylindrical and prismatic cells have a higher structural integrity than
pouch cells, but they are also heavier. The casing is often made of quite strong
aluminium sheets, in contrast to the polymer, coffee bag like, cover of the pouch cell.
The main component of the cell is the active material, often referred to as jelly

roll.

Other components of a working battery cell are current collectors and termi-
nals, the aforementioned cell casing, spacers and isolators within the casing, and
a safety pressure valve. A lithium-ion cell usually features a voltage of about 2.5–
4.2 V between the two terminals, depending on the chemistry, the load situation and
the state of charge (SoC). Since powerful electric vehicle motors work at voltages
of about 200–800 V to be efﬁcient, several hundred cells in series connection are
needed to provide this elevated voltage. Cells are grouped to modules for several
mainly practical reasons, including relatively low voltages (< 60 volts), sizes and
weights that can be handled by a single worker, and modularity.

2 Battery Modelling for Crash Safety Simulation

23

Fig. 2.4 Drawings of the modular parts of a battery: a single battery cell (left), a battery module
(middle) and the complete battery pack (right)

Modularity helps reduce the amount of different parts within a battery pack and
allows packs to be designed using the same basic modules to handle different energy
content, voltage and designs requirements. The battery pack contains all the cells
and modules of the battery. It also usually contains the cooling part of an environ-
mental system to keep the cells within their admissible temperature limits, a battery
management system (BMS), and its associated hazardous voltage (HV) protection
system. Figure 2.4 shows drawings of the modular parts of a battery.

Since safety is a mandatory requirement, the pack is hermetically closed, with
degassing vents leading possibly dangerous electrolyte gases away from the passen-
ger compartment. The battery system, as the highest integration level, contains the
battery pack and all electrical cables, sockets, and sensors distributed throughout the
vehicle, which are needed to run the battery in the vehicle environment. Thus, within
the battery system, component size spans several orders of magnitude, from single
layer active cell materials of 1/100th of a millimetre thickness to the battery pack of
1–2 m in width and length and several hundred kilograms of weight.

2.2.2 Safety-Relevant Design Parameters

In order to enhance crash safety, dangerous conditions causing short circuits or
contact of cathode and anode due to separator damage must be avoided, as they
can lead to hot spots and subsequent electrolyte decomposition, heat and vent gas
generation. Therefore, one must examine the main inﬂuencing factors that determine
the hazards in the battery and facilitate their consideration during the design process.
The design parameters at the cell level are very much constrained by electro-chemical
design requirements, and the chemical reactivity of the jelly roll or active material
depends strongly on the chemistry used. Soft or hard casing and the form factor [1]
have a strong inﬂuence on the module design and module failure characteristics.
For the battery module or battery pack, the introduction of crash safety features is a
focus of the development. Both crash and transport safety can be improved by the

24

G. Trattnig and W. Leitgeb

Fig. 2.5 Non-standardized crash test with an EV; FE model of the crash test with masked com-
ponents for visibility of the battery under the back seat (left), schematic drawing of the crash with
possible battery positions (right); FE Model courtesy of National Crash Analysis Center (NCAC)

appropriate design of casing, joints and isolators. The aims are to avoid possible
contacts of electric conductors and to restrict the deformation of the battery cell to
uncritical levels.

Finally, the choice of the battery pack geometry and position and the structural
design of the vehicle are the main safety-relevant design parameters when integrating
the battery pack in the vehicle.

For the design, it is a safe way to prohibit any deformation of the battery itself in
order to eliminate the possibility of any hazardous event. Therefore, the batteries are
grouped in structurally stiffened and reinforced compartments in the vehicle, where
no deformation is expected in standardized crash tests (Fig. 2.5).

2.3 Structural Vehicle Design Process Including Batteries

This chapter gives a short overview of the modern structural vehicle design process
and its dependence on FE simulation. The proposed methods are described, and the
performance speciﬁcation for a FE battery model is deﬁned.

Modern vehicles are designed according to many different requirements. Apart
from the obvious ones (e.g. saleability, through exterior and interior design or perfor-
mance and drivability), one very important and legally binding aspect is the vehicle’s
safety performance in an accident, as schematically shown in Fig. 2.5. The focus is
on protecting the individuals involved and reducing accident-related injury. The laws
differ from country to country, but generally the United States (US) FMVSS1 and the
European ECE2 regulations form the basis. On top of these laws, widely accepted

1 FMVSS: Federal Motor Vehicle Safety Standards.
2 ECE: Economic Commission for Europe.

2 Battery Modelling for Crash Safety Simulation

25

consumer test procedures enhance the safety requirements even further. In Europe,
this is the Euro NCAP consortium3 and several smaller national organisations, as
well as companies such as the German ADAC4 or the British Thatcham Research.
Modiﬁed NCAP programs are also used in China, Australia, Brazil, the US and
Japan. In the US, the IIHS5 establishes additional performance criteria. Common to
all these tests is that standardized full-vehicle crash tests that simulate the most com-
mon and dangerous real-world accidents must be performed under strict predeﬁned
conditions in order to rate and compare the vehicles performance regarding vehicle
safety. It is common practice for OEMs to strive for good results in these consumer
tests, as they are widely known and respected.

2.3.1 Standard Approach and Requirements

In order to cope with this variety of requirements from legislative and consumer tests
and to accelerate development time, simulation methods are used throughout the
vehicle design and development process [2]. For structural integrity calculation and
crash simulation, explicit FE methods [3] are normally used. Several crash solvers are
commercially available. The most common ones are Abaqus, LS-Dyna, Pam-Crash
and Radioss.6

Although usually cheaper than full-scale crash tests, crash simulations are limited
by the costs of computer power. Since calculation time in explicit FE solvers depends
on element number and size, only structurally important and necessary components
are normally included in the model. As computer power increases, more detailed and
better results can be obtained. The FE mesh of a full-vehicle model can therefore
easily surpass 2 million calculation nodes and elements, with a characteristic length of
between 2 and 10 mm, with 4–5 mm being the current standard. With the introduction
of detailed battery models, node and element numbers will increase signiﬁcantly.

2.3.2 Batteries in Crash Tests and Crash Simulation

As of 2013, a combination of transportation laws and recommendations7 are used
to rate battery safety in traction-battery-equipped vehicles, and standard crash tests
must also be passed. However, battery cells show uncritical mechanical deformation
potential in specially designed tests. To use this potential, it is necessary to fully
understand the mechanical deformation and failure behaviour of batteries. FE battery

3 NCAP: New Car Assessment Program.
4 ADAC: Allgemeiner Deutscher Automobil-Club e. V.
5 IIHS: Injury Institute for Highway Safety.
6 SIMULIA Abaqus FEA, LSTC LS-Dyna, ESI Group PAM-Crash, Altair Engineering RADIOSS.
7 38.3 Drop Tests [4], FreedomCAR [5], EUCAR hazard levels.

26

G. Trattnig and W. Leitgeb

Fig. 2.6 Picture of a cylindrical cell with an aluminium casing (left), the CAD model of the cell
(middle), and the FE model (right)

models, which must be able to depict this behaviour, are becoming essential for
optimising location and structural reinforcement for an acceptable cell deformation.

2.4 Finite Elements Model of the Battery

The integration of the battery pack in crash-safe electric vehicle development also
means integrating the battery model into the crash simulation, including all compo-
nents that are structurally relevant for the battery. This can be done best by using the
already established explicit ﬁnite element solvers and methods and adapting them
where necessary.

FE solvers for full-scale vehicle crashworthiness simulation are limited by ele-
ment size and time step in order to maintain a manageable model size and thereby
keep the calculation time within manageable limits. Generally, FE models are
derived from complete three-dimensional computer aided design (CAD) models that
accurately represent the real object. Construction drawings can be derived directly
from these CAD models. Generally, an FE geometric model mesh is composed of
one-dimensional bars and links, two dimensional sheet-like structures and three-
dimensional volume components [3]. The reduction of geometric details is one of
the constraints when building an FE model, as details smaller than 4–5 mm are omit-
ted or replaced. As an example, Fig. 2.6 shows the differences between a cylindrical
cell and its CAD and FE models, and Fig. 2.7 shows the individual components of
this cell and the corresponding parts in the FE simulation.8

The mechanical description of all structurally important battery components is
done in the same way as for conventional ones, that is by using a node and element-
based geometry, superimposed with stress-strain curve-based material models. For
the simulation of other current carrying components (e.g. busbars and HV cables),

8 All images of cylindrical cells in this chapter show type 26650 cells (26 mm diameter and 65 mm
length).

2 Battery Modelling for Crash Safety Simulation

27

Fig. 2.7 Picture of the battery cell components of a cylindrical cell with an aluminium casing (left)
and the corresponding parts of the FE model (right)

new methods are needed for the modelling of deformation and failure. For all com-
ponents, suitable material models need to be developed to adequately describe the
mechanical behaviour of the different battery components. The following chapter
describes and discusses the applicable methods.

2.4.1 Modelling of Mechanical Deformation

The basis of an accurate failure evaluation is the modelling of the deformation which
causes the failure. This chapter brieﬂy discusses available methods for the different
battery components.

Battery pack: The main load-bearing component of the pack is the casing, which
should be leak-tight. The casing can be made of sheet steel or lightweight materials
such as aluminium or ﬁbre-reinforced plastics. These materials are also found in the
body-in-white structure, and various plasticity-strain-rate-dependent material models
are available in the crash solvers [6–12]. The elastic deformation of connectors (e.g.
spot welds, rivets or screws) can be modelled by link elements with corresponding
elasticity parameters [7, 11].

Battery module: As in the battery pack, the deformation of the casing, conductors,
isolators and joints can be modelled with standard FE methods. The main difference
is a possible pre-loading of the modules, which is done in order to apply a constant
pressure on the battery cells. This is necessary in order to ensure a high electrochem-
ical lifetime of the active cell material. The pre-loading can inﬂuence the module’s
stiffness signiﬁcantly. In this case, it is necessary to model the pre-loading process
and map the elastic pre-deformation and pre-stresses on the crash model. This can be
done by the available Forming to Crash methods in most common crash solvers [13].
Battery cell: The cell has very strong anisotropic deformation behaviour, as shown
in Fig. 2.8 for a cylindrical cell. Depending on the cell type (Fig. 2.3), the casing can
be important for the battery cell stiffness. Here again, available standard FE methods

28

G. Trattnig and W. Leitgeb

Fig. 2.8 Figure with anisotropic deformation behaviour of cylindrical cells; compression tests
normal to cell axis (solid line) and in cell axis (dashed line) and 3-Point-Bending tests (dotted
line)—test conducted in cooperation with TU Graz, Vehicle Safety Institute

Fig. 2.9 Anisotropic jelly roll deformation of a cylindrical cell without casing; compression normal
to the cell axis (left) and parallel to the cell axis (middle); (right) force versus displacement curves
of normal (solid line) and parallel (dashed line) compression tests

are used to model the cell casing. At this level, relatively small features of the cell
can also be important for their deformation and subsequent failure behaviour (e.g.
current collectors in the cell and details of a cylindrical cell are shown in Fig. 2.13).
Here, it can be necessary to simplify the actual geometry, since an applicable FE
crash net has a mesh size of about 5 mm, as shown for a cylindrical cell in Fig. 2.7.
This can be done if the local deformation effects are understood and taken into
account in the subsequent failure assessment.

The active material, the jelly roll, contributes to the cell stiffness. Depending
on the loading direction, it can be a major load-carrying component with a strong
anisotropic deformation behaviour (shown in Fig. 2.9).

In contrast to the casing materials and joints, the jelly roll itself is a new material
in the crash simulation. Depending on the loading direction, mainly the porous active
material (e.g. graphite, metal oxide or separator) or the conducting electrodes (e.g.
aluminium or copper foils) are compressed and contribute to the cell stiffness.

There are two different approaches to this problem. The bottom-up approach is
based on the idea of modelling the individual layers with their appropriate material

2 Battery Modelling for Crash Safety Simulation

29

Fig. 2.10 Photo of a cylindrical jelly roll with a steel tube in the centre and a diameter of 26 mm
(left), an X-ray tomography image of the cross section (middle) and the associated detailed ﬁnite
element model (right)—X-ray tomography by the Austrian Foundry Research Institute (ÖGI),
Leoben, Austria

behaviour [14]. Figure 2.10 shows cuts through a cylindrical jelly roll and a detailed
model as an example, although not every single layer is modelled, the discretisation
allows the investigation of the microscopic deformation behaviour. The ﬁne mesh,
necessary for this method, leads to high calculation times that are not acceptable for
the crash simulation. Another problem is the measurement of the material data of
the thin metal sheets, the electrolytes, the separator and the porous active material.
Since the measurement is quite complicated, the mechanical properties are partly
unknown or only available for different testing conditions (e.g. higher sheet thick-
nesses or different electrolyte levels). This approach is a more scientiﬁc one, which
is suitable for investigating the deformation mechanisms in the cell and for deriving
the macroscopic deformation behaviour from the jelly roll structure.

One applicable top-down approach is based on a macroscopic model of the jelly
roll [15, 16]. Substitute models are used for the jelly roll in the crash model. For the
parameterization of the model, the anisotropic deformation behaviour is measured by
tests on the jelly roll or on individual battery cells (Fig. 2.11). Available honeycomb
material models [7, 11] offer the ability to deﬁne the stress-versus-strain curves
for each direction separately. The resulting model, which can describe the external
deformation behaviour and deformation forces, is applicable in the crash simulation.
Nevertheless, it does not describe the internal jelly roll deformation mechanisms and
therefore cannot be used for the microscopic failure assessment.

2.4.2 Modelling of Material and Joint Failure

The failure assessment is based on an accurate description of the plastic deformation
of the battery system’s components and on the loads applied to the joints (Fig. 2.12).
The mechanical failure has to be described, since it can lead to leakages (e.g. if the
casing of a cell ruptures) or to a signiﬁcant change in the deformation characteristic
(e.g. if a load carrying component or a joint fails).

30

G. Trattnig and W. Leitgeb

Fig. 2.11 Half ﬁnite element models of cylindrical cells with aluminium casing; compression tests
normal to cell axis (left) and in cell axis (middle) and 3-Point-Bending tests (right)

Fig. 2.12 Deformation and failure of compressed cylindrical cells with aluminium casing; com-
parison of experiment and FE-model wrinkle formation in axial compression (left) and failure of a
joint line in compression normal to the cell axis (right)

Various fracture models are available for describing the failure of metal sheets.
Most of these calculate a damage value based on the plastic strain weighted by
functions of the stress state [11, 17–20]. If the critical areas (e.g. a part of the battery
pack or cell casing) are loaded in tension, they will give quite accurate results.
One still unsolved problem in the applied simulation is the failure due to the fracture
mechanic mode III [21], which means shearing by loading in sheet-normal direction.
This failure mode can appear if a relatively sharp and stiff component, which can
be a part of the battery pack or an intruding object, cuts into the sheet metal and
causes localized failure without major deformation of the surrounding area. This is
a challenging task in crash simulation, and novel element models with promising
solutions are currently under development [11, 22].

For modelling composites and isolators, one must consider that, depending on
the polymers used, they can be more brittle than the sheet metals in use. Due to the
absence of signiﬁcant plastic deformation, stress-based criteria are more suitable for

2 Battery Modelling for Crash Safety Simulation

31

describing that failure mode. New failure models for composites and polymers are
available and are a focus of current development [23, 24]. Here, the application of
Forming to Crash [13] methods is even more important than in sheet metals, since
the local material properties caused by the production process depend signiﬁcantly
on parameters such as local ﬁbre or polymer chain direction [25].

The other main factor for the strength of the battery system is the failure of joints.
Depending on the joining concept, a battery system can contain adhesives, spot welds,
laser welds, screws, or rivets, for example. In recent years, the failure of joints has
been an important research topic in crash simulation. Therefore, various models for
adhesives [26] and single-point connections such as spot welds and screws [27–30]
are available and ready to use (see Fig. 2.12).

For the failure of the jelly roll, as with the non-active battery components, the
failure assessment is based on an accurate description of the deformation. Due to
the jelly roll deformation, internal short circuits—between the electrodes or from
an electrode to the casing—can lead to heat generation and exothermal reactions.
Concerning the deformation modelling, there are two possible approaches to follow.
The ﬁrst approach is the bottom-up or scientiﬁc approach, where detailed FE
models are used to describe failure mechanisms (e.g. the fracture of electrode layers,
critical contacts or delamination—examples shown in Fig. 2.13) [14]. This micro-
scopic approach can support the understanding of the jelly roll failure mechanisms
and the development of suitable macroscopic jelly roll material models. The main
problem remains the measurement of the microscopic material or contact zone para-
meters in tests, which can replicate the conditions in the cell itself. Because various
parameters (e.g. fracture strains and stresses of the electrolyte-soaked active materi-
als and conductor foils) have to be derived e.g. from literature or complex tests, the
simulation results have to be interpreted with great care.

The top-down approach, which is applicable in the crash simulation, assesses
failure by the observed macroscopic deformation of the jelly roll. This deformation
and the related electromechanical failure can be tested and measured quite accurately,
compared to the underlying microscopic mechanisms. Thus, based on a series of
tests with deformations similar to the crash loading, a failure model for a cell can be
parameterized. This failure model can be implemented in the jelly roll material model
(e.g. based on FE element stresses and strains) or evaluated in the post-processing
process, e.g. critical outer deformations (see Fig. 2.14). The disadvantage is that this
failure model is not a general solution, but rather is only valid for the speciﬁc cell
type and loading conditions tested.

2.4.3 Modelling of Electrical Contact and Leakage

The jelly roll modelling introduced the ﬁrst failure models, which are not imple-
mented in standard FE solvers yet. However, these are not the only failure mech-
anisms that are currently lacking appropriate modelling techniques. The three

32

G. Trattnig and W. Leitgeb

Fig. 2.13 X-ray tomography cross sectional images of cylindrical cell with a diameter of 26 mm of
an un-deformed cell (left), a cell compressed normal to the cell axis (middle) and a cell deformed
in a 3-Point Bending test (right)—X-ray tomography by the Austrian Foundry Research Institute
(ÖGI), Leoben, Austria

Fig. 2.14 Failure assessment of a cylindrical cell under compression based on the outer deforma-
tion; the colours indicate the criticality from green (uncritical) to yellow (critical) to red (failure)

additional main failure mechanisms are electric potential carryover, short circuits
and leakage.

Hazardous voltages can emerge on bare conductive parts due to potential carry-
over, which is caused by contact with conductors following the crash deformation.
Therefore, a risk analysis based on the components’ potential difference and the
contact situation is necessary.

In addition, short circuits due to failure of isolators and insulating layers are
hazardous. For example, internal cell contacts from current conductors and casing,

2 Battery Modelling for Crash Safety Simulation

33

Fig. 2.15 Sketch of different possible short circuit situations between a battery cell and a conductive
non-isolated metal impactor; short circuit between non-isolated can and blunted impactor without
apparent force F0 (left), isolated can and blunted impactor with high contact force F1 (middle), and
isolated can and sharp impactor with low contact force F2 (right)

or an electrical contact between conductors and cell casing (see Fig. 2.15) can cause
short circuits, which can lead to heat generation and exothermal reactions. To evaluate
this risk, a detailed analysis of the contact situation in the FE simulation is mandatory,
for example by evaluating the local pressures, taking into account the real local
geometry (e.g. sharp edges) and the component’s relative displacement. This difﬁcult
assessment of critical pressures and local geometries is not currently available in the
crash solvers. Until detailed electrical contact models become available, a suitable
post processing analysis is necessary.

Another hazard relevant for the post-crash safety analysis is the leakage of toxic
electrolyte ﬂuids and gas [31]. In order to ensure the sealing of the battery system,
it is necessary to assess the integrity of the battery cell and pack casing. This can
be done with methods for modelling the failure of the casings and joints such as
laser welds, as discussed in Sect. 2.4.2, and an evaluation of the deformation and
functionality of the seals and safety valves [32].

2.5 Conclusion

The crash safety requirements for lithium-ion batteries are currently met by avoiding
any severe deformation on the battery pack, which is accomplished by limiting the
available battery space in the car and by heavy structural protection measures in the
vehicle.

This stands in strong contradiction to the design goal of increasing the range
of electric vehicles by introducing high battery capacities and lightweight design.
Thus, it is only possible to achieve this goal by allowing uncritical deformation to the
battery (i.e. no heavy-weight battery packs and stiff components) and by developing
new car concepts (i.e. optimal use of the available space).

34

G. Trattnig and W. Leitgeb

Therefore, it is mandatory to develop reliable ﬁnite element deformation and
failure models of the battery for the vehicle design process. This chapter has shown
that the FE methods currently available and in use are able to describe the deformation
and failure behaviour of the classic body-in-white structures and materials, such as
the battery pack and module casing or the joints. Nevertheless, important tools are still
missing, such as special material models for the deformation and electromechanical
failure of the jelly roll, or electrical contact models for the assessment of local contact
situations.

Since ongoing research and further development of ﬁnite element battery models
is already showing promising results, these methods should soon become a standard
tool in the vehicle development process.

Acknowledgments The authors would like to acknowledge the ﬁnancial support of the “COMET
K2—Competence Centres for Excellent Technologies Programme” of the Austrian Federal Ministry
for Transport, Innovation and Technology (BMVIT), the Austrian Federal Ministry of Economy,
Family and Youth (BMWFJ), the Austrian Research Promotion Agency (FFG), the Province of
Styria and the Styrian Business Promotion Agency (SFG).


Abstract Lithium-ion batteries play an ever-increasing role in our daily life.
Therefore, it is important to understand the potential risks involved with these
devices. In this work we demonstrate the thermal runaway characteristics of three
types of commercially available lithium-ion batteries with the format 18650. The
lithium-ion batteries were deliberately driven into thermal runaway by overheat-
ing under controlled conditions. Cell temperatures up to 850 ◦C and a gas release
of up to 0.27 mol were measured. The main gas components were quantiﬁed with
gas-chromatography. The safety of lithium-ion batteries is determined by their
composition, size, energy content, design and quality. This work investigated the
inﬂuence of different cathode-material chemistry on the safety of commercial
graphite-based 18650 cells. The active cathode materials of the three tested cell
types were (a) LiFePO4, (b) Li(Ni0.45Mn0.45Co0.10)O2 and (c) a blend of LiCoO2
and Li(Ni0.50Mn0.25Co0.25)O2.
Keywords Lithium-ion battery · Thermal runaway · Gas analysis

3.1 Introduction

Lithium-ion batteries have been commercially available since 1991 [12]. As of 2013,
lithium-ion batteries are in wide use for portable electronics, such as cell phones and
notebook computers. They are also gaining traction as a power source in electri-
ﬁed vehicles. Lithium-ion batteries have a high speciﬁc energy and favourable age-
ing characteristics compared to NiMH and lead acid batteries. However, there are
concerns regarding the safety of lithium-ion batteries. Abuse conditions such as over-
charge, over-discharge and internal short-circuits can lead to battery temperatures
far beyond the manufacturer ratings. At a critical temperature, a chain of exother-
mic reactions can be triggered. The reactions lead to a further temperature increase,
which in turn accelerates the reaction kinetics. This catastrophic self-accelerated
degradation of the lithium-ion battery is called thermal runaway [17].

During thermal runaway, temperatures as high as 900 ◦C can be reached [6], and
the battery can release a signiﬁcant amount of burnable and (if inhaled in high concen-
trations) toxic gas [13]. To quantify possible hazards of exothermic lithium-ion bat-
tery over-temperature reactions, tests with complete batteries should be performed.
Such experiments were undertaken with commercial lithium-ion batteries produced
for consumer electronics [2, 4, 6–8, 10, 13, 15, 16] and with lithium-ion batteries
fabricated in the laboratory [1, 3, 5, 11, 14].

This work investigated the thermal stability of three types of commercially avail-
able lithium-ion batteries for consumer electronics. Particular attention was given to
(1) the dynamics of the thermal responses of the cells, (2) the maximum tempera-
tures reached, (3) the amount of gases produced and (4) to the production rates of
the gases. To further assess the hazard potential of the released gases, samples were
taken and analysed with a gas chromatography system.

3.2 Experimental

3.2.1 Brief Description of the Test Rig

To carry out unrestricted thermal-runaway experiments, a custom-designed test stand
was built (Fig. 3.1). The main component of the test rig is a heatable reactor with
electric feedthroughs for the temperature measurement and the inner sample heat-
ing. The reactor has gas feedthroughs that connect it to an inert gas ﬂask, to a gas
sampling station and to a cold trap with an attached vacuum pump. The pressure
inside the reactor is recorded by a pressure transmitter. The whole structure is hosted
inside a fume hood to prevent any escaping of gases and electrolyte vapours. A
removable sample holder is placed inside the reactor. The sample holder consists of
a metal structure, which houses a heating sleeve and the thermocouples. A lithium-
ion battery with the dimensions 18650 (cylindrical geometry with d = 18 mm and
l = 65 mm) can be ﬁtted into the centre of the heating sleeve. The inside wall of the
heating sleeve is thermally insulated. The role of the thermal insulation layer is to
provide the thermal connection between the heating sleeve and the sample. Due to
the low thermal conductivity of the insulation layer, a thermal runaway reaction can
proceed in adiabatic-like conditions. Ten thermocouples measure the temperature at
different positions inside the reactor: three thermocouples are directly attached to
the sample housing, three thermocouples are attached to the heating sleeve and four
thermocouples measure the gas temperature inside the reactor.

3 Thermal Runaway

(a)

39

(b)

Fig. 3.1 a The reactor and its principal elements. b The reactor is the main component of the test
stand

3.2.2 Testing Method

Initially, the sample battery is CC/CV charged to the respective cut-off voltage.
Then, the plastic envelope is removed from the cell and the cell mass and cell voltage
are recorded. Three thermocouples are welded to the cell housing, and the whole
package is inserted into the heating sleeve of the sample holder. The sample holder is
placed inside the reactor. The reactor is evacuated and ﬂushed with argon gas twice.
The heaters are set to constant power, and the pressure and temperature signals are
recorded. In order to trace fast temperature and pressure changes, each signal is
recorded with a high sampling rate of 5000 samples per second.

When a critical temperature is reached, the cell goes into rapid thermal runaway:
it produces gas and heat. During the thermal runaway, the temperature of the cell
increases by several hundred degree Celsius in a few seconds. After the thermal-
runaway event, the cell cools down slowly. Gas samples are taken and analysed with
the gas chromatograph. In the next step, the vacuum pump is switched on, and the
cooling trap is ﬁlled with liquid nitrogen. The gas is carefully released through the
cooling trap and the vacuum-pump into the fume hood. The reactor and the gas
tubes between the reactor and the cooling trap are heated above 130 ◦C to avoid gas
condensation.

By following this procedure, most liquid residue in the reactor is passed from the
reactor to the cooling trap. The liquid residue can be easily removed from the cooling
trap before the next experiment run.

40

A. W. Golubkov and D. Fuchs

3.2.3 Gas Analysis

The compositions of the sampled gases were analysed using a gas chromatograph
(GC, Agilent Technologies 3000 Micro GC, two columns, Mol Sieve and PLOTU).
A thermal conductivity detector (TCD) was used to detect permanent gases. The GC
was calibrated for H2, O2, N2, CO, CO2, CH4, C2H2, C2H4 and C2H6. Ar and He
were used as carrier gases.

Note, that the current test set-up cannot detect HF, which can be a major source

of toxicity of gas released by lithium-ion batteries during thermal runaway [13].

3.2.4 Cell-Components Identiﬁcation

In order to identify the components of each cell species, several cells were disas-
sembled: the cells were discharged to 2.0 V, and the cell casings were then carefully
removed without causing short circuits. The exposed jelly rolls were subject to several
tests.

For electrolyte identiﬁcation, the jelly rolls were immersed in ﬂasks with CH2Cl2
solution immediately after casing removal. The solutions were then analysed using a
gas-chromatography—mass spectrometry system (GC-MS: Agilent 7890 and MS
5975MSD) with the ChemStation software and the NIST spectrum library. To
analyse the solid materials of the cells, the extracted jelly rolls were separated into
the anode, cathode and separator layers. After drying in a chemical fume hood,
anode and cathode-foil samples were taken for identiﬁcation of the electrochemi-
cally active materials. Microwave-assisted sample digestion followed by inductively
coupled plasma optical emission spectrometry (ICP-OES, Ciros Vision EOP, Spectro,
Germany) was used to obtain the gross atomic compositions of the cathode active
masses. A scanning-electron microscope with energy-dispersive X-ray spectroscopy
(SEM/EDX: Zeiss Ultra55 and EDAX Pegasus EDX) was used to conﬁrm the ICP-
OES results for the compositions of the cathodes and to validate the anode materials.
For the mass-split calculation, the following procedure was followed for each cell
type: Positive and negative electrode samples were extracted from the jelly roll. The
samples were rinsed with diethyl carbonate (DEC) and then dried again, in order to
remove the remaining electrolyte residues from the active materials. The samples
were weighed, and the geometries of the electrode foils were recorded, so that the
mass split could be calculated. The amount of electrolyte was estimated as the mass
difference between the initial cell mass and the calculated dry mass for each cell.
The thickness of the active material layers on the electrode substrates was extracted
from SEM images. The thicknesses of the aluminium and copper substrates were
calculated from the measured area density. The thickness of the separator foils was
measured with a micrometer.

3 Thermal Runaway

3.2.5 Lithium-Ion Cells

41

18650 consumer cells with three types of chemistry were purchased for the experi-
ments. The cells were produced by three well-known companies. For simplicity, the
samples will be referred to as LFP, NMC and LCO/NMC cells, in order to reﬂect their
respective cathode material. Despite the simple naming scheme, please note that the
cells do not differ in the types of their cathode material alone. Naturally, they also
have different layer geometries (Table 3.2) and different ratios of their component
masses (Fig. 3.2), and there are differences in the composition of the active masses
as well (Table 3.1).

• The LCO/NMC cell had a blended cathode with two types of electrochemically
active particles LiCoO2 and Li(Ni0.50Mn0.25Co0.25)O2. A clean cut through the
sample was done with a focused ion beam (FIB). Subsequently, EDX measure-
ments of the bulk materials of individual cathode particles were performed. The
ratio of LCO and NMC layered oxide particles was estimated by comparing
the SEM-EDX and ICP-OES results. The resulting ratio of LCO and NMC was
LCO:NMC = (66:34) with 5 % uncertainty. The cells with LCO/NMC blended
cathodes are a compromise to achieve high rate capability of LCO material and
to maintain acceptable safety and high capacity of the NMC material [9]. The
average voltage of this cell was ∼3.6 V.

• The NMC cell had a Li(Ni0.45Mn0.45Co0.10)O2 layered oxide cathode. The proper-
ties of the NMC mixed oxide cathodes depended on the ratios of nickel, manganese
and cobalt material. In general, NMC cells have an average voltage of ∼3.6 V and
high speciﬁc capacity [18] .

• The LFP cell had a LiFePO4 cathode with olivine structure. This cathode type
is known for featuring good safety characteristics. Commercial LiFePO4 cathode
material for high power lithium-ion batteries consists of carbon-coated LiFePO4
nano-scale particles. The cathode material is readily available and non-hazardous.
Commercially available LFP cells have a lower operating voltage (∼3.3 V) than
cells with LCO and NMC cathodes [18].

The active anode materials consisted only of carbonaceous material for all cells, as
veriﬁed by SEM/EDX. The exact types of graphite materials could not be identiﬁed.

3.2.6 Electrical Characterisation

An electrical characterisation of the cells was done with a BaSyTec CTS cell test
system. In the ﬁrst step, the cells were discharged to their respective minimum volt-
age. In the second step, the cells were charged using a pulse-pause protocol, until the
voltage of the cells stayed above their respective maximum voltage during a pause.
The current pulses were set to 100 mA and 30 s. The duration of the pauses was set
to 50 s. The open-circuit voltage (OCV) at the end of each pause and the charge

42

A. W. Golubkov and D. Fuchs

Table 3.1 Overview of the three cells species used in the experiments. All ratios in this table are
given as mol ratios. The electrolyte solvents are dimethyl carbonate (DMC), ethyl methyl carbonate
(EMC), ethylene carbonate (EC) and propylene carbonate (PC)

Cell mass
Capacity
Minimal voltage
Maximal voltage
Solvents (DMC:EMC:EC:PC)
Cathode material
Anode material

g
Ah
V
V

LCO/NMC

NMC

LFP

44.3
2.6
3.0
4.2
6:2:1:0
2/3 LCO + 1/3 NMC(211)
Graphite

43.0
1.5
3.0
4.1
7:1:1:1
NMC(992)
Graphite

38.8
1.1
2.5
3.5
4:2:3:1
LiFePO4
Graphite

Table 3.2 Mass (m), area (A), thickness (d) and volume (V ) of the main components of the three
cell species. The geometrical volume of a standard 18650 cell is 16.5 cm3

LCO/NMC

m
g

A
d
cm2 µm cm3

V

m
g

NMC
A
d
cm2 µm cm3

V

1.2
1.7

942 19
Separator
Cathode Al foil
403 16
Cathode active material 18.3 715 91
402 8
Anode Cu foil
Anode active material
739 81
Electrolyte
Housing
Sum

2.9
8.1
4.6
7.5
44.3

1.8
0.6
6.5
0.3
6.0

15.2

944 23
1.4
3.1
389 30
11.3 654 67
418 20
7.5
6.2
695 60
4.4
9.2
43.1

2.2
1.1
4.4
0.8
4.2

12.7

LFP
A
d
cm2 µm cm3

V

940 20
396 19
793 70
396 17
793 50

1.9
0.7
5.5
0.7
4.0

12.8

m
g

1.2
2.1
9.7
3.9
5.2
6.4
10.5
39.0

capacity were recorded (Fig. 3.3). For the NMC cell, the cell manufacturer did not
provide the voltage ratings. For safety reasons, 4.1 V was selected as the maximum
voltage.

3.3 Results and Discussion

3.3.1 Typical Course of a Thermal Runaway Experiment

In order to illustrate the events during the heat-up process and the thermal runaway
itself, one experiment with a NMC cell is described here in detail:

The NMC sample cell was prepared as described above. At the start of the test,
the cell heater sleeve was set to constant heating power. The sample was slowly
heated, starting at 25 ◦C, with a heat-rate of ∼2 ◦C/min. After reaching 220 ◦C, the
cell went into rapid thermal runaway. The cell temperature rose from 220 to 687 ◦C
in a few seconds. When the exothermic reaction ended, the cell cooled down slowly
(Fig. 3.4a).

3 Thermal Runaway

43

LCO/NMC

separator
3%

cathode Al foil
4%

NMC

separator

3% cathode Al foil

7%

housing
17%

electrolyte
10%

anode active
material
18%

cathode active
material
41%

housing
22%

electrolyte
10%

anode active
material
15%

cathode active
material
26%

anode Cu foil
7%

LFP

separator

3% cathode Al foil

6%

anode Cu foil
17%

housing
27%

electrolyte
16%

cathode active
material
25%

anode active
material
13%

anode Cu foil
10%

Fig. 3.2 Mass split (mass %) of the main components of the three cell species

Fig. 3.3 OCV proﬁles of the
three cell species

)

V

(
 
e
g
a
t
l
o
v

4.2

4

3.8

3.6

3.4

3.2

3

0

0.5

1

1.5

2

2.5

capacity (Ah)

LCO/NMC
NMC
LFP

44

A. W. Golubkov and D. Fuchs

Fig. 3.4 a Temperature versus time plot of all temperature sensors in the pressure vessel. The whole
duration of the experiment is shown. b Amount of produced gas versus time plot. Cell temperature
is shown in arbitrary units. c Temperature rate of the cell versus cell temperature. Overview of a
whole experiment duration. d Temperature rate of the cell versus cell temperature. The straight lines
are ﬁtted to the heat-up stage and to the quasi-exponential stage. The intersection of the two lines
marks the onset point θo of the thermal runaway reaction. A sharp increase in the temperature rate
marks the onset of the rapid thermal runaway θr

The amount of gas produced inside the pressure vessel was calculated by applying

the ideal gas law:

n = pV
Rθgas

− n0

(3.1)

where p is the recorded pressure in the reactor, V = 0.0027 m3 is the reactor volume,
R is the gas constant, θgas is the recorded gas temperature in the reactor (in K), and
n0 is the initial amount of gas in the reactor at the start of the experiment.

At 160 ◦C, the safety vent device of the battery housing opened, and 0.02 mol
of gas were released by the cell. The cell cooled down by 10 ◦C during the release
process because of the Joule-Thomson effect. The vent opening was then probably
clogged until, at 230 ◦C, concurrent with the rapid thermal runaway, the cell vented
for a second time. The second venting was the major venting: an additional 0.15 mol
of vent gas were produced (Fig. 3.4b).

3 Thermal Runaway

45

Note that the amount of gas in the reactor decreased shortly after venting. This
effect can be explained by the condensation of gas at the reactor walls. Since the
reactor walls had a lower temperature (∼150 ◦C) than the cell in full thermal runaway
(up to 687 ◦C), the walls could act as a gas sink.

In order to visualise subtle changes in thermal behaviour of the cell during the
experiment, rate diagrams are utilized. Contrary to a common temperature versus
time diagram (θ vs. t), the temperature rate is plotted versus temperature (dθ/dt vs.
θ ) in a rate diagram. This type of diagram is often used to visualise accelerating rate
calorimetry (ARC) results as well. Three distinct experiment stages can be seen in
the rate diagram for the NMC cell (Fig. 3.4c):
1. Heat-up stage ( θ < θo): In the temperature range from room temperature to
θo at ∼170 ◦C, the cell generated no heat. The heater sleeve was the only heat
source in this phase. The negative peak at 130 ◦C is associated with endothermic
separator melting. (It is analogous to a negative endothermic peek in a differential
scanning calorimetry (DSC) diagram during the phase change of a sample.) The
temperature θo at which a cell starts to generate heat is commonly called the onset
temperature of the thermal runaway.

2. Quasi-exponential heating stage ( θo < θ < θr ): At temperatures higher than
θo, the battery became a heat source. Between 170 and 220 ◦C, the temperature
rate increase followed a nearly straight line in the logarithmic plot (Fig. 3.4d).
At 220 ◦C, a sharp increase in temperature rate marked the end of the quasi-
exponential heating stage.

3. Rapid thermal runaway stage ( θr < θ < θm): At 220 ◦C, θ/dt increased sharply
and initiated the rapid thermal runaway. The transition to thermal runaway was
accompanied by a venting event. The thermal runaway ended when all reactants
had been consumed. At this point, the maximum temperature θm = 687 ◦C was
reached.

It is difﬁcult to pinpoint the exact transition between stage 1 and 2. Several endother-
mic events often occurred near the onset temperature θo: the separator melt tempera-
ture was 130 ◦C, the cell safety vent usually opened at 160 ◦C and some material was
released from the cell, causing a slight cool-down due to the Joule-Thomson effect.
Thus, the exact value of θo can be obscured by the intermediate cell cool-down.
To keep it simple, θo was deﬁned as the point at which the heating-rate curve switches
from constant to quasi-exponential rising. One line is ﬁtted to the heat-up part and
one line to the quasi-exponential part of the rate curve in the logarithmic rate plot.
The onset temperature θo can be further deﬁned as the temperature at which the two
lines cross (Fig. 3.4d).

3.3.2 Thermal-Runaway Experiments

At least three thermal-runaway experiments were conducted with each of the three
cell species. A temperature proﬁle overview of all experiments is shown in Fig. 3.5a.

46

A. W. Golubkov and D. Fuchs

Fig. 3.5 a Overview of the time-temperature proﬁles for the cells tested. Data for the whole
experiment durations and for the whole experiment sets is shown. For the sake of completeness,
one LFP test with a higher (1) and one with a lower (2) heating rate of the heater sleeve are included.
b Temperature rates from three representative experiments

Each species had its unique thermal-runaway characteristics. The high capacity,
cobalt rich LCO/NMC cells reached the highest θm at (853 ± 24) ◦C during thermal
runaway. The cobalt poor NMC cells had a lower θm of (678 ± 13) ◦C. The LFP
cells showed a less pronounced thermal runaway and reached a moderate θm of (404
± 23) ◦C. The temperature curves showed small variations from sample to sample.
It is likely that the variations were caused by different burst times of the rupture
plates, which, together with subtle effects of venting, Joule-Thomson cool-down and
clogging of the vent openings, inﬂuence the thermal-runaway reaction-pathways.

For the sake of completeness, two additional LFP experiments with different
heater-sleeve heating-rates (1.5 and 3.5 ◦C/min ) were also included in the analysis
(Fig. 3.5a). The thermal runaway characteristics of the LFP cell (θr , θm and n) did
not depend on the heater-sleeve heating rate in the given heat-rate range. The two
additional experiments contributed to the mean values in Table 3.3 and Fig. 3.6. For
clarity, only one representative curve for each cell species is shown in the following
graphs.

Each cell species had distinctive kinetic thermal-runaway characteristics (Table 3.3
and Fig. 3.5b). Of the three specimen, the LCO/NMC cell showed the lowest θo and
θr , hence the LCO/NMC cell was the cell most vulnerable to over-heating conditions.
For the NMC cell, θo and θr were shifted to higher temperatures. Transition tempera-
tures of the LFP specimen were noticeably higher than those of both metal/oxide cells
(LCO/NMC and NMC). The LFP cell was able to withstand the highest temperature
before going into thermal runaway.

Both metal oxide cells showed the three stages described above (heat-up, quasi
exponential heating, rapid thermal runaway). In contrast, the thermal runaway proﬁle
of the LFP cell lacked a distinct quasi-exponential stage. For the LFP cell, it was
difﬁcult to ﬁnd a clear distinction between θo and θr . Therefore, θr is not given for
the LFP species.

3 Thermal Runaway

47

Table 3.3 Characteristic temperatures and venting parameters in the thermal-runaway experiments.
Here, θo is the onset temperature, θr is the transition temperature into rapid thermal runaway, θm
is the maximum recorded temperature, n is the total amount of gas produced as measured in the
reactor at a reactor temperature of 150 ◦C, and Δt is the typical venting duration
LCO/NMC
149 ± 2
208 ± 2
853 ± 24
265 ± 44
0.8

LFP
195 ± 8
–
404 ± 23
50 ± 4
30.0

NMC
168 ± 1
223 ± 3
678 ± 13
149 ± 24
0.2

◦C
◦C
◦C
mmol
s

θo
θr
θm
n
Δt

C2H6
1.2%

LCO/NMC

H2
30.0%

C2H4
7.7%

CH4
8.6%

CO
27.6%

C2H4
8.2%

CH4
6.8%

CO
13.0%

NMC

H2
30.8%

CO2
24.9%

CO2
41.2%

C2H6
0.3% LFP

CH4
4.1%

CO
4.8%

C2H4
6.8%

H2
30.9%

CO2
53.0%

Fig. 3.6 Detected components of the produced gases (mol %)

48

Fig. 3.7 Temperature-
ventgas proﬁles. Note that
the x-axis is trimmed to the
relevant temperature range

LCO/NMC
NMC
LFP

A. W. Golubkov and D. Fuchs

)
l
o
m

(
 
s
a
g
 
f
o
 
t
n
u
o
m
a

0.3

0.25

0.2

0.15

0.1

0.05

0

−0.05

100

150

200

250

300

350

400

cell temperature (°C)

During the thermal runaway, the cells produced a signiﬁcant amount of gas
(Table 3.3). The amount of gas strongly depended on the cell type. The highest
amount of gas was released by the LCO/NMC cell, followed by the NMC cell. The
LFP cell yielded the least amount of gas.

Two successive gas production events were evident in all experiments (Fig. 3.7):

1. In the ﬁrst venting event, prior to rapid thermal runaway, the burst plate of the

battery opened, and ∼20 mmol were released by all three cell types.

2. In the second venting event, at the start of rapid thermal runaway, both metal-oxide
cells released a high amount of additional gas at a high rate (Fig. 3.8). In contrast,
the LFP cell released only a small amount of additional gas at a low production
rate. In the case of the metal-oxide cells the gas was released in very short time.
The NMC cell produced the main amount of gas in just 0.2 s, and the LCO/NMC
in 0.8 s. After release, the hot gas was not in thermal equilibrium with the cooler
walls of the reactor, and therefore the amount of gas decreased, as the released gas
came into contact with the walls and condensed. In contrast, the gas production
duration of the second venting for the LFP cell was ∼30 s. Because of the gradual
release, the gases of the LFP cell were in better temperature equilibrium with the
reactor walls and the gas condensation effect was not noticeable.

3.3.3 Gas Analysis

At least one gas analysis was performed for each cell species. Each cell type showed
a unique gas composition footprint (Fig. 3.6). The main components were H2 and
CO2. Both metal-oxide cells produced a signiﬁcant amount of CO. Additionally,
smaller fractions of CH4, C2H4 and C2H6 were identiﬁed. As mentioned before, HF
was not measured.

3 Thermal Runaway

49

Fig. 3.8 Time-ventgas proﬁles. Note: to make the curves comparable, each curve was moved on
the time axis, so that the second venting event starts at time zero. a The ﬁrst 100 s and b the ﬁrst 2 s
of the second venting events are shown

Most components of the gases are ﬂammable. The gases can be toxic due to the

presence of CO.

3.4 Conclusion and Outlook

Three types of consumer lithium-ion batteries with the format 18650 with different
cathode materials were evaluated in thermal runaway tests. The cells were brought
into thermal runaway by external heating. All tests were performed in a pressure-tight
reactor in an argon atmosphere. In agreement with literature [4], the cell contain-
ing LFP showed the best safety characteristics. The LFP cell had the highest onset
temperature (∼195 ◦C), the smallest temperature increase during the thermal run-
away (∼210 ◦C), the lowest amount of produced gas (∼50 mmol) and the lowest
percentage of toxic CO in the gas (∼4 %). Unfortunately, it was also the cell with
the lowest working voltage (3.3 V) and the lowest energy content (3.5 Wh). Batteries
with higher energy content (5.5 and 9.6 Wh) performed worse in safety tests. The
onset temperature shifted down to ∼170 and ∼150 ◦C, the temperature increase dur-
ing thermal runaway rose to ∼500 and ∼700 ◦C, the amount of gas released was
∼150 and ∼270 mmol, and signiﬁcant percentages of CO (13 and 28 %) were found
for the NMC and NMC/LCO cells, respectively.

All cells released high amounts of H2 and hydrocarbons. These gases are highly
ﬂammable. Even though the gas could not burn in the inert atmosphere inside the
reactor, the surface of the high-energy cells reached temperatures of up to 850 ◦C
during the experiments.

Modern devices are equipped with battery temperature and voltage monitoring.
If a state beyond speciﬁcation is detected, the devices shut down automatically to
prevent battery abuse [18]. If system shut-down can not prevent a thermal runaway
in all cases, data in this work may be a valuable source for the speciﬁcation of a
robust energy-storage system which can withstand conceivable abuse events.

50

A. W. Golubkov and D. Fuchs

To reduce possible damage from thermal-runaway events in consumer devices,
we suggest the following design optimization targets: (1) increase the temperature
endurance and heat absorption capability of used materials; (2) minimize heat propa-
gation to neighbouring burnable elements; (3) minimize gas ignition probability (e.g.
mechanical separation of electric components from the gas release position). This
work has shown that the kinetics of the thermal-runaway process strongly depend on
the energy content of the lithium-ion battery. Future work will focus on the thermal
runaway triggered by over-heating at different states of charge (SoC) and the ther-
mal runaway caused by overcharge. Emphasis will be given to assessment of HF gas
evolution, to gas analysis with GC-MS, and to the analysis of the liquid residues that
are collected in the cooling trap.

Acknowledgments The authors would like to acknowledge the ﬁnancial support of the “COMET
K2—Competence Centres for Excellent Technologies Programme” of the Austrian Federal Ministry
for Transport, Innovation and Technology (BMVIT), the Austrian Federal Ministry of Economy,
Family and Youth (BMWFJ), the Austrian Research Promotion Agency (FFG), the Province of
Styria and the Styrian Business Promotion Agency (SFG).

We would furthermore like to express our thanks to our supporting scientiﬁc project partners,
namely Graz Centre for Electron Microscopy and the Graz University of Technology, Institute of
Chemical Engineering and Environmental Technology.

The chapter ‘Thermal Runaway—Causes and Consequences on Cell Level’ is derived from
the original article ‘Thermal-runaway experiments on consumer Li-Ion batteries with metal-oxide
and olivin-type cathodes’ RSC Advances, 4(7), 3633. doi:10.1039/c3ra45748f, (2014), by A. W.
Golubkov, D. Fuchs, J. Wagner, H. Wiltsche, C. Stangl, F. Gisela, G. Voitic, A. Thaler, and
V. Hacker—Reproduction by permission of The Royal Society of Chemistry.

Abstract Mathematical modelling and simulation has been an essential part of bat-
tery research and development ever since. Depending on the particular, objective
several different approaches are feasible, each of which provides speciﬁc advan-
tages, e.g. calculation speed or deep mechanistic insight. This chapter presents an
overview of common battery model approaches and introduces the multi-scaling
technique for the simulation of larger battery units.
Keywords Battery · Physics-based modelling · Equivalent circuit modelling · Multi
scaling

4.1 Introduction

Battery models are used to describe and predict the performance of batteries. A vali-
dated model at hand usually reduces the cost of experiments signiﬁcantly. In principle,
the models consist of one or more mathematical equations. The complexity of these
models varies from simple empirical relationships based on one parameter to highly
sophisticated mechanistic 3-dimensional models, comprising many partial differen-
tial equations with dozens of parameters, some of them anisotropic. It is obvious that
the calculation effort greatly increases with model complexity. Therefore a careful
selection of the model level is essential in order to meet the given requirements.
The simplest—and earliest—battery models consist of just one equation, which
describes an observed relationship and usually does not take any given physical prop-
erty of the investigated battery into account. Such models are also called “black-box
models”. A typical example is the calculation of the state of charge (SoC) of a lead-
acid battery from the speciﬁc gravity θ of its electrolyte. Based on a measurement
(dots in Fig. 4.1 [11]), one can directly establish a best-ﬁt line (continuous lines in
Figs. 4.1 and 4.2):

SOC = 606.84 · θ − 680.42.

(4.1)

The deviation plot (Fig. 4.2) shows that the deviation is—besides the point at 100 %
SoC—lower than 5 % (in absolute numbers); the model is fast and simple. However,
there is room for improvement. First, the valid range of the model can be reduced,
e.g. 0–70 % SoC. A linear approach would then result in (dashed lines in Figs. 4.1
and 4.2)

SOC = 537.31 · θ − 599.69.

(4.2)

This model gives much better results in the deﬁned range (→1 %), but fails over 80 %.
Hence, one can use this model if the SOC does not exceed 80 %. Second, the model
order can be increased, e.g. by a quadratic term:

SOC = 1565.5 · θ2 − 3138 · θ + 1554.9.

(4.3)

The advantage of the increased complexity is a better approximation (dotted line in
Figs. 4.1 and 4.2) within the entire range.

Black-box models usually do not provide information about mechanisms inside
the cells, but they are fast and accurate within given ranges. The main intention of
showing this simple model comparison was to sensitize the reader to the important
topic of proper model selection. A model of the 6th order would have had a maximum

4 Application-Related Battery Modelling

55

Fig. 4.2 Model deviations, lines related to Fig. 4.1

VOCV 

VR 

VRC1 

VRC2 

VRCn 

OCV 

R 0 

R 1 

C1 

R 2 

C 2 

VCELL 

R n 

C n 

Fig. 4.3 A common equivalent circuit for modelling electric behaviour of battery cells

error of 1 %, but it is far from being useful in practice, as even the measurement
method of the speciﬁc gravity is less accurate (error of the dots in Fig. 4.1). This
holds true for all other more sophisticated approaches as well.

4.3 Equivalent Circuit Modelling

It has been observed that batteries behave somewhat like electronic circuitscomprising
resistances and capacitors (see Electrochemical Impedance Spectroscopy (EIS) [5]),
especially during dynamic loads. Consequently, it has become very common to model
the current/voltage behaviour by equivalent circuits, using known relationships from
electronics. These so-called RC models are usually fast, but again provide no insight
into the battery. RC models can also be considered to be empirical, although some of
the parameters can be attributed to the physical condition of the cells, e.g. two oppo-
site plates (electrodes) as capacitor and the internal ohmic resistance to electrolyte
conductivity.

A very common approach to an equivalent circuit is shown in Fig. 4.3. The ﬁrst
two parts in the ﬁgure are a voltage source that replicates the open circuit voltage
of a battery and the inner resistance, which is responsible for the ohmic drop in
voltage when switching on a current. The main components of this network are the
RC circuits, each having the impedance

56

Fig. 4.4 Nyquist plot of
lithium-ion cell measured by
EIS (dots) and derived 2-RC
model (continuous line)

F. Pichler and M. Cifrain

ZRC =

R
1 + Δ2R2C2

− i

ΔR2C
1 + Δ2R2C2

= Z

⊆ + iZ

⊆⊆,

(4.4)

with Δ …angular frequency of an alternating current (AC) voltage that is applied to
the circuit and Z ⊆ and Z ⊆⊆ …real and imaginary parts of the impedance. The angular
frequency is related to the AC frequency ν of the applied voltage by Δ = 2π ν. In
Fig. 4.4 the Nyquist plot of a lithium-ion battery is shown (see Sect. 4.3.1). This type
of plot is widely used to show dynamic cell characteristics and shows the imaginary
part of the impedance over the real part for several angular frequencies. The lower
left part of the plot (thin solid line) shows a perfect semi-circle, which is exactly
the contribution of a single RC-circuit. Its highest point is at a frequency of exactly
Δ = 1

RC and its diameter is exactly R.

4.3.1 Parametrization

As shown above, one option for setting up an equivalent circuit model for a battery
is to simply use the Nyquist plot of a battery to ﬁt the model parameters (Ri, Ci, i =
1, . . . , n). Figure 4.4 (dots) shows an example of an EIS measurement [5] as a Nyquist
plot, whereby a lithium-ion cell was stimulated via an AC current of increasing
frequencies (approx. 2 Hz to 2 kHz). As every RC element delivers one semi-circle
(provided the capacitances are sufﬁciently different), one can see that there must be
at least two RC elements. The offset from zero on the x-axis is the ohmic internal
resistance (R0). The small semi-circle is usually assigned to the electrode reaction.

4 Application-Related Battery Modelling

57

The measured curve does not show a clean circle, which indicates that there is more
than just one RC element behind it, but the ﬁt still seems quite good. The large circle
is assigned to transport processes. It can be modelled either via a large semi-circle or
a 45◦-straight line, called Warburg Impedance. While the location of the semi-circles
along the x-axis is deﬁned by the resistances, the depth of the valley between the
circles is deﬁned by the ratio of the capacitances (the larger the deeper). The absolute
values of the capacitances can be calculated, as on the highest point of the circle the
circular frequency equals 1/RC.

These parameters are highly dependent on several quantities, such as the temper-
ature, the SoC of the battery and the current amplitude. Consequently, the described
steps for parametrization have to be executed for many load points, thereby estab-
lishing multidimensional tables that give the RC parameter dependences on all the
inﬂuence quantities considered.

Having assembled these look-up tables, the parameters can be adjusted dynam-
ically using an interpolation scheme to obtain values for the actual load point in a
simulation.

4.4 Mechanistic Models

Neither empiric nor RC models provide insight into the physical processes proceed-
ing during cell operation. For studies of these processes in battery development and
optimization, mechanistic models, also called electrochemical (EC) or physics-based
models, are required. These models can easily grow to a high complexity compris-
ing dozens of parameters, and many different approaches have been reported in the
last decades. However, they all try to describe the coupled ongoing processes of the
battery.

In most cases, an electrochemical cell consists of two different solid electrodes
submerged in a liquid electrolyte (see Fig. 4.5). The electrodes form system-speciﬁc
equilibrium electrode potentials, which can be measured as cell voltage. Furthermore,
each electrode has the ability to provide a charge-transfer reaction (redox reaction)
on its surface, which changes the charge-transport mechanism from electronic (in
electrode) to ionic (in electrolyte) or the reverse. The electron current shows char-
acteristics described by Ohm’s law while the ionic current is diffusion controlled.
Once connected, the cell is able to deliver a usable current, as long as active reducible
and oxidizable material is present. A separator prevents the electrodes from internal
short-circuiting.

The main aspects of mechanistic modelling are addressed below, as a detailed
description would go beyond the scope of this introduction. For the same reason,
boundary and initial conditions for the partial differential equations (in this and the
next chapter (Sect. 4.5)) will only be given, when they play a key role in the modelling
process. For more details on electro chemistry and mechanistic modelling see [2, 3,
7, 8].

58

F. Pichler and M. Cifrain

Fig. 4.5 Schematic view of a battery during discharge, comprising porous electrodes and positive
ions transporting the charge. 1 current collectors, 2 anode particles, 3 electrolyte, 4 separator (e.g.
porous plastics), 5 cathode particles

4.4.1 Charge Transfer

At the electrode-electrolyte interface, charge separation will occur forced by the
electrochemical potential until an equilibrium condition is reached:

reduced species (cid:2) oxidized species + electron(s),

e.g. for zinc

Zn (cid:2) Zn2+ + 2e

−.

(4.5)

In equilibrium, the amount of the forward reaction (from left to right) equals the
amount of the backward reaction. While the electrons (e−) stay in the electrode, the
ions are dissolved by the electrolyte. However, due to electrostatic forces, the ions
stay close to the interface to form an electric double layer, which acts like a capacitor.
Hence, this electric charge separation builds up an electric potential difference E0
between the electrode and the electrolyte, depending on the free energy ΦG of the
system:

E0 = −

ΦG
nF

,

(4.6)

4 Application-Related Battery Modelling

59

with F …Faraday constant (≈96485 Cmol−1) and n …number of electrons in the
reaction equation. This relationship is called Faraday’s Law. The practically occur-
ring potential difference E also depends on the concentration of the ions of the
reduced and oxidized species, cRED and cOX respectively. If either species is solid, c
equals 1 by deﬁnition (no dependence). The relation between E and c is the Nernst
Equation:

E = E0 − RT
nF

ln

(cid:2) νREDcRED
νOXcOX

(cid:3)
,

(4.7)

with R …gas constant (≈8.314 Jmol−1 K−1), T …temperature (in K) and νRED and
νOX the activity coefﬁcients, which equal 1 for highly diluted solutions.

The same happens at the second electrode, but due to a different material and
consequently a different chemical reaction, the electric potential difference will not
be the same. The difference in the two potential jumps is the equilibrium cell voltage
(also called open-circuit voltage, OCV ), which can be measured at the two electrodes.
For many sorts of batteries comprising metal electrodes, Eq. (4.7) is the cause for a
voltage decrease during discharge. At the anode, cOX continuously rises, and Eanode
therefore increases. At the cathode, cOX is used up, and Ecathode decreases. The total
cell voltage V = Ecathode − Eanode decreases. If this decrease is sufﬁciently high, the
open circuit voltage can be used to determine the state of charge of the battery.

Once an external electrical connection is set up, electrons start to move from the
more negative electrode to the positive one (see Fig. 4.5). The lack of electrons on the
negative electrode (the anode) causes the chemical reaction to consume the reduced
species in order to regain equilibrium, while the opposite occurs at the positive
electrode (the cathode). The obtained current I depends on the potential displacement
η (in V , also called overpotential), as well as the reaction rate, usually expressed by
the exchange current density i0 (in Am−2). For electrode x, this relationship is deﬁned
by the Butler-Volmer Equation:
(cid:5)

(cid:6)(cid:7)

(cid:5)

(cid:6)

(cid:4)

Ix = Axi0

exp

αa,xnxFηx
RT

− exp

−

αc,xnxFηx
RT

,

(4.8)

with Ax …active inner electrode surface (in m2), αa and αc …symmetry coefﬁcients
of the chemical reaction in anodic (left-to-right) and cathodic direction (right-to-left)
respectively. These are derived from Transition-State Theory and often set to 0.5,
which indicates perfect symmetry. The total current is now given on the one side by
the external load, in the case of a resistor this would follow Ohm’s Law (I = V /R),
and on the other side by the reactions on the electrodes x and y, whereby

and

I = ix = iy,

V = Ex − Ey − (ηx − ηy).

(4.9)

(4.10)

60

F. Pichler and M. Cifrain

4.4.2 Ion Transport

−

Normally, the charge transport in the electrolyte is done by a single ion species
solely, e.g. Li+ in lithium ion or OH− in nickel metal-hydride cells. The counter
6 and K + respectively in the cell types mentioned, do not participate in
ions, e.g. PF
the reactions, however supply neutrality. The active ions are produced on one elec-
trode and consumed on the other, causing a concentration gradient in the electrolyte,
whereby the counter ions follow the active ones. The transport mechanisms of dif-
fusion, migration and convection reduce this gradient continuously. Convection can
be found in systems with larger electrolyte compartments such as some lead-acid
systems or fuel cells with liquid electrolyte, but open spaces in batteries are usually
too small to provide good convection. Migration is the transport of ions in the electric
ﬁeld between the electrodes. As the ions are usually surrounded by solvent mole-
cules shielding them, the effect is not very strong. However, close to solid spikes at
high overpotentials (e.g. during charging at high rates), this ﬁeld can get very high
and cause ions to be reduced especially at these spikes, causing the development of
dendrites.

The main transport mechanism is diffusion. Neglecting a possible hindrance of
slow-moving counter ions, the Nernst-Planck Equation describes the rate of diffu-
sion:

(cid:5)

(cid:6)

∂ai
∂t

= ∇ ·

Di∇ai + zF
RT

Diaiη

,

(4.11)

with ai = γici …activities of species i, Di …diffusion coefﬁcient.

4.4.3 Electron Transport

In the electrodes and the current collector, the charge is commonly transported by
electrons. For the electronic current, Ohm’s Law describes the process:

−∇ · (σ ∇φ) = 0,

(4.12)

with σ …electrical conductivity and φ …electrical potential. Although the current
collectors usually consist of solid metals, either low conductivity (e.g. lead grid
in lead-acid batteries) or low thickness (e.g. thin Cu foils of 10 µm in lithium-ion
batteries) can signiﬁcantly increase the total internal resistance.

4.4.4 Porous Electrodes

In order to increase the inner surface Ai, battery manufacturers use highly porous
active layers in their cells, as schematically shown in Fig. 4.5. While this has a positive
impact on the charge transfer rate, it is a hindrance for diffusion: The smaller the
particles, the better the current exchange, but the worse the mass transport. Ai is a

4 Application-Related Battery Modelling

parameter already existing in Eq. (4.8), the ion transport Eq. (4.11) contains the bulk
variable Di. Already in 1935, Bruggemann proposed an empirical way to calculate
an effective value Di,eff :

Di,eff = Diεbrugi

,

i

with i …material of interest (anode, cathode, separator), εi …porosity and brugi
…Bruggemann Coefﬁcient, which is commonly set to 1.5 for spherical particles. In
other words, εi represents the electrolyte ratio, while brugi represents the degree of
tortuosity.

In addition, the same approach can be used for the electric conductivities in solid
(σi) and liquid (κi), whereby εi in the ﬁrst case represents the solid portion of the
porous material:

61

(4.13)

(4.14)

(4.15)

σi,eff = σiεbrugi
κi,eff = κiεbrugi

i

,

.

i

Another approach could be the development of a 3D-structure and calculation of the
ﬂow characteristics, which is much more complex however. The big advantage, on
the other hand, would be the ability to calculate any form of particles.

4.4.5 Intercalation

In addition to the aforementioned aspects, the lithium-ion technology includes a spe-
cial feature: ion intercalation. In contrast to most other cell types, the active ion (Li+)
is not deposited on the electrode surface, but stored inside a host material. For anodes,
graphite is usually chosen, whereas for cathodes a number of metal oxides and phos-
phates are available. Section 4.4.1 described how the ion concentration inﬂuences the
cell voltage and consequently the degree of cell discharge (state of charge), whereby
it was assumed, that the electrode does not change. In the case of host materials,
this does not hold true. Regarding the mechanism of ion uptake (and release), we
can distinguish between two types of host materials: energy and entropy-controlled
systems.

In energy-controlled systems (see Fig. 4.6), such as graphite or many oxides, all
particles ﬁll up in parallel, and a “concentration” of active ions develops in the host
material (cs). For example graphite (C6) can take up 1/6 th molar ratio of lithium
(LiC6) at most, and the lithium content is usually between 0 and 1, written as LixC6,
0 < x < 1, continuously. For graphite, cs and x are connected linearly:
cs = x · θC
6 · MC

≈ 30x,

(4.16)

62

Fig. 4.6 Schematic view
of particles at different
state of charge; top row
energy-controlled, bottom
row entropy-controlled

F. Pichler and M. Cifrain

with cs in molL−1, θC …density of graphite (≈2.2 ·103 gL−1) and MC …molar
weight of graphite (≈12.01gmol−1). Hence, the maximum concentration in the
particle is cs,max ≈30 molL−1. The solid diffusion into the particles can also be
addressed using a diffusion coefﬁcient Ds and a radial coordinate r (spherical parti-
cles assumed):
(cid:5)

(cid:6)

∂cs
∂t

= 1
r2

∂
∂r

Dsr2

∂cs
∂r

.

(4.17)

In lithium-ion batteries, the total concentration of Li+ in the electrolyte (cL) remains
the same (equilibrium condition); hence, the state of charge and the related potentials
Ei depend solely on the concentrations of the lithium in the solids.

In entropy-controlled systems (Fig. 4.6, bottom row), the particles ﬁll up sequen-
tially, resulting in a mixed potential at the current collector. These systems often
show ﬂat discharge curves (voltage versus state of charge or versus average lithium
concentration). One example is lithium-iron phosphate. There are simple modelling
approaches that describe the dependence of the open circuit voltage simply by the
ratio of ﬁlled to empty particles, provided the particles are small and the inner-particle
diffusion rate is negligibly small. More sophisticated approaches use e.g. the Cahn-
Hilliard equation or address the crystallographic characteristics of the host material,
thereby supporting diffusion of lithium in one, two or three directions (1D, 2D or 3D
materials, respectively [10]).

4.4.6 Heat Generation

Heat is a by-product of cell operation that is mostly unwanted (energy loss). Tem-
perature increase of the battery can lead to faster ageing and to safety-critical battery
states and must be avoided by implementing cooling strategies. Heat generation is
commonly modelled by the energy balance comprising external heating or cooling,

4 Application-Related Battery Modelling

63

heating caused by current ﬂowing and heating or cooling by chemical reactions. The
heat equation is generally written as

θcp

∂T
∂t

= ∇ · (λ∇T ) + f ,

(4.18)

with θ …density, cp …heat capacity, λ …thermal conductivity, and f …sum of heat
sources. Here heat transport is assumed to be caused only by conduction and it is
covered by the ﬁrst term on the right (Fourier’s Law). Heat caused by the current
(Joule heating) is expressed as:

The heat caused by chemical reactions can also be calculated by a similar relation:

fJoule = σ ∇φ · ∇φ.

freact = Iη,

(4.19)

(4.20)

with I …exchange current(see Eq. (4.8)) and η …overpotential. The very sim-
ple approaches shown here can be modiﬁed by using more complex descriptions
to address open circuit voltage drifts, conductivity changes etc. with temperature
(e.g. Arrhenius) or effects like Seebeck/Peltier or Soret.

4.4.7 Cell Ageing

Degradation modelling is another important ﬁeld. Usually, the decay of battery capac-
ity and the increase of the internal resistance are of interest. Empiric or semi-empiric
approaches are used, similar to the models in Sect. 4.2, which now describe the ageing
effects. Also, attempts to cover multiple inﬂuencing factors on larger experimental
scale and setting up a statistical model were done (e.g. [9]), still being empirical.
Mechanistic ageing models are physics-based (Sects. 4.4.1 to 4.4.5), whereby time-
dependent parameter modiﬁcations are added. However, in many cases the ageing
mechanisms are not available together with a selective quantiﬁcation of the under-
lying parameters.

4.5 Large-Scale Modelling

At a certain point in the modelling process, a 1D cut through a cell stack might
no longer be sufﬁcient. Especially for optimization of cell, module and pack design,
there is high need for 3D simulation. In 3D simulation, the most common methods all
depend on computational grids that map the 3D structure of the simulation domain to a
ﬁnite number of nodes (coordinate points), making the simulated object accessible for

64

(a)

F. Pichler and M. Cifrain

(b)

out-of-plane 

in-plane 

(c)

Fig. 4.7 a Schematic structure of battery module. b Structure of stack layer. c Black-box approach
to electric behaviour

computer algorithms. For example, in the ﬁnite element method, a three-dimensional
domain is resolved by simple geometrical bodies such as tetrahedrons, pyramids and
hexahedra. The computational cost is thereby increasing with every node added to
the grid.

One constraint on the placement of these elements is that their surfaces have
to map the boundaries and interfaces of different materials and jumps of physical
properties in general. For example, industrial lithium-ion battery modules consist
of several cells packed together (see Fig. 4.7a), which are structured in layers (see
Fig. 4.7b), either stacked on each other, wound prismatically or cylindrically, forming
the “jelly roll”. Resolving this structure layer by layer makes it possible to assign
material properties to the current collectors and the cell stack separately. However,
this would require quite an expensive computational effort due to the sheer number
of stacked layers.

In this situation, a homogenization of the properties of the jelly roll is preferred.
Homogenization means scaling up equations such that the small-scale changes of
physical quantities can be averaged and allow to resolve the simulation domains on
a coarser computational grid. An approach such as this allows the jelly roll to be
geometrically resolved independent from the number of layers and their geometrical
borders. The material properties assigned to the domain represent the averaged or
homogenized properties of all the components of the jelly roll.

4.5.1 Thermal Behaviour

A simple example can be given with the homogenization of the heat equation in the
layered cell.

4 Application-Related Battery Modelling

65

(a)

(b)

Fig. 4.8 Thermal RC equivalent circuit of electrode stack

For the following procedure a periodic structure, as indicated in Fig. 4.7b, is
assumed. A rigorous mathematical derivation of the homogenization can be found,
for example, in [4]. Here, only an intuitive argumentation will be given.

The aim now is to homogenize the heat Eq. (4.18) and derive a homogenized

equation of the form

(cid:8)cpθ ˆTt − ∇ ˆλ∇ ˆT = ˆf ,

for x ∈ Ω,

(4.21)

where Ω ⊂ R3 is the 3D domain of the jelly roll and the ˆ· operator describes
homogenized quantities, which should describe averaged values of the stack com-
posite, instead of resolving every material jump separately. Often, these quantities
are called effective values in this context. For the middle part of the jelly roll, which
comprises only parallel layers, a spatially constant ˆλ can be expected because the
stacked structure does not change there. This does not hold true for the curved parts,
where the deﬁnition of in-plane and out of-plane is dependent on the position in
the jelly roll. Obviously, the average conductivity of the jelly roll will be different
in the in-plane and the out-of-plane directions, as indicated in Fig. 4.7b. The ther-
mal resistances in the out-of-plane direction can be compared to an electrical circuit
of resistors in series (see Fig. 4.8a) because a possible heat ﬂow would have to go
through the layers consecutively. Here, the area-speciﬁc conductivity Go (in Sm) of
a single layer depends on the speciﬁc conductivity λ (in Sm2) of the material and its
thickness δ by

The total conductivity of resistors in series is calculated by the harmonic mean of
the single conductivities, so

Go

layer

=

λlayer
δlayer

.

Gstack = (

⎢

textlayer

1
Gtextlayer

)−1.

(4.22)

(4.23)

With L being the total stack thickness, one can now derive the speciﬁc conductivity
as

66

F. Pichler and M. Cifrain

λo

stack

= L · G = L(

⎢

layer

δlayer
λlayer

)−1,

which is exactly the weighted harmonic mean of the conductivities. The in-plane
direction can analogously be compared to a set of resistors in parallel (see Fig. 4.8b),
because a heat ﬂow would go through the layers in parallel. Based on the equiva-
lent circuit, one can once again easily derive the speciﬁc stack conductivity as the
weighted arithmetic mean of the single layer conductivities:

Notice that the in-plane conductivity of a layer grows with its thickness, as opposed to
the out-of-plane case, where it shrinks with it. All together, this anisotropic behaviour
is described by the diffusion tensor
⎡

⎤

λi

stack

= 1
L

⎢

layer

δlayerλlayer.

ˆλ =

⎣

0

λi

λo
stack
0
0

stack
0

λi

stack

0
0

⎦ ,

(4.24)

(4.25)

(4.26)

assuming that the cell is positioned with its out-of-plane direction in the x-axis.
Remarkably, with these two cases of a layered structure, the two extreme cases
of effective homogenized conductivities have been addressed. Theory shows that
any arbitrary geometrical composition that has the same volumetric distribution of
materials yields effective conductivities that lie between the arithmetic and harmonic
weighted averages of their components.

Independent of the geometrical structure of the representative stack, the effective
capacity (cid:8)cpθ is the arithmetic mean of its components weighted by their volume
fraction:
⎢

(cid:14)cpθ =

Vicpiθi,

i

(4.27)

with i …the component of the stack, Vi …its volume fraction.

4.5.2 Electrical Behaviour

For the homogenization of the electrical behaviour of the cell, an assumption about
the distribution of anodic and cathodic currents is proposed, which is that the anodic
and cathodic current densities to the current collectors in any point of the jelly roll are
anti-symmetric to each other. In this context, anti-symmetric means that the cathodic
current at any point of the positive current collector is the negative of the anodic
current at the opposite point on the negative current collector. This assumption is

4 Application-Related Battery Modelling

67

supported by the high collector foil conductivities compared to the lower electrode
conductivities.

Under this assumption, the electric potentials in the current collector foils can be

modelled with the following set of equations:

−∇ · σCu∇φn = 0,
−∇ · σAl∇φp = 0,
σCu∇φn = i,
σAl∇φp = −i,

for x ∈ ΩCu,
for x ∈ ΩAl,
for x ∈ ΓCu,
for x ∈ ΓAl,

(4.28)

(4.29)

where i …current density at the collector-electrode interfaces ΓCu and ΓAl, σ …elec-
tric conductivity of the respective material, φn and φp …pair of electric potentials.
Leaving the behaviour between the two collector foils to a black-box model, as
indicated in Fig. 4.7c, and following the procedure from above, a set of equations in
the form

−∇ · ˆσCu∇ ˆφn = ˆi
−∇ · ˆσAl∇ ˆφp = −ˆi

for x ∈ Ω,
for x ∈ Ω,

can be derived.

Through this step, the computational domain is highly simpliﬁed because the
collector foils no longer have to be distinguished in a geometrical way. This simpliﬁ-
cation yields a big reduction in computational cost because the spatial discretization
no longer needs to resolve the individual layers of the jelly roll, even though the posi-
tive and negative potentials are distinguished by the potential pair ( ˆφp, ˆφn). Thus, the
set of Eq. (4.29) represents a continuous domain, where at every point the positive
and the negative potential exist and represent the potential pair at a typical electrode
stack at this macroscopic point. The calculation of the effective conductivity follows
the one for the heat equation, with the difference that the electrical insulation between
the two foils yields zero conductivity normal to the stack layers. Therefore in the
parallel part of the jelly roll, the conductivity is

ˆσCu =

⎦ , ˆσAl =

⎤

⎡

⎣

0
0 0
0 σ i
Cu 0
0 0 σ i
Cu

⎤

⎦ .

⎡

⎣

0
0 0
0 σ i
Al 0
0 0 σ i
Al

(4.30)

4.5.3 Distributed-Micro-Structure Modelling

An open question is how the source terms ˆf (heat production) and ˆi(current density)
in Eqs. (4.21) and (4.29) are calculated in the model. Of course, this depends mainly
on the black-box model chosen for the electrochemical part of the stack. However,
the question is how this micro model is linked to the macroscopic model. The ideas
of the heterogeneous multi-scaling method (HMM) [1] and a work by Kim et al. [6]
form the basis for the following ideas.

68

F. Pichler and M. Cifrain

For the current density, the relation between the microscopic current density i and

the macroscopic current density ˆi is simply given by the relation

ˆi = Aei

(4.31)

with Ae (in m2
m3 ) being the collector foil surface-to-cell-volume ratio. This means that
the collected current per area (in Am−2) is scaled by the collector foil area to a
current source per volume (in Am−3). Since the contribution of the black-box model
to the heat source ˆf should already be calculated per unit volume, there is no need
for scaling. Equations (4.21) and (4.29) show that at every point x in the jelly roll
the information on the source terms i and f is needed to calculate the macroscopic
potential and temperature distribution. Only the simplest models would allow for a
formulation of the dependence of the source terms on the potential pair ( ˆφp, ˆφn) and
the temperature T , which could be stated in Eqs. (4.21) and (4.29) explicitly.

Following the ideas of HMM, a distributed-micro-structure model can be set up,
instead of oversimplifying the black-box model. This means that at every point where
the information on the source terms is needed (the macroscopic nodes, see Sect. 4.5),
a micro simulation of the black-box model is set up, which calculates the source
terms for the macro model in dependence on the macroscopic variables.

Furthermore, the points where the micro structure is simulated can be decoupled
from the points of the macroscopic numerical grid by interpolating the information
between an arbitrary chosen set of points of simulated micro structure and the set of
points of the numerical grid.

In this way a hierarchical order of models and sub-models is created that allows
for the coupling of the micro structure of the electrode with the macro structure of
the jelly roll. This reduces the computational effort, and enables the simulation of
whole battery modules and packs with an adjustable degree of detail.

Acknowledgments The authors would like to acknowledge the ﬁnancial support of the “COMET
K2 - Competence Centres for Excellent Technologies Programme” of the Austrian Federal Ministry
for Transport, Innovation and Technology (BMVIT), the Austrian Federal Ministry of Economy,
Family and Youth (BMWFJ), the Austrian Research Promotion Agency (FFG), the Province of
Styria and the Styrian Business Promotion Agency (SFG).

The research leading to these results has received funding from the European Community’s Sev-
enth Framework Programme (FP7/2007-2013) under Grant Agreement n◦ 266090 (SOMABAT).

Abstract One of the major issues battery research must address is the lifetime of
a cell. This can be reduced by physical and chemical ageing processes that occur
inside the cell and are inﬂuenced by both the operating strategy and the surrounding
conditions (e.g. temperature). To understand battery ageing, it is necessary to analyze
the materials used in a cell at the microscopic level and correlate the results with
electrical measurement data. This chapter describes a strategy for performing an
ageing experiment by using a combination of analytical methods.
Keywords Lithium-ion battery · Ageing · Analytical methods

5.1 Introduction

Today, lithium-ion batteries (LiBs) are recognized as the state-of-the-art technology
for portable energy storage (e.g. for mobile phones, cameras or notebook PCs). The
LiB could play an even more important role by helping to introduce electro mobility
for the masses, due to their high gravimetric and volumetric energy density as well
as – depending on the choice of materials – the potential to deliver high power and
provide high safety.
Charge

e–

Discharge

e–

R

–

+

–

+

Anode

Cathode

Anode

Cathode

+

Li

5.1.1 Working Principle of a Lithium-Ion Battery

A typical LiB consists of two electrodes (anode and cathode), which are composite
materials coated on a metal foil (the current collector, copper or aluminum), and a
separator that is soaked in an organic electrolyte, all of which is surrounded by an
airtight housing. The composite electrodes commonly contain the active material
that can serve as a host compound for lithium ions, a conductive agent to optimize
electronic conductivity, and a binder that holds everything together. The most com-
mon active material used on the anode side is graphite, while transition metal oxides
such as LiCoO2 and many others can be used on the cathode side.

The working principle of a LiB is based on a so-called ‘rocking chair’ mechanism,
which is illustrated in Fig. 5.1. During charge, lithium ions migrate from the cathode
side to the anode side of the cell when an external current is applied. During discharge,
the lithium ions migrate from the anode to the cathode side, and the cell delivers a
current. The ionic conductivity is provided by the organic electrolyte, which includes
a conductive lithium salt, e.g. LiPF6. The electrode/electrolyte interfaces are not
inert, but rather feature a versatile surface chemistry. Especially on the anode side,
the organic electrolyte will undergo decomposition reactions leading to the formation
of a surface ﬁlm that consists of organic and inorganic compounds, which is called
the solid-electrolyte interface (SEI). For more details on this basic principle please
refer to the following introductory articles [30, 31].

5.1.2 Ageing of Lithium-Ion Batteries

One of the major issues of current LiB technology is the loss of capacity over time
which is known as ageing. In theory, two types of ageing have to be differentiated.
Calendar, or storage life, describes ageing effects that occur during the rest phases

5 Analytical Methods for Investigation of Lithium-Ion Battery Ageing

73

Fig. 5.2 Ageing processes occurring at the anode/electrolyte interface (Reprinted from [26] (Fig. 1),
Copyright 2005, with permission from Elsevier)

of a battery (when it is stored in a certain state), whereas cycle life stands for all
ageing effects that occur when current is applied (i.e. the battery is in use). In reality,
both cycle life and calendar life are mixed and result in a complex ageing behavior,
depending on the mode of use of the battery.

Due to the large variety of components used in a lithium-ion battery, it is impossi-
ble to give a complete overview of all ageing mechanisms that are likely to occur in
a speciﬁc cell setup. However, some general hints can be extracted from the relevant
literature. Figure 5.2 provides a general overview of ageing mechanisms related to the
anode. The solid-electrolyte interface (SEI) is formed initially by the decomposition
of electrolyte components during cell formation. Subsequently, both SEI conversion
and SEI dissolution can occur. Furthermore, the layered structure of graphite can be
destroyed by exfoliation.

On the cathode side, ageing is more related to structural changes of the active
material and degradation of the electrode indicated as loss of contact, micro-cracking
and oxidation of conductive particles, as shown in Fig. 5.3.

A review published by Barré et al. [2] ranks the three main ageing mechanisms
known to literature: (1) loss of active lithium due to SEI forming and converting
reactions, as well as other side reactions; (2) loss of active electrode material due to
material dissolution, particle isolation and structural degradation; and (3) resistance
increase in the cell due to contact loss inside the electrodes, as well as electrolyte
degradation.

To understand LiB ageing on a microscopic level that is beyond the measurement
of an electronic resistance, it is necessary to develop and apply analytical methods

74

S. Weber et al.

Fig. 5.3 Overview of basic ageing mechanisms of cathode materials (Reprinted from [26] (Fig. 2),
Copyright 2005, with permission from Elsevier)

that are able to measure the ageing effect under investigation. Furthermore, meth-
ods have to be developed to extract the materials of interest from the cell without
contamination. This chapter offers an insight into the possibilities of some analyt-
ical methods that are a type of standard for ageing investigations. However, every
method has its limitations, and it must be adjusted to meet the requirements of a
speciﬁc sample.

5.1.3 Investigating Cells

Generally, ageing investigations are based on the comparison of chemical and phys-
ical characteristics of fresh and aged material. Depending on the availability of the
material used in the cells under investigation, this can involve raw materials such as
powders used for making the electrodes, fresh electrodes, cells after formation by
the manufacturer and aged cells. To obtain statistically representative data, the load
proﬁle, including other inﬂuencing factors under investigation (e.g. temperature),
should be developed using the design-of-experiment method (DoE), as described by
Prochazka et al. [17].

Figure 5.4 shows a general ﬂow chart, including the possibility of obtaining raw
materials from the cell manufacturer. The ﬁrst two columns represent the initial
state, taking into account that, in most cases, raw materials will not be supplied by a
cell manufacturer. The third column represents the aged state which is achieved by
applying a load proﬁle to the cells.

5 Analytical Methods for Investigation of Lithium-Ion Battery Ageing

75

Raw Material 

Cell (new) 

Cell (new) 

 

L
o
a
d
P
r
o
f
i
l

e

Formation by 
Manufacturer

Aging 

Aged Cell 

Opening 

Opening 

Characterization 

Initial State 

Initial State 

Aged State 

 
l

a
c
i
t
y
l
a
n
A

 

s
d
o
h
t
e
M

Comparison 

Aging Mechanisms 
Failure Modes 

Fig. 5.4 Flow chart of a typical ageing experiment

5.2 Harvesting Material from Cells

The workﬂow for extracting the material to be analyzed from the cell can be divided
into several steps. First, the cell has to be brought to a safe state, which is normally
deﬁned as completely discharged using procedures provided by the cell manufacturer.

5.2.1 Cell Opening

Opening of LiB cells is highly dangerous and should only be executed by trained
people! Small mistakes may lead to ﬁre or even explosion. During cell opening, it is
useful to have a Dewar vessel with liquid nitrogen within reach to extinguish small
ﬁres and get the heat out of the system.

Before opening any cell, it is important to know about the internal design of the
cell to prevent short circuits and hazards during cell opening. X-ray photographs of
the cell provide very useful information about the internal cell set-up. In general,
three different cell geometries and housings are used in the ﬁeld of LiBs: cylindrical
or prismatic hard-case cells and prismatic aluminum-laminate pouch-bag cells. Since
LiBs consist of materials that are highly sensitive to moisture or air (e.g. the widely
used conducting salt LiPF6), it is essential to develop cell opening procedures that
can be carried out under inert gas conditions.

Pouch-bag cells can easily be opened in a glove box using a ceramic knife and
ceramic scissors. In this case, contamination of the cell materials caused by the

76

S. Weber et al.

opening procedure is unlikely. For hard-case cells, however, the contamination of
the inner part of the cell is a crucial point, due to dust from abrasion. Thus cell
opening procedures and tools have to be developed that can be applied in a glove
box and only produce coarse grit. The miniaturization of tools found in mechanical
workshops (e.g. a turning machine for opening cylindrical hard-case cells) provides
good results.

5.2.2 Electrolyte Extraction

Only in rare cases can the electrolyte be extracted directly from a cell. Normally,
there are no liquid remains inside the cells, and the electrolyte, which sticks to the
cell component surfaces, has to be extracted by different means. One option is rinsing
with an appropriate solvent, which is ideally not part of the electrolyte composition.
The disadvantage of this method is the high dilution factor, which results in levels
of decomposition products and/or additives that are below the limit of detection for
the planned analytical methods. Furthermore, solid parts of the cell will be dissolved
and can hinder the subsequent measurements.

A more recent approach for the extraction of the electrolyte from cells is the
usage of supercritical CO2. This method is faster, more selective and efﬁcient than
extraction with solvent [20, 22]. Moreover, no sample pre-concentration or clean-up
process is necessary [6]. Additionally, through-ﬂow experiments can enhance the
recovery rate, but the concentration of the conducting salt in the extract depends
on the adsorption properties of the extracted material. Consequently, the usage of
supercritical CO2 is a suitable method for the separation of the electrolyte from other
battery parts.

5.2.3 Sampling of Electrodes

Depending on the cell design, different approaches for the sampling of parts of
electrodes can be chosen. In the case of common lab-style cells (e.g. coin cells
or small pouch cells), the electrode area is too small to extract spatially resolved
samples. When dealing with larger cells (e.g. wound or stacked types) it could be of
interest to extract samples at the beginning, middle and end of a wound electrode.

Depending on the analytical investigation, a washing step may be necessary. This
is the case, for example, if the sample needs to be handled in air, and the decompo-
sition of residues of the conductive salt would damage the sample.

Experiments performed using X-ray photoelectron spectroscopy (see Sect. 5.3.1)
show the inﬂuence of different washing steps on the SEI. Commercial graphite anodes
were held in an argon atmosphere and then immersed in dimethyl carbonate (DMC)
for one second or one minute. Comparison of the unwashed sample and the two
washed samples (see Fig. 5.5) suggests that the organic part (e.g. R–CH2OCO2Li)

5 Analytical Methods for Investigation of Lithium-Ion Battery Ageing

77

Fig. 5.5 XPS spectra showing C 1 s and O 1 s core scans of the SEI on graphite anode material,
prepared without washing, washed in dimethyl carbonate (DMC) for 1 s and for 1 min. Variations
of the signals belonging to the inorganic Li2CO3 component and to the organic R–CH2OCO2Li
component are indicated as white and gray arrows, respectively

of the SEI should be removed, whereas inorganic Li2CO3 remains on the surface. A
detailed investigation using sputter-depth proﬁling was conducted by Niehoff et al.
[13], which showed that detailed information about the thickness and structure of
the anode SEI can be obtained without washing the sample.

For this method, conservation of the SEI was made possible by omitting a washing
step as air contact of the sample could be avoided during sample handling. In the
case of other analytical methods, a careful pre-investigation could proved further
information regarding the necessity of a washing step during sample processing.

5.3 Analysis of Electrodes

There are two main important issues when dealing with the ageing of the electrodes:
impurities and various reactions and processes that occure during cycling. The battery
materials have to be free of impurities because residues of the production process
can have various negative impacts on the performance of LiBs [35], such as reduced
cycling stability or loss of energy density. Impurities or metal ions may also be
dissolved during the charge/discharge process [34], migrate into the electrolyte and
then damage either the SEI or one of the electrodes. Another source of performance
decreasing ions/impurities is the current collector, e.g. corrosion of aluminum [36].

78

S. Weber et al.

5.3.1 X-ray Photoelectron Spectroscopy (XPS)

LiBs rely strongly on the SEI. The SEI forms at the anode and cathode, thereby
protecting the battery from further degradation [3, 16, 28, 29, 33]. The SEI formation
depends on the active materials and the electrolyte used in the battery [7, 9, 18, 19,
27, 32]. For analyzing the ageing mechanisms of LiBs, the characterization of the
structure and composition of the SEI is of great interest. XPS is a surface-sensitive
method. The information depth is in the range of 3 nm, and it is one of the few methods
where lithium can be directly analyzed. Using sputter-depth proﬁling XPS (SDP-
XPS), the thickness, structure and composition of the SEI can be investigated [13].

5.3.2 Scanning Electron Microscopy (SEM) and

Energy-Dispersive X-ray Spectroscopy (EDX)

SEM is an image-based method and a very useful tool for investigating the ageing
effects of LiBs. Low magniﬁcations give an overview of the electrode surface.
Cracking of the electrode due to binder disintegration can easily be observed. At
higher magniﬁcations, the electrode materials can be investigated. To visualize
the SEI or the binder, it is important to choose a proper accelerating voltage. At
high accelerating voltages, organic structures such as the SEI or the binder might
not be seen or can even be destroyed by the electron beam. Figure 5.6 shows
images of an aged graphite-based anode at magniﬁcations of 50,000 times (inset) and
100,000 times. The inset in Fig. 5.6 shows the layered structure of the graphite. The
spherical particles with a diameter of approximately 40 nm are typical for a conduc-
tive agent such as Super P®Li. The image taken at a magniﬁcation of 100,000 times
shows the web-like structure of the PVDF-based binder and the SEI that grew during
cycling.

Energy-dispersive X-ray spectroscopy (EDX) analyses the X-rays emitted during
SEM for the elemental analysis or chemical characterization of the specimen [5]. With
EDX, it is possible to analyze striking particles or areas, or even to map the whole
section, as shown in Fig. 5.7. The EDX mapping reveals that the cathode consists of
two different active materials. In addition, EDX of the individual particles shows the
composition of the different active materials: LiNi0.5Mn0.3Co0.2O2, and LiCoO2.

5.3.3 Elemental Analysis (ICP, TXRF)

The distribution of the speciﬁc impurities or reaction processes on the surface of the
electrodes (and especially the quantiﬁcation in the bulk material) can be character-
ized using Inductively Coupled Plasma (ICP) techniques or techniques such as total
reﬂection X-ray ﬂuorescence (TXRF).

5 Analytical Methods for Investigation of Lithium-Ion Battery Ageing

79

Fig. 5.6 SEM image of a graphite-based anode taken at 1 kV and a magniﬁcation of 100,000 times.
The inset shows a magniﬁcation of 50,000 times

Fig. 5.7 EDX mapping of a cross section of a cathode. a Mix of the EDX signals. Green indicates
LiNi0.5Mn0.3Co0.2O2, and blue LiCoO2. b Electron image of the cross section. c–e EDX signals
of the Kα1 line of cobalt, nickel, and oxygen

5.3.4 Raman Spectroscopy

Raman spectroscopy can be used to investigate the exfoliation of graphene layers
that can occur on graphite anodes. The Raman spectrum of highly ordered graphite

80

S. Weber et al.

Fig. 5.8 Raman spectra of a pristine composite graphite electrode and the same electrode after 140
potentiodynamic intercalation–deintercalation cycles (10 µV s−1) in a 1 M LiPF6 in EC:EMC 1:2
electrolyte solution at 25 ◦C. (Reprinted from [12] (Fig. 3), Copyright 2005, with permission from
Elsevier)

shows one band at 1580 cm−1, which can be attributed to in-plane symmetric C–C
stretching modes, the G band (cf. Fig. 5.8) [12]. Disorder in the crystal structure,
which can be caused by exfoliation of graphene layers, leads to the evolution of the
D band at 1350 cm−1, which is attributed to a breathing mode of sp2-carbon atoms
in rings. The ratio of the integrated intensities of both bands is related to the degree
of disorder and thus serves as an indicator for the degree of exfoliation of the anode,
as shown by Markevich et al. [12].

5.4 Analysis of Separator

Degradation of the separator has a signiﬁcant inﬂuence on the performance of a
lithium-ion battery. Norin et al. [14] showed the inﬂuence of the separator degradation
on the power loss in LiBs that had been exposed to elevated temperatures. The ionic
conductivity of all cells decreased, and atomic force microscopy (AFM) revealed a
signiﬁcant loss in porosity. They concluded that the loss in porosity resulted in the
rise of the separator impedance and hence a loss of ion conductivity. In addition, pore
clogging due to electrolyte decomposition leads to an increase of the separator and
thus cell impedance [8]. Peabody et al. [15] investigated the inﬂuence of external
stress and mechanical stress due to electrode expansion and contraction during charge
and discharge. Mechanical stress such as pressure can cause viscoelastic creep in the
separator material. This viscoelastic creep leads to closing of the pores and hence
to an increase of the cell impedance, resulting in a loss of capacity and power.

5 Analytical Methods for Investigation of Lithium-Ion Battery Ageing

81

Hence, analysis of the porosity, pore size and resistance of separators is necessary
for the investigation of ageing effects.

SEM and AFM are image-based tools for analyzing separators. With the help of
these methods, the surface and the general structure of the separators can be analyzed,
as well as the distribution, structure and diameter of the pores.

For more precise investigations on the inﬂuence of these properties on the ageing

of lithium-ion batteries, quantitative methods have to be applied.

One quantitative method for measuring the air permeability is the determination
of the Gurley number tG, which is dependent on the porosity (ε), pore size (d),
thickness (l) and tortuosity (τ ) of the membrane investigated [4, 21]:

tG = 5.18 × 10

−3 ×

τ 2 × l
ε × d

.

Pinholes in the separator lead to low Gurley numbers. Thus, several different

samples from the same cell have to be measured to obtain reliable results.

The MacMullin number (Nm) is calculated by the ratio of the resistivity of the
electrolyte-ﬁlled separator (ρS) and the resistivity of the electrolyte alone (ρE )
[1, 11]:

with

Nm =

ρS
ρE

=

τ 2
ε

ρx = Rx × A

l

(5.1)

(5.2)

(5.3)

where τ is the tortuosity, ε is the porosity, Rx is the measured resistance, A is the area
of the sample, and l is the thickness of the membrane. Determination of the electrical
resistance of a membrane is considered to be a more accurate way to measure the
permeability of a membrane than air permeability [21].

Mercury intrusion porosimetry is used to determine the porosity of pristine and
aged separators. Together with the MacMullin number the tortuosity of the mem-
branes can be calculated.

5.5 Ageing of Electrolytes

To obtain a full image on the ageing behavior of an organic electrolyte used in
an LiB, it is necessary to combine several analytical methods. There is no method
available that can simultaneously detect ionic compounds and organic compounds, as
well as elemental impurities. Combining all of the methods presented in this section
leads to the decomposition scheme of electrolyte and the containing conducting salt
(Sect. 5.6).

82

S. Weber et al.

Fig. 5.9 GC-MS Chromatogram of an anode washing solution of a commercially available elec-
trode. (Reprinted from [25] (Fig. 4), Copyright 2014, with permission from Elsevier)

5.5.1 Gas Chromatography (GC)

The volatile species in the electrolyte are usually detected and identiﬁed with the
help of gas chromatography. The detector is normally a mass spectrometer (MS)
or a ﬂame ionization detector (FID), and both are sometimes used simultaneously.
Depending on the composition and the target compounds, detectors such as the
nitrogen-phosphorous detector (NPD), the thermal conductivity detector (TCD) or
the electron capture detector (ECD) can be used in addition. Furthermore, using the
headspace sampling [25] technique, electrolyte residues which stick to the surfaces or
are incorporated into the electrodes can be identiﬁed and quantiﬁed using standards.
Compared to the other detectors, the mass spectrometer is normally used to identify
compounds, but it can also be used for quantiﬁcation. A GC-MS chromatogram of an
anode washing solution is shown in Fig. 5.9. A large variety of different compounds
were detected.

5.5.2 Ion Chromatography (IC)

Ion chromatography can be used in different ways in electrolyte investigations.
First, this method can be used to determine the elemental concentrations of halides

5 Analytical Methods for Investigation of Lithium-Ion Battery Ageing

83

Fig. 5.10 Proposed decom-
position pathway of
lithium hexaﬂuorophosphate
(Reprinted from [23] (Fig. 6),
Copyright 2012, with permis-
sion from Elsevier)

(especially ﬂuorine), alkali and alkaline earth metals. Second, in combination with
electrospray ionization mass spectrometry (ESI-MS), IC can identify unknown
decomposition products via their mass-to-charge (m/z) ratio. Therefore, it is a very
important tool for the characterization of ageing effects in all kinds of electrolytes
[10, 24].

5.5.3 ICP-OES / TXRF

These techniques are used to detect elemental impurities in the electrolyte. In com-
parison to the IC, these techniques are particularly well-suited for quantifying metal
contents. Depending on the exact composition of the samples, radial ICP-OES sys-
tems are preferred over axial systems, since the special setup allows for the analysis
of a higher organic content without additional dilution steps. With matrix matching
standards, even quantitative information is accessible.

Furthermore, the coupling of IC and ICP-OES or ICP-MS can deliver valuable
quantitative information when there are no standards available, especially in the case
of the decomposition products. TXRF requires only small amounts of electrolyte
(5–10 µL), but it cannot measure lithium. Therefore, it is used for the determination
of transition metal impurities.

5.6 Decomposition Scheme of Commercial Electrolyte

Combining all of the methods described above makes it possible to develop a decom-
position scheme of the electrolyte under investigation. Figure 5.10 shows the decom-
position scheme of the conducting salt LiPF6.

The decomposition scheme of a standard electrolyte based on a mixture of ethylene

carbonate and diethyl carbonate is shown in Fig. 5.11.

84

S. Weber et al.

Fig. 5.11 Proposed decomposition pathway of EC:DEC 3/7 (Reprinted from [24] (Fig. 7), Copy-
right 2013, with permission from Elsevier)

5.7 Quantitative Measurements

The need for quantitative measurements and results regarding the ageing effects
in lithium-ion batteries is quite high. Since quantitative results always depend on
the calibration and therefore on the availability and quality of certiﬁed standards or
reference materials, it is difﬁcult to quantify new/unknown decomposition products
or compounds which are not stable as a solution.

For elemental analyses such as ICP-OES, TXRF or, in some cases, IC (e.g. the
halides), the situation is quite easy. For every element, there is a single or multiele-
ment standard available. But since the standards are normally aqueous, the matrix
of the electrolyte or the dissolved electrode (e.g. acidic content) has to be matched.
Otherwise, incorrect results will be obtained, which leads to the drawing of wrong
conclusions regarding the ageing effects. One exception to the rule is the LA-ICP-
MS, since the available standards normally consist of a glass matrix, which does
not match the electrodes. Therefore, new standards have to be developed to gain
quantitative information with this method.

For most of the organic carbonates and additives, the situation is the same. With
the matching standards and matrix, the compounds can be quantiﬁed via GC or

5 Analytical Methods for Investigation of Lithium-Ion Battery Ageing

85

HPLC measurements. When there is no standard available, especially for coupling
techniques such as IC-ESI/MS or LC-ESI/MS, the concentration cannot be quantiﬁed
or even estimated. One approach is the coupling of the chromatographic system to
an ICP-OES or ICP-MS system. With this combination and a compound which is
similar to the target compounds it is possible to obtain quantitative information.

In general, it can be concluded that, besides the development of new techniques
and methods for the investigation of ageing effects in lithium-ion batteries, new
standard materials and certiﬁed reference materials have to be developed as well.
Otherwise, the exact inﬂuence of ageing effects cannot be quantitatively derived
from measurements.

Acknowledgments The authors acknowledge the ﬁnancial support of Westfälische Wilhelms-
Universität Münster, the Ministry for Economic Affairs, Energy and Industry (MWEIHM) of the
State of North Rhine-Westphalia, the Ministry of Innovation, Science and Research (MIWF) of
the State of North Rhine-Westphalia, the German Federal Ministry of Economics and Technology
(BMWi), and the German Federal Ministry of Education and Research (BMBF). Sascha Weber
furthermore acknowledges the ﬁnancial support of the “COMET K2 - Competence Centers for
Excellent Technologies Program” of the Austrian Federal Ministry for Transport, Innovation and
Technology (BMVIT), the Austrian Federal Ministry of Economy, Family and Youth (BMWFJ),
the Austrian Research Promotion Agency (FFG), the Province of Styria, and the Styrian Business
Promotion Agency (SFG).

Abstract The optimization of lithium-ion cells is becoming increasingly important.
Using models that reﬂect the fundamental electrochemical processes is advantageous
for this purpose. These models are typically computationally expensive and hard to
invert using optimization methods. Additionally, deterministic optimization methods
do not yield information regarding parameter uncertainties in the presence of noise.
To overcome this problem, it is possible to apply Bayesian methods. This chapter
provides an overview of parameter estimation. After a brief introduction to the model,
parameter selection and modelling of the prior is presented. Finally, we present the
results of a synthetic ﬁtting problem solved by a parallel adaptive Markov chain
Monte Carlo method. We validate the approach and compare it to realistic noisy data
and a separated method.
Keywords Parameter estimation · Parallel MCMC · Lithium-ion cell model

cx,0
ˆDx
Dx
di (θ )
e
F
f (·, θ )
Fi
¯f ( ¯θ )
i(t)
j →
BV
k
ka:c
n
p(y|θ )
q(·|θ n)
Q1
⊆
Q
1
Q2
r
R0
Ra
Rc
Rg
Rn
T
ti
t j
+
t
π

u
UOCV
y, yi
z
Φ
Φ(·, ˆθ )
η
ηx
ηπ:s
ηπ+s
ηα
∂x

Initial Li+-concentration
Diffusivity
Effective Diffusivity
Elementary effect of variable θi
Random number in (0,1)
Faraday’s constant
Model output
Distribution of effects of θi
Model output for target parameters
Cell current density
Butler-Volmer current density
Exchange current density and reaction rate
Combined factor ka/kc
Number of sample
Likelihood function
Parameter proposal distribution
Space-time cylinder of Δ
Space-time cylinder of Δ ⊆
Space-time cylinder of ν
Radial coordinate in particles
Proposal deviation of q(·|θ0)
Particle radius in anode
Particle radius in cathode
Universal gas constant
Proposal deviation of q(·|θn) at sample n
Final simulation time
Time at step i of reference model
Time at step j of model under test
Transference number of cations

Unknowns of the model
Equilibrium potential function
Points of measurements
Number of transferred electrons
Charge transfer coefﬁcient
Acceptance probability
Measurement error
Phase x volume fraction
Combined factor ηπ/ηs
Combined factor ηπ + ηs
Small value to add to Rn
Electric potential in phase x

6 Bayesian Inference for Lithium-Ion Cell Parameter Estimation

91

γ
ˆσ(cπ)
σ (cπ)
νa
νc
ν
μ
μπ
Δa
Δc
Δs
Δ
Δ ⊆
φ(θ )
φ(θ |y)
ε
ˆεs
εs
θ
θ0
θa
κ
θb
ˆθ
˜θ(θ)
¯θ
λ
Ω

Overpotential in j →
BV
Ionic conductivity function
Effective ionic conductivity
Anode domain in particles
Cathode domain in particles
Combined anode and cathode model domain
Sample mean
Migration coefﬁcient
Anode model domain
Cathode model domain
Separator model domain
Entire model domain
Combined anode and cathode model domain
Prior probability
Posterior probability
Sample or measurement noise standard deviation
Electronic conductivity
Effective electronic conductivity
Parameter set of interest
Initial parameter values
Lower parameter bounds
Integrated autocorrelation time
Upper parameter bounds
Proposed parameter
Transformed parameters
Target parameters
Parameter space
Temperature

6.1 Introduction

Compared to combustion-engine-based vehicles, battery-powered and hybrid vehi-
cles are clearly more environmentally friendly during operation. To increase the
efﬁciency of batteries and control strategies, having knowledge about the internal
state and material parameters is becoming increasingly important. The internal state
is a comprehensive term that includes abstract quantities (e.g. state of charge (SoC),
state of function and state of health) and physical quantities (e.g. potentials and con-
centrations). The latter are reconstructed as closely as possible from measurement
data in order to deduce material parameters which are not accessible or measurable.
In order to describe internal states and processes within lithium-ion cells, Fuller
et al. devised a system of coupled non-linear partial differential equations (PDEs) in
one dimension [2], which was subsequently improved and extended by Newman and
Thomas-Alyea [5] and many others. This system models the cell in terms of transport

92

M. K. Scharrer et al.

equations for lithium ions, chemical interaction and electronic ﬁeld computations in
active particles of anode and cathode. These equations are coupled by modelling
electrode kinetics that occur on the particle surfaces of electrodes.

Parameter estimation techniques focus on non-invasive methods only (i.e. without
the need to destructively open the cell). These methods estimate parameters by match-
ing predicted cell model output voltages for a given current proﬁle to experimental
measurements. Regarding the cell model, these studies require up to 50 parameters
to be tested. To get a better insight into the model behaviour and to reduce the number
of parameters being tested, a modiﬁed “Morris-one-at-a-time” (MOAT) parameter
screening was conducted [7].

Using the information obtained from parameter screening, a subset of relevant
parameters was selected. Taking prior knowledge about this subset into account, we
fed this information into a Markov chain Monte Carlo (MCMC) method.

Here, we demonstrate the application of MCMC for three cases using a recent
parallel adaptive sampling approach: estimate parameters and their uncertainty using
a synthetic proﬁle without noise, estimate uncertainty in the presence of noise and
estimate uncertainty in the presence of noise but without exploiting the power of
parallelism.

The remainder of this chapter is structured as follows: Sect. 6.2 provides an intro-
duction to parameter estimation in general. Section 6.3 deﬁnes the simulation frame-
work of the cell model and brieﬂy summarizes the solution procedure, Sect. 6.4
outlines the parameter screening method using MOAT as a way to reduce the com-
plexity of the parameter estimation problem. In Sect. 6.5 the inversion problem and
inﬂuences regarding measurement error are discussed. Finally, the solution algorithm
for estimating the parameters is deﬁned using statistical methods.

6.2 Inverse Problems: Making the Invisible Visible

6.2.1 Introduction

The aim of measurements is to get information about the system or phenomenon
under study. However, it is quite typical that we cannot directly measure quantities
of interest. Rather, the measured data depends, in some way, on the quantities desired,
and so at least contains some information about them. The relationship between the
quantities and data is described by a mathematical model. Solving the mathematical
model—calculating the output of it with certain inputs—is called a forward problem.
However, in order to obtain correct model predictions, the model must be correctly
formulated and calibrated. Starting with the data that we have measured, the problem
of trying to reconstruct the quantities that we actually want is called an inverse
problem. Loosely speaking, we say that an inverse problem is where we measure an
effect and want to determine the cause.

6 Bayesian Inference for Lithium-Ion Cell Parameter Estimation

93

Most science is data-driven in this way. Indeed, inverse problems are ubiquitous
in nature. All our senses, and the senses of any animals, are perfect examples of often
amazing solutions to inverse problems. Bats ﬁnd their way in complete darkness by
emitting sonar waves and constructing their environment by received echoes. Whales
and dolphins do the same in the ocean over long distances, and they can also locate
prey and predators. Our brain is able to produce an on-line image of our environ-
ment by the complex scattered light waves received by our eyes. Inverse problem
research is progressing in various ﬁelds of science by making the ‘invisible to visible’,
although we are still far behind nature in many respects. Most typical operational
examples are various non-invasive imaging techniques in medicine (e.g. ultra sound,
X-ray, dental tomography) and similar non-destructive methods in engineering,
such as electromagnetic sounding in ore prospecting, imaging techniques in security
checking, or timber tomography.

A somewhat more restricted type of data-driven problem is parameter estimation.
Here, we are not constructing continuous images of any media, but rather want to
calibrate a few given parameters of a mathematical model using measured data. To
recall the standard setting, consider a non-linear model

y = f (x, θ ) + η,

(6.1)

where y are the obtained measurements, f (x, θ ) is the model with design variables x
and unknown parameters θ , and the measurement error is denoted by η. The formula-
tion of the model f is typically based on the ﬁrst principles of physics and chemistry,
while solving the forward problem may require advanced numerical methods, as well
as effective computers. The most common approach for estimating the values of the
parameters is to match them against measurements using the Least Squares, LSQ,
criterion: minimize the sum of squares

l(θ ) =

[yi − f (xi , θ )]2.

(6.2)

n(cid:2)

i=1

In practice, for most models one can use standard optimization routines implemented
in computational software packages. However, since all available data contains mea-
surement errors, the estimated unknowns are to some degree uncertain. A natural
question then arises: if measurement noise corrupting the data follows some statisti-
cal distribution, what is the distribution of the possible solutions after the estimation
procedure? This question is the core of the study of statistical inverse problems. We
will discuss the Bayesian (probabilistic) framework below to give practical answers
to this question.

Noisy data is, however, not the only source of uncertainty in modelling. It may be
more challenging to estimate the impact of model bias due to insufﬁcient understand-
ing of the phenomena under study, or just the numerical approximation errors we
may have to make to minimize the CPU requirements. A recent development is the
focus on uncertainty quantiﬁcation (UQ) within computational models, particularly
in the computational science and engineering community.

94

M. K. Scharrer et al.

6.2.2 Deterministic Approaches: Linear and Linearized Models

For linear models, the statistics of parameter estimation can be readily deter-
mined. Consider a linear model with p variables, f (x, θ ) = θ0 + θ1x1 + θ2x2 +
. . . + θ px p, with noisy measurements y = (y1, y2, . . . , yn) obtained at points
xi = (x1i , x2i , . . . , xni ) where i = 1, . . . , p. We can write the model in matrix
notation,

y = Xθ + η,

where X is the design matrix that contains the measured values for the control vari-
ables, augmented with a column of ones to account for the intercept term θ0. It is not
difﬁcult to derive a direct formula for the LSQ estimator that minimizes SS(θ ) =
||y − Xθ ||2

2. The solution to the normal equations XT Xθ = XT y is written as

(6.3)

(6.4)

ˆθ = (XT X)−1XT y.

To obtain the statistics for the estimate, we can compute the covariance matrix
Cov( ˆθ ). With the common assumption that there is independent and identically dis-
tributed measurement noise with measurement error variance ε 2, the covariance
matrix for the measurement is given as Cov(y) = ε 2I, where I is the identity matrix.
The parameter uncertainty is then characterized by the covariance

Cov( ˆθ) = ε 2(XT X)−1.

(6.5)

The diagonal elements of the covariance matrix give the variances of the estimated
parameters, which are often reported by different statistical software packages. If we
further assume that the measurement errors are Gaussian, we can also conclude that
the distribution of ˆθ is Gaussian, with the mean and covariance matrix given by the
formulae above.

For non-linear models, no such direct formulae are available, and one must resort
to numerical methods and different approximations. The standard strategy in such
cases is to linearize the non-linear model and simply employ the linear theory. This
leads to the computation of the derivatives of the model with respect to the parameters.
The ﬁrst derivatives can be collected into a matrix that is called the Jacobian matrix
J, which has elements

[J]i p =

δ f (xi ; θ )
δθ p

|θ=(cid:3)θ ,

(6.6)

where the notation indicates that the derivatives are evaluated at the estimate (cid:3)θ, at
every measurement point xi . The Jacobian matrix J assumes the role of the design
matrix X in the linear case. That is, the approximative error analysis for non-linear
models, assuming independent and identically distributed Gaussian errors with mea-
surement error variance ε 2, is given by the covariance matrix

Cov( ˆθ ) = ε 2(JT J)−1.

(6.7)

6 Bayesian Inference for Lithium-Ion Cell Parameter Estimation

95

The measurement error ε 2 can be estimated using repeated measurements. Often,
however, replicated measurements are not available. In this case, the measurement
noise can be estimated using the residuals of the ﬁt, using the ‘perfect model’ assump-
tion that residuals ◦ measurement error. An estimate for the measurement error can
be obtained using the mean square error (MSE):

ε 2 ◦ M S E = RSS/(n − p),

(6.8)

where RSS (residual sum of squares) is the ﬁtted value of the least squares function,
n is the number of measurements, and p is the number of parameters. That is, the
measurement error is computed as the average of the squared residuals, corrected by
the number of estimated parameters.

6.2.3 Bayesian Methodology

The approximative error estimates available from the linearisations are satisfactory
only if the true parameter distributions are close to the Gaussian distributions that
the linerarisation produces. However, there is no guarantee on this; often the non-
linear dependencies yield distributions that are far from the linearized ones. Here, we
discuss methods that reveal the true distributions, even with strong non-linearities.
We will show how these approaches, based on random or “Monte Carlo” calculations,
are able to produce samples from underlying distributions that converge to the true
distributions, if the sample size is large enough. Indeed, the sampling algorithms are
able to solve a “mission impossible”: we create an approximation of an unknown
distribution by sampling from it—even if we do not know from where to sample!

Samples may be produced by iterating the parameter estimation process several
times. To get different results, we must randomize some part of the process. There
are basically to options:
• Perturb the measured data and reﬁt the parameters.
• Perturb parameters, accept parameter values that give good enough ﬁts to data,

reject others.

Both options are based on the fact that data contains randomness or noise: in the
experiment, we might equally well have obtained somewhat different data points, and
thus different parameter estimates. In the ﬁrst option, we directly produce different
data values. This leads to various forms of Bootstrap methods. In the second approach,
data is not changed, but the uncertainty of data is taken into account by accepting,
roughly speaking, parameters that produce model predictions that ﬁt the data within
the noise level of measurements. This approach is the background idea of several
Markov chain Monte Carlo, or MCMC methods.

Both approaches might seem intuitively appealing. However, different interpre-
tations arise, which have been the focus of a long-standing dispute between two
opposing views on statistical methods, the “Frequentists against the Bayesians”. A

96

M. K. Scharrer et al.

key question here is how we interpret the nature of a parameter to be estimated: is
it a constant or variable? Treating parameters as constants is known as the classi-
cal or frequentist perspective in statistics. Bayesian thinking explicitly allows for
the unknown vector of parameters θ to be interpreted as a random variable with a
distribution of its own. This reﬂects the belief that θ is not a ﬁxed vector, but rather
can vary. In addition, this approach typically emphasizes the use of prior knowledge,
even of a subjective nature, in the estimation process.

A practically oriented researcher might ﬁnd the dispute somewhat academic. In
a real modelling project, are we so concerned about the “true” interpretation of
parameters? However, we certainly should be interested in the reliability of the
model predictions. It is essential to realize that parameter estimation problems do
not have a unique solution. A multitude of different parameter combinations may ﬁt
the data “equally well”, from the statistical point of view, as we take into account
the noise in the measurements.

6.2.4 Markov Chain Monte Carlo: MCMC

In general, MCMC methods keep the measured data intact, but vary the parameters
to ﬁnd “all” solutions close to measurements. Therefore, they belong to the Bayesian
school of methods. Indeed, for many scientists, the Bayesian approach is almost
synonymous with the use of MCMC methods. Moreover, the Bayesian methods
have gained tremendously in popularity in the last 20 years because of new MCMC
algorithms: they provide solutions to problems that classical methods simply cannot
handle. Another obvious reason for this trend is the continued evolution of more
powerful computers that can successfully run the algorithms.

There are several advantages of using MCMC to solve parameter estimation or
“inverse” problems. First, full characterization of (non-Gaussian) posterior distribu-
tions is possible. Second, we have full freedom in implementing prior information.
Even modelling errors can be taken into account in a ﬂexible way. Moreover, we
are less likely to get trapped in local minimums than when employing optimization
methods to get maximum a posteriori (MAP) estimates.

To ﬁx ideas, consider again the generic non-linear model yi = f (xi ; θ ) + ηi ,
where we assume the errors are normally distributed and independent between mea-
iid≈ N (0, ε 2). The vector θ is the unknown to be estimated by the
surements: ηi
measured data values yi . However, suppose ﬁrst that the true value of θ is known,
and that we have a perfect, unbiased model f (x; θ ) to represent the true behaviour
of our system. A measured value yi will then follow the normal distribution, with
f (xi , θ ) as the centre point. Since the errors ηi were assumed to be independent, the
distributions of the different measurements yi , i = 1, 2, . . . n are independent, and
the joint distribution for the measurement vector y = (y1, . . . yn) is obtained as the
product of distributions:

6 Bayesian Inference for Lithium-Ion Cell Parameter Estimation

p(y|θ ) =

n(cid:4)

i=1

1∇

2φ ε 2

(cid:5)
−(yi − f (x; θ ))2/2ε 2

(cid:6)

exp

(cid:8)

1

=

(2φ ε 2)n/2 exp

(cid:7)

n(cid:2)

i=1

−

(yi − f (x; θ ))2/2ε 2

.

(6.10)

97

(6.9)

Thus, we arrive at the familiar least squares function in the exponent, divided by

the assumed measurement error variance ε 2.

Note how we write the above distribution in the form p(y|θ ), which typically is
used for a conditional probability. Indeed, as we actually do not know θ , we should
interpret the above formula as the probability of y, on the condition that the true value
of the unknown parameter is θ . This expression is called the likelihood function; it
gives the likelihood of observing the measurement, with a given value for θ .

We return now to our original goal: to estimate the parameters θ for given values
of y. For this purpose, we might just change the roles of y and θ when considering
the expression (6.10) in the equation above. We could interpret it as representing
the distribution of θ with a given y. Note that maximizing the likelihood function
with respect to θ is equivalent to minimizing the sum of the squared residuals, so
this maximum likelihood estimator is just the least squares solution (cid:3)θ , in this case.
Moreover, values of θ that bring the values f (xi , θ ) close to data points yi should
be accepted to belong to the distribution of probable values of θ . However, we face
a problem here: there is no direct way to tell exactly which values of θ would belong
to that distribution, e.g., to the region that would contain the 95 % probability mass
around the maximum likelihood point. Indeed, as a function of θ , the expression
(6.10) is not even a normalized probability distribution.

The Bayes formula can be written as a generalization of the conditional probability

in basic probability calculus, as

φ(θ |y) = p(y|θ )φ(θ)
(cid:9)
p(y|θ )φ(θ)dθ

.

(6.11)

We summarize the main concepts of the Bayesian analysis as follows. First, we select
a prior distribution for the parameter vector θ , i.e. φ(θ ). We assume that the response
variable y has a distribution given by the likelihood p(y|θ ). Once we collect the data
y = (y1, . . . , yn), we update our prior distribution for θ using the Bayes rule to arrive
at the posterior distribution for θ , φ(θ|y)). To get a proper probability distribution
p(y|θ )φ(θ )dθ .
of total mass one, we have to calculate the normalizing constant
In principle, the Bayes formula solves the estimation problem in a fully proba-
bilistic sense: we ﬁnd the peak, the MAP point, of the parameter distribution. Then
we determine a required portion of the probability mass (typically 95 % or 99 % of
the mass) around it. However, we face the problem of how to calculate the integral
in the expression for the normalizing constant. The integration of the normalizing
constant is often a formidable task, even for an only moderately high number of para-
meters in a non-linear model. Therefore, a direct application of the Bayes formula is
intractable for all but trivial non-linear cases.

(cid:9)

98

M. K. Scharrer et al.

The MCMC methods provide a tool for handling this problem. They generate a
sequence of parameter values θ1, θ2, . . . θN , whose empirical distribution approxi-
mates the true posterior distribution for a sufﬁciently large sample size N .

The trick here is that we do not know the distribution from which to sample, but we
can still generate samples from it. Instead of sampling from the true distribution, we
can only sample from an artiﬁcial proposal distribution. By combining the sampling
with a simple accept/reject procedure, the posterior can be correctly approximated.
One of the most widely used MCMC algorithms is the random walk Metropolis
algorithm, which appeared as early as the 1950s in statistical physics literature. The
Metropolis algorithm is very simple: it works by generating candidate parameter
values from a proposal distribution and then either accepting or rejecting the proposed
value according to a simple rule. The Metropolis algorithm can be written as follows:
1. Initialize by choosing a starting point θ1
2. Choose a new candidate ˆθ from a suitable proposal distribution q(.|θn), which

may depend on the previous point of the chain.

3. Accept the candidate with probability

Φ(θn, ˆθ ) = min

1,

(cid:10)

(cid:11)

.

φ( ˆθ)
φ(θn)

(6.12)

If rejected, repeat the previous point in the chain. Go back to step 2.

The Metropolis algorithm assumes a symmetric proposal distribution q, i.e.
the probability density of moving from the current point to the proposed point
is the same as moving backwards from the proposed point to the current point:
q( ˆθ |θn) = q(θn| ˆθ).

One can see that in the Metropolis algorithm the candidate points that give a
better posterior density value than the previous point (points where φ( ˆθ ) > φ(θn)),
or move ‘upward’ in the posterior density function, are always accepted. However,
moves ‘downward’ may also be accepted, with the probability given by the ratio
of the posterior density values at the previous point and the proposed point. Note
that only the ratios of φ at consecutive points are needed, so the main difﬁculty is
removed: the calculation of the normalizing constant is not needed, since the constant
cancels out!

Most often, we may not actually want to specify a non-trivial prior distribution
for the solution. We may just know that the solution components must have some
bounded and positive values, leading to uninformative or ﬂat priors. For a given
parametrization then, we may just set a box of ‘simple bounds’, just lower and upper
bounds, to constrain the solutions. The analysis is now fully driven by data, assuming
that the posterior distribution of the parameters is well inside the given bounds. If,
on the other hand, the posterior does not stay inside any reasonable bounds, we
observe that the available data is not sufﬁcient to identify the parameters. We can
then consider a few options, before restricting solutions with informative priors:
• Design of Experiments. If non-identiﬁability of parameters is due to lack of data,
one obvious remedy is to design new experiments to gain more informative mea-
surements.

6 Bayesian Inference for Lithium-Ion Cell Parameter Estimation

99

• Model reductions. Often, however, the non-identiﬁability is an inherent feature of
the forward map, and no measurable data (or just re-parametrisation) can correct
the situation. One alternative option for ﬁxing priors for unidentiﬁed parameters
is to simplify the model, and thus reduce the list of parameters to be identiﬁed.

Typically, the Bayes formula is seen as the way of putting together a ﬁxed prior,
data, and model. However, we can also use Bayesian sampling techniques as ﬂexible
tools in the context of design of experiments, as well as model reductions. As such,
we can employ the sampling methods for model development, which may guide all
the relevant steps of model building.

6.3 Model of a Lithium-Ion Cell

There are a wide range of different existing models for describing the performance
of lithium-ion cells—see Chap. 4. Since many models are unable to reﬂect effects of
physical processes inside the cell, we use a mechanistic model throughout the rest
of the paper that deﬁnes our forward problem. Using the model for estimation of
parameters based on observed values is then considered as our inverse problem

In order to describe the internal dynamic processes in a lithium-ion cell math-
ematically, an electrochemical model has been implemented following the widely
used Doyle- Fuller-Newman (DFN) approach, [5]. Due to complex geometries at
nanometre scale, together with a cell thickness of hundreds of microns, these models
cannot be solved with the greatest detail. Thus, the model can be stated as a sys-
tem of coupled non-linear partial differential equations in one dimension, trading off
computational speed and complexity.

A lithium-ion cell with two porous intercalation electrodes (cathode in Δc and
anode in Δa) and an electronically isolating separator in Δs in between is considered.
For homogenization purposes, each electrode is assumed to consist of two phases.
The solid phase is assumed to be spherical particles in both cathode (in νc) and anode
(in νa), which line up continuously in the x direction. The liquid phase modelled in
each electrode is electrolyte. In the separator Δs, we only consider electrolyte, as the
solid phase in the separator does not participate in any reactions taken into account.
Figure 6.1 shows a schematic view of the modelled domain.
The governing equations of the one-dimensional cell model considered are deﬁned
by system (6.13).

−∈ ·

δ(ηπcπ)
δt

(cid:12)

−∈ · (εs∈∂s) = −Ai j →
(cid:12)
(cid:13)
σπ(cπ)∈∂π + RgΩ
σπ(cπ)t
∈cπ
(cid:13)(cid:13)
(cid:12)
z F
∈cπ + z F
RgΩ μπcπ∈∂π
− ∈ ·
(cid:12)
δcs
Dsr 2 δcs
δ
− 1
δr
δr
δt
r 2

= Ai j →
BV
z F j →
= Ai

= 0

Dπ

+
π

1
cπ

BV

(cid:13)

BV in Q⊆

:= Δ ⊆ × [0, T ]
in Q1 := Δ × [0, T ]

1

in Q1
in Q2 := ν × [0, T ]

(6.13)

100

M. K. Scharrer et al.

a

aRo,

~ 
~ 
~ 
~ 

Λ

a

r 

aRi ,

Current 
Collector 
(not modelled) 
e- 

a

Ω
~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

c

Ω
~ 

~ 

~ 

~ 
~ 
~ 
~ 
Negative 
Electrode 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 

~ 
~ 
~ 
~ 
Positive 
Electrode 

~ 

~ 

~ 

cRi ,

s

sc,

sa,

~ 

~ 

Ω
~ 
~ 
~ 

~ 
~ 
r 
~ 
~ 
~ 
~ 
Separator 

Electrolyte 

c

cRo,

x

~ 

c

~ 

Λ
~ 
Current 
Collector 
(not modelled) 
e- 

r 

Li+ 

r 

Particle

Particle

Fig. 6.1 Problem Domain: The spatial domains are deﬁned as Δ = Δa ⊂ Δs ⊂ Δc ⊂ R,
Δ ⊆ = Δa ⊂ Δc, νa = Δa × [0, Ra] ⊂ R2, νc = Δc × [0, Rc] ⊂ R2, ν = νa ⊂ νc and
Ra, Rc ∈ R

In the liquid phase, the variables are potentials ∂π and concentrations cπ. In the solid
phase, the variables are split into cathode potentials ∂sc and concentrations csc and
anode potentials ∂sa and concentrations csa. To shorten the notation, we combine the
system variables in an unknown vector u := (∂sa, ∂sc, ∂π, cπ, csa, csc). The system
variables are deﬁned as time and space-dependent u(x, t) at times t ∈ [0, T ], T ∈ R
and at space points x ∈ R and (x, r ) ∈ R2, respectively.

Since diffusivity and conductivity must be effective values, they are modelled by

taking the porosity into account:

εs := ˆεsηbruggs

s

,

σπ := ˆσπηbruggπ

π

, Ds := ˆDsηbruggs

s

, Dπ := ˆDπηbruggπ

.

π

(6.14)

The Butler-Volmer expression (6.15) couples the system Eq. (6.13).

(cid:7)

(cid:12)

(cid:12)

(cid:13)

(cid:12)

(cid:13)(cid:13)

exp

Φz Fγ
RΩ

− exp

−(1−Φ)z Fγ
RΩ

+ Cdl

δ(∂s −∂π)
δt

ll j

→
BV

=

z Fk
0

in Q⊆
else

(6.15)

γ = ∂s − ∂π − Uocv(cs)

Homogeneous Neumann conditions are applied at the boundaries, except for the
outer boundaries of potentials ∂s and concentrations cs in the solid phase:

∂s = 0

on αa := Γa × [0, T ]
−εs∈∂s = −i (t) on αc := Γc × [0, T ]
−Ds

= 1

z F j →

δcs
δr

BV on αRo := ΓRo,a ⊂ ΓRo,c × [0, T ] .

(6.16)

In addition, the concentrations are restricted by the initial conditions: cx (t = 0) =
cx,0 in phase x in Δ and ν, respectively. The potentials are consistently initialized
at rest by the condition j →
(x, 0) = 0. This system of four non-linearly coupled
BV
partial differential equations is solved by applying the Finite Element Method with

6 Bayesian Inference for Lithium-Ion Cell Parameter Estimation

101

linear test functions for spatial discretization and Backwards Euler Method for time
integration. The non-linearity is solved by a damped Newton Method.

6.4 Sensitivity of Parameters

Due to the number of parameters in the model (up to 50) estimating all parame-
ters at once is considered infeasible. It is thus necessary to simplify the model, as
pointed out in Sect. 6.2. As a form of model reduction, we determine a reduced set
of scalar parameters that still characterize the model response the most. One such
tool for ranking the parameters according to their inﬂuence is “Morris-one-at-a-time”
(MOAT) [4] parameter screening. This screening method yields a qualitative ranking
of the parameters in terms of their global effects on the model response and enables
decisions about which parameters to ﬁx for parameter estimation. The method is
based on elementary effects
(cid:14)

(cid:15)

di (θ ) =

f (θ 1, θ 2, . . . , θ i−1, θ i + ∆, θ i+1, . . . , θ k) − f (θ )

/∆

(6.17)

of model responses f (θ ) for a given parameter set θ sampled along random tra-
jectories in design space λ. The distribution of effects associated with the ith input
parameter is denoted by Fi . From this distribution, we can deduce qualitative infor-
mation regarding “overall” inﬂuence—by large mean values μi of Fi (di )—and high
dependency on the input—by large spread εi of Fi –, i.e. high interaction between
parameters or high non-linearity, respectively. Since the monotonicity of the model
can not be assumed, it is important to incorporate the absolute value of the measure
μ→ of Fi (|di |) instead of μ—otherwise, elementary effects could cancel each other
out, see [7].

For the design, the deviation in output voltage of a hybrid module driving the
“New European Driving Cycle” was considered. Since input factors for the screening
need not necessarily resemble parameters of the model, it was possible to combine
dependent parameters pairwise, i.e. the electrolyte volume fractions ηπ and solid
volume fractions ηs in anode and cathode where merged into two factors representing
the sum of fractions ηπ+s and their ratio ηπ:s, such that they may not exceed their
physical limits when using simple boxing bounds.

Figure 6.2 shows the qualitative result of the screening experiment for several
parameters of interest. It is thus reasonable to assume that parameter changes for
many parameters will show minimal effects on the output, e.g. εs. Because of the
high non-linearity and interaction between parameters indicated by high mean and
high spread, k and Ds will most probably have a signiﬁcant impact on the output.

M. K. Scharrer et al.

102

Fig. 6.2 Inﬂuence of model
parameters according to
“Morris-one-at-a-time” global
sensitivity analysis. Parame-
ters to the right show more
direct inﬂuence than those
on the left. Parameters at the
top show higher non-linear or
coupled effects on the output
than those near the bottom

Table 6.1 Input program
applied: A discharge pulse
from 55 % state of charge
(SoC) to ◦ 45 %

Step

Description

0
1

2

Initialize the cell to 55 % SoC
Discharge at 5A/Ah constant current for 72 s to

◦ 45 % SoC

Rest at zero current for 600 s,

6.5 Statistical Inversion Using MCMC

In this section, we consider the statistical inversion as described in Sect. 6.2.4 of
estimating the parameters of the model deﬁned in Sect. 6.3 matching the simulated
cell voltage f (θ ) := ∂s|Γc

(θ ) to a predeﬁned proﬁle y, e.g. measurements.

6.5.1 Data and Priors

For the sake of brevity, we assume the static inﬂuence, e.g. open-circuit voltage
(OCV) and initial concentrations, to be completely separable from dynamic inﬂuence,
e.g. diffusion and kinetic rates. This is conﬁrmed by Speltino et al. in [9]. They
describe identifying parameters of a single particle model of battery dynamics in two
steps. In the ﬁrst step, the equilibrium potential function of the cathode is identiﬁed
from OCV measurements, assuming an equilibrium potential function of the anode
from the relevant literature. The second step involves performing dynamic tests to
estimate the remaining model parameters.

For estimating the data, we deﬁne a minimalistic input program i(t) that we apply

to both measurement and simulation, as shown in Table 6.1.

6 Bayesian Inference for Lithium-Ion Cell Parameter Estimation

103

Table 6.2 Reduced parameter set under test: The table shows initial values θ 0, lower bounds θ a,
upper bounds θ b, the applied scaling and the target values of the parameters
Name Initial value θ 0 Lower bounds θ a Upper bounds θ b Scaling ˜θ(θ)
Ds,c
Ds,a
Dπ
μπ
kc
ka/kc 5.0

Target ¯θ
log10(θ /1.0e-18) 4.0e-17
log10(θ /1.0e-15) 4.5e-13
log10(θ /1.0e-15) 4.0e-11
log10 (θ)
log10(θ /1.0e-09) 9.0e-04
log10(θ /1.0e-02) 9.0e-04/ 9.0e-04

1.0e-13
1.0e-09
1e-08
1.
1.0e-02
1.0e+02

1.0e-18
1.0e-15
1e-15
1e-12
1.0e-09
1.0e-02

4.0e-16
4.5e-14
6.0e-10
1.0e-05
9.0e-05

0.1

We arrive at measurements y = {yi } at time points ti , which are related to the
change of the cell voltage. We introduce the reduced parameter vector θ ∈ λ :=
{θ ∈ Rm|θ a ≤ θ ≤ θ b}. For a parameter set θ, simulation yields f (t j ; θ ) at time
points t j ≤ T , which are controlled by an adaptive time stepping algorithm, that
aims to give local “close-to-linear” behaviour with respect to time for internal states.
We assume that the observed voltages do not coincide exactly with the true ones
of the battery at measured points, but rather that they are subject to Gaussian noise
with standard deviation ε . Therefore, the observation model as in Sect. 6.2.4.

Since we do not know much about the parameter set, we choose the parameters
in θ , as depicted in Table 6.2. Since the magnitude of the parameters spans a wide
range, we introduce ˜θ as the transformed parameter vector with logarithmic scaling
applied. Since early tests revealed high correlation between ka and kc, we introduced
a combined factor of ka:c := ka/kc instead of ka. For the transformed parameters,
we assume a ﬂat prior. For the update, we use a random walk proposal kernel using
Gaussian distribution initialized to R0 = 0.001 ˜θ 0. The measurement noise deviation
and noise in (6.10) were set at ε = 10−3, which is considered a realistic value.

6.5.2 Posterior Sampling

Due to the high stiffness of the model, the ﬁrst run of a sampling chain is performed
for parameters θ 0 using adaptive time step sizes. The resulting time points t j are
saved for later reuse in subsequent model evaluations.

The sampling is performed similar to the way proposed by Solonen et al. in [8].
It is done in parallel independent chains using Metropolis with adaptive proposal
distributions q( ˆθ |θn) ≈ N (θ n, R2
). The proposal deviation is set Rn = R0 for
n
n < 20 and for n ≥ 20, it is updated to Rn = chol(Cov(θ star t , . . . , θ chainsn
)) + ηα .
The computation of the Covariance across all available samples starting from some
index star t is performed in a special server, which is the only connection between
the chains. To increase adaptivity, star t grows from 0 by 0.49 per new parameter
set per chain. To ensure that Rn does not vanish, we add ηα = 0.001R0. Because of
the “ﬂat” prior and symmetric proposals, the acceptance Φ becomes (6.12).

104

M. K. Scharrer et al.

To further speed up computation, the idea of “Early Rejection” was adopted,
which was ﬁrst applied in [1] and [6]. First, a random number e ∈ (0, 1) is chosen.
Simulation is then executed stepwise, and in every time step t j

e <

j(cid:4)

k=1

L(yk| f (tk; θ k+1))
L(yk| f (tk; θ k))

(6.18)

is evaluated, and the simulation is aborted as soon as the condition is violated.
(cid:17)

As target value y, we chose a simulated measurement by running the model at
was

the target parameters ¯θ. To avoid “inverse crime”, the reference model
evaluated at different points in time ti (cid:13)= t j than the model f (θ ).
Three tests were performed to evaluate the sampling algorithm:

(cid:16)
¯θ

¯f

• Parallel simulation without noise—The simulation was performed in six paral-
lel chains. The start parameters were set to θ 0. All chains were stopped at the
same time after they had reached a little more than 20,000 evaluations. The ﬁrst
10,000 samples per chain were discarded as a “burn-in” period to allow φ (i.e. the
distribution of the Markov chain) to reach equilibrium distribution.

• Parallel simulation with noise—The start parameters were set to ¯θ . The simulation
was performed in ﬁve parallel chains. The simulation was aborted after all chains
had reached a little more than 2,500 evaluations. The ﬁrst 1,000 samples per chain
were discarded as a “burn-in” period.

• Individual simulation with noise—Although settings were the same as for the
parallel simulation with noise, this simulation was performed in three chains with
no connection.
Figure 6.3 shows the results of the input proﬁle i (t) as deﬁned in Table 6.1 and the
results for the target, as well as initial and best evaluations of the simulation without
noise.

6.5.3 Posterior Variability of Parameters

The statistics of the estimated parameters and uncertainties are displayed in Table 6.3.
Figure 6.4 shows the posterior distributions of the parameters. Although the noiseless
test was expected to show very little standard deviation, it is remarkable that the error
made by interpolation of the values at time points from t j to ti seems to dominate
the results.

Furthermore, it is evident, that the individual chains do not to sample from the
entire distribution, as the statistics show very little deviation from the starting point.
This can also be seen in the scatter plots in Fig. 6.5. Samples of the parallel chains
cover large areas in the plots, whereas samples of the individual chain cover a slightly
smaller part only and in a more dense fashion.

6 Bayesian Inference for Lithium-Ion Cell Parameter Estimation

105

Fig. 6.3 Comparison of the initial voltage curve, synthetic target voltages and ﬁnal voltages after
estimation of the parameter set of interest θ

˜Dπ

˜Ds,a

Table 6.3 Results of the uncertainties: Abbreviations are: #A Parallel chains without noise, #B
Parallel chains with noise, #C,#D,#E individual chains with noise, Ref Target parameters ¯θ
MCMC ˜Ds,c
#A
#B,
#C
#D
#E
Ref

˜μπ
1.601±0.002 2.662±0.019 4.604±0.016 −1.025±0.063 5.957±0.075 1.994±0.078
1.603±0.002 2.666±0.018 4.592±0.015 −0.969±0.056 6.044±0.093. 1.908±0.096
1.603±0.002 2.662±0.016 4.603±0.005 −1.003±0.003 5.960±0.008. 1.996±0.008
1.915±0.082
1.603±0.002 2.665±0.017 4.590±0.015 −0.962±0.058 6.038±0.08.
1.928±0.093
1.605±0.002 2.648±0.011 4.598±0.015 −1.001±0.057 6.025±0.09
2.000±0
1.602±0

−1.000±0

5.954±0

4.602±0

2.653±0

˜ka:c

˜kc

Figure 6.5 also reveals the strong dependence between Dπ and μπ, and kc and ka,
respectively. These strong correlations and the shape of the posterior distributions also
indicate the logarithmic scaling and selection of ka:c instead of ka. Direct sampling
of all factors without the transformation and combination applied would have lead
to statistical and computational inefﬁciency.

6.5.4 Statistical Efﬁciency

To assess the statistical efﬁciency, we use the measure of integrated autocorrelation
time (IACT). The IACT gives the number of updates of the MCMC algorithm to give
one effective independent sample. It was estimated for the posterior distributions by
estimating the autocorrelation functions (ACF) for all parameters. Ideally, the ACFs
for a stationary time series with little or no serial dependence reach zero quickly

106

s
e
l
p
m
a
s

f
o

n
o
i
t
c
a
r
F

s
e
l
p
m
a
s

f
o

n
o
i
t
c
a
r
F

0.3

0.2

0.1

0

0.3

0.2

0.1

0

c
,
s

˜D

M. K. Scharrer et al.

˜Ds,c

˜Ds,a

˜D

1.595

1.6

1.605

1.61

2.6

2.65

2.7

4.55

4.6

4.65

˜kc

˜ka:c

1.2

1

0.8

5.8

6

6.2

1.6

1.8

2

2.2

Parallel no noise

Parallel with noise

Individual with noise

Target value

Fig. 6.4 Results of model posterior

5
6
.
2

7
.
2

6
5
.
4

8
5
.
4

6
.
4

2
6
.
4

4
6
.
4

2
.
1

1
.
1

9
.

1 0

8
.
0

8
.
5

2
.

6 6

4
.
6

6
.
6

4
.
1

6
.
1

8
.
1

2
.

2 2

˜Ds,a

a

s

˜D

˜D

˜D

˜

˜

Instance 2 of chains #A without noise
Instance 2 of chains #B with noise
Individual chain #E with noise
Target parameter

˜kc

c
˜k

˜ka:c

Fig. 6.5 2D scatter plots showing pairwise correlation between the parameters in θ

1.61

1.61

1.6

1.6

2.7

2.65

4.64

4.62

4.6

4.58

4.56
0.8

0.9

1

1.1

1.2

6.6

6.4

6.2

6

5.8

6 Bayesian Inference for Lithium-Ion Cell Parameter Estimation

107

Asymptotic variance
Asymptotic variance
Asymptotic variance

ACF parallel without noise
ACF parallel with noise
ACF individual with noise

0

10

20

30

40

50

60

70

80

90

100

0

10

20

30

40

60

70

80

90

100

50
Lag

Fig. 6.6 Estimated Autocorrelation Function (ACF) for the MCMC simulations (The 95 % con-
ﬁdence intervals from the estimated asymptotic variance are superimposed with shaded patterns)

Table 6.4 Results of the integrated autocorrelation times κ

κ − ˜Ds,c
51.3
67.1
65.8
67.5
77.8
45.1
30.9
35.4
40
40.7
41.8
26.1
26.8
30.5

κ − ˜Ds,a
56.6
49.4
49.4
44.6
53.5
45.4
39.4
41.8
37.1
28.4
35.3
21.3
31.9
54.4

κ − ˜Dπ
46.7
52.7
54.2
53.7
63.8
60.4
49.5
45.2
43.2
41.2
47.7
28.6
39.2
49.2

κ − ˜μπ

45.5
55.3
56.9
48.2
63
60.3
50
54
43.5
40
53.8
25.5
45.3
53.5

κ − ˜Kc
55.5
48.6
45.7
55.6
62.3
53.6
33.5
55
44.3
31.9
36.4
19.5
33.7
26.1

κ − ˜Ka:c
55.7
48.8
46.3
56
62.7
53.8
33.3
54.6
44.4
32.2
35.5
18.9
34.6
26.3

0.5

0.5

1

0

1

0

˜D

f
o
F
C
A
d
e
z
i
l
a
m
r
o
N

c
:
a
˜k

f
o
F
C
A
d
e
z
i
l
a
m
r
o
N

MCMC

#A-1
#A-2
#A-3
#A-4
#A-5
#A-6
#B-1
#B-2
#B-3
#B-4
#B-5
#C
#D
#E

108

M. K. Scharrer et al.

for increasing lag. Since the example ACFs in Fig. 6.6 exhibit similar behaviour,
we conclude that only little serial dependence is present in the chains. To ﬁnally
compute the IACT from the ACF, we utilize the method proposed by [3]. This method
makes use of the pairwise summation of the ACF at consecutive lags and thus yields
useful overestimates of the IACT—see Table 6.4. The number of updates to give
one effective independent sample κ ranges between 19 and 78. The effective sample
numbers of the implemented MCMC algorithms vary between 1.3 and 5.0 % of the
real sample numbers. This makes the algorithms useful, but still slow, as a single
sample evaluation takes a long time.

6.5.5 Remarks on Computational Efﬁciency

In (6.18), we described the applied reduction of work load during the sample evalu-
ation. “Early Rejection” had a very high impact on the parallel chains without noise
that started from a distant point in parameter space. Due to the nature of the model,
it is possible to stop many evaluations at a very early stage because of extreme
deviations in the output or numerical issues that may arise, since not every possible
parameter combination makes sense. The effective work load could be reduced by
67.7 %. That is, by using “Early Rejection”, three times as many samples could be
evaluated than using the regular approach.

6.6 Discussion and Conclusion

This chapter shows the applicability of parameter estimation and uncertainty quan-
tiﬁcation of lithium-ion cells by Bayesian model inversion using the Markov Chain
Monte Carlo sampling approach.

We started with an introduction to parameter estimation in general, and then
focussed on estimating dynamic parameters and their uncertainties in a computational
model of a lithium-ion cell. We gave some insight into the modelling of the prior
and the set-up of the algorithm. Due to the complexity of the model, we parallelized
the approach and implemented “Early Stopping” as an additional means of reducing
computing times. We compared the results of synthetic measurements and presented
the statistical efﬁciency by investigating the integrated autocorrelation time.

The analysis of statistics in Table 6.3 and IACT in Table 6.4 indicate a sharp
distribution and a higher statistical efﬁciency for individual chains. Only the scatter
plots shown in Fig. 6.5 reveal the inferior sample coverage of the posterior in the
individual chain case. This necessitates the use of parallel chains.

The proposed approach has been shown to be appropriate for investigating the
dynamic properties of lithium-ion cells in the presence of noise. However, addi-
tional work must be done to incorporate stationary and quasi-stationary effects and
inﬂuences, such as the open-circuit voltage and geometric quantities.

6 Bayesian Inference for Lithium-Ion Cell Parameter Estimation

109

Acknowledgments The authors would like to acknowledge the ﬁnancial support of the “COMET
K2—Competence Centres for Excellent Technologies Programme” of the Austrian Federal Ministry
for Transport, Innovation and Technology (BMVIT), the Austrian Federal Ministry of Economy,
Family and Youth (BMWFJ), the Austrian Research Promotion Agency (FFG), the Province of
Styria and the Styrian Business Promotion Agency (SFG).

Abstract This chapter presents a data-based approach to nonlinear observer design
for battery state of charge (SoC) estimation. The SoC observer is based on a purely
data-driven model in order to allow for the application of the proposed concepts to any
type of battery chemistry, especially when conventional physical modelling is not eas-
ily possible. In order to cope with the complex nonlinear dynamics of the battery, an
integrated workﬂow for experiment design, model creation and automated observer
design is proposed. The nonlinear battery model is constructed using a proven training
algorithm based on the architecture of local model networks (LMNs). One impor-
tant advantage of LMNs is that they offer local interpretability, which enables the
extraction of local linear battery impedance models for automated nonlinear observer
design. The proposed concepts are validated experimentally using real measurement
data from a lithium-ion power cell.

7.1 Introduction

In the automotive industry, data-driven methodologies are becoming more and more
important due to the constantly increasing demands. Such methods create models
based on measured input and output data from the process and require little or no phys-
ical or formal information, see e.g. [29]. Especially in engine calibration, data-based
approaches have been established as an important tool for systematically dealing
with the growing complexity of automotive systems, see e.g. [10, 12]. In this con-
text, the optimisation of combustion engines and hybrid electrical vehicles comprises
the calibration of various controller parameters for both feedforward and feedback
controllers in engine and hybrid control units. Thereby calibration is understood as
the optimisation of vehicles and their subsystems through proper parametrisation of
various controller parameters.

One important requirement for an integrated methodology for the complete cali-
bration workﬂow is that both the experiment on the testbed and the model architec-
ture must be designed such that the model is able to cover all relevant effects, and
all parameter interactions can be taken into account in the optimisation procedure.
Such a model-based calibration workﬂow consists of the following steps: Experiment
design, nonlinear system identiﬁcation and controller/observer analysis and design.
Besides engine calibration, the optimisation of hybrid components has become
an important issue in recent years. Hybrid electrical vehicles require an accurate
online observation of the electric power supply. In this context, the development of
the battery management system (BMS) and the energy management system (EMS)
is thus a challenging task. One essential part of the BMS is a battery model, which
must be accurate under the speciﬁc loads and environmental conditions. One of the
most important functions of the BMS is determining the state of charge (SoC) of
the battery, as well as the charge and discharge control. Knowledge about the state
of charge, which cannot be measured directly, is thus essential in order to extend
battery life and preserve the usable capacity.

The present work describes the model-based calibration workﬂow using data-
driven models in general and presents the adaptation/extension of the proposed con-
cepts to battery modelling and the design of the associated nonlinear observer (see
also [11]). The remainder of this chapter is structured as follows: Sect. 7.2 pro-
vides an overview on the three major steps of the data-driven calibration workﬂow.
Section 7.3 presents the application of the proposed concepts for SoC observer design
and demonstrates the performance using real measurement data from a lithium-ion
cell.

7.2 Data-Driven Calibration Workﬂow

Since conventional physical modelling is difﬁcult in many situations, black-box and
grey-box-oriented nonlinear system identiﬁcation procedures have emerged as a fea-
sible alternative in model-based calibration. One important advantage of grey-box
approaches is that they enable reduced model complexity, if physical (or other) insight
into the nature of the object is available, [19]. In this context, local model networks
(LMNs) have proven to be a powerful tool, e.g. [4, 8, 17, 22]. LMNs can adapt to
the complexity of the problem in a highly efﬁcient way, and then also make it easy
to incorporate prior (physical) knowledge.

However, signiﬁcant expert knowledge and experience is required to use identi-
ﬁcation algorithms, even though these methods have been well developed. In order

7 Data-Driven Methodologies for Battery State-of-Charge Observer Design

113

to facilitate the operation of system identiﬁcation methods for non-experts, a uniﬁed
and generic model-based calibration workﬂow is proposed here. The major steps for
such an integrated methodology for model-based calibration are described below:

Experiment design: The design of experiments (DoE) is an important prerequisite
for data-based modelling approaches and thus constitutes the ﬁrst step in the
model-based calibration workﬂow. The target of experiment design is the proper
excitation of the unknown system such that the global model behaviour can be
determined from measured input and output data. Due to the high dimensionality
of the problems and the high costs involved with testbed time, the number of
measurements must be kept to a minimum. Every single design point must be
placed such that the maximum possible information is gained. The quality of the
experiment design is therefore decisive for the model quality and the subsequent
optimisation procedure.

Nonlinear system identiﬁcation: The goal of nonlinear system identiﬁcation is to
obtain a process model from measured data. This can involve the parametrisation
of a model within a given structure alone (e.g. a difference equation) or also the
superordinated determination of the structure itself. Traditionally, mathematical
models have been obtained using physical laws or other theoretical knowledge
about the system (white-box models). This method requires a technical expert for
modelling and simulation because of the demanding complexity of real systems.
However, in many applications conventional modelling is difﬁcult or even impos-
sible due to the lack of precise, formal knowledge about the system. Especially
for components such as combustion engines or batteries, the rapid development
of physical models in an economically competitive environment is quite difﬁcult.
Thus, model-based calibration uses black and grey-box-oriented nonlinear sys-
tem identiﬁcation procedures. Such methods create models based on measured
input and output data of the process and require little or no physical or formal
information.

Controller and observer analysis and design: The ﬁnal step in the model-based
calibration workﬂow is the calibration of maps (feedforward control, in the most
general sense) and the design/parametrisation of controllers (feedback control)
and observers. One immediate advantage of using a model-based approach for
observer design lies in the fact that the task can be accomplished without using
the actual plant.

The following section describes the proposed concepts for model generation (i.e.
optimal experiment design and nonlinear system identiﬁcation) and observer design
using the architecture of LMNs in detail.

114

C. Hametner and S. Jakubek

7.3 State-of-Charge Observer Design

7.3.1 Experiment Design

A suitable experiment design is an important prerequisite for data-based modelling
approaches. In order to achieve a model which describes the underlying process
properly, the system inputs have to excite the process in such a way that all relevant
dynamics and nonlinearities become visible from the measured data. At the same
time, however, the experiment design must ensure compliance with the operational
constraints and limitations of the still unknown system under consideration.

Basically, there are model-free and model-based concepts for the experiment

design:

Model-free DoE:

If no information about the underlying process is available, space
ﬁlling designs are commonly used in nonlinear static system identiﬁcation. These
approaches are generally targeted to cover the whole input space uniformly. For
nonlinear dynamic systems, amplitude modulated pseudorandom binary signals
(APRBS), see e.g. [23], are typically chosen to excite the system dynamics while
the desired operating range is covered.

Model-based DoE: Model-based DoE is more speciﬁcally tailored to the process
to be identiﬁed in that a prior process model (or at least a model structure) is
used to maximize the information gained from experiments. Thus, the signal is
adjusted to a speciﬁc prior process model such that the model parameters can
be estimated from measured data with minimal variance, see e.g. [7, 25]. In this
context, the Fisher information matrix gives a statement about the information
content of data with respect to the covariance of estimated parameters.

For the model-based calibration workﬂow, the second approach was chosen, which
itself is model-based. Thus, the fundamental discrepancy is that a reference model
(prior process model) of the underlying process is required for the modelling of the
very same process. However, model-based experiment design offers some favorable
properties which are highlighted in the following. First, when a physical model (e.g.
from the design phase of a process) or a model from a similar process is available,
model-based DoE helps to increase the information content of the measured data
while reducing the experimentation effort. Second, the compliance with operational
constraints during the experiment (e.g. in order to prevent damage to the plant) can
be taken into account using a model-based approach.

For battery model identiﬁcation, the whole operating range (cell current, SoC) of
the battery has to be covered. One of the main challenges in this context is that the SoC
excitation and the associated operating range directly depend on the excitation of the
cell current itself. While APRB signals are typically used to track the nonlinearities
of the process under consideration, this strategy is no longer feasible for batteries,
since the dependence between cell current and SoC is not taken into account, leading
to insufﬁcient coverage of the operating range of the battery. Consequently, the

7 Data-Driven Methodologies for Battery State-of-Charge Observer Design

115

experiment design has to assure that the variation of the cell current both yields a
proper excitation of the cell and covers the desired SoC operating range, [11].

In [14], the topic of optimal model-based DoE for LMNs is addressed. Thereby,
the optimisation of the experiment design is based on the Fisher information matrix
of the LMN, and the proposed concepts are targeted to generate informative data and
to reduce the experimentation effort as much as possible. For optimal experiment
design for batteries, the gradient based optimisation from [14] cannot be applied
directly, due to the special situation that the excitation of one input channel (state
of charge) is determined by another input signal (cell current). Thus, a model-based
DoE approach using a linear dynamic battery model, which describes the nonlinear
system behaviour of the cell terminal voltage based on the charge/discharge current,
was chosen. The linear battery model was identiﬁed using data from preliminary
tests (step responses). Note that other battery models (e.g. simple equivalent cir-
cuit models) could also be used for the model-based DoE procedure. However, the
results indicate that even a simple linear model helps to improve the model quality
signiﬁcantly, see Sect. 7.3.3.

Based on the linear (prior) battery model, the goal of the optimal experiment
design is to increase the information content of the data while reducing the testing
time is. Thus, the following performance function is minimised

Jopt = α JFIM,init
JFIM,opt

+ (1 − α)

Topt
Tinit

where JFIM,init and JFIM,opt denote the determinant of the Fisher information matrix
JF I M = det (I ) of the initial design and the optimised design, respectively. Thereby,
the FIM is based on the partial derivative of the model output with respect to the
model parameters, c.f. [7]:

(7.1)

(7.2)

I = 1
σ 2

N(cid:2)

k=1

∂ ˆy(k, θ )
∂θ

∂ ˆy(k, θ )
∂θ

T

.

In (7.1) the duration of the testbed run is taken into account by Tinit and Topt. The
design parameter 0 ≤ α ≤ 1 in (7.1) is chosen based on the tradeoff between
accuracy and measurement effort: When α is increased, the information content is
increased; for α = 0 only the testing time is reduced.

The optimisation itself is focused on the appropriate sequential arrangement of
predeﬁned SoC and current levels using the simulated annealing method. These pre-
deﬁned levels are chosen such that a proper distribution of the cell current excitation
is obtained and the complete SoC operating range is covered. The sign of the cell
current (charging or discharging) in each level and the duration of the associated
charge/discharge pulse are obtained from the corresponding SoC level and the previ-
ous design point (i.e. the previous SoC). Thus, the testing time depends directly on the
sequential arrangement of the SoC levels and the associated current levels. Similar
to [21], the search begins with an initial design and proceeds through examination of

116

C. Hametner and S. Jakubek

20

0

4

3

−20

3.5

2.5

100

50

A
n
i

t
n
e
r
r
u
C

V
n
i

e
g
a
t
l

Vo

%
n
i

C
o
S

0

0

2000

4000

6000

8000

time in s

Fig. 7.1 Experiment design: Optimised training data

a sequence of designs, each generated as a perturbation of the preceding one. Thus,
a new candidate state is obtained from a random exchange of the current and SoC
levels. The probability of making a transition from the current state to the new state
is speciﬁed by an acceptance probability function.

Figure 7.1 depicts the optimised training data record (i.e. the choice of the exci-
tation signals and the measured battery voltage). Compared to the initial design, the
determinant of the Fisher information matrix was increased by a factor of ﬁve, while
the testing time was reduced by about 7 %.

7.3.2 Data-Driven Battery Modelling

The second step in the model-based calibration workﬂow is the nonlinear system
identiﬁcation procedure itself.

7 Data-Driven Methodologies for Battery State-of-Charge Observer Design

117

Fig. 7.2 Validity functions of
an LMN comprising six local
models

1

0.8

0.6

2
˜x

0.4

4

0.2

6

0

0

1

5

3

2

0.2

0.4

0.6

0.8

1

˜x1

One integral part of the SoC observer is a mathematical cell model, which
describes the nonlinear dynamic behaviour of the cell terminal voltage based on
the charge/discharge current. Such a model allows, which enables the prediction of
the nonlinear system dynamics of the traction battery, is required for SoC estimation,
since it is not possible to measure the SoC directly. Typical modelling approaches
include electro-chemical models (see e.g. [1, 6, 18]) and equivalent circuit models
(see e.g. [16]). However, since it is not always easy to achieve time-efﬁcient para-
metrisation and real-time application, a data-driven approach has been chosen, which
allows for the application of the proposed concepts for any type of battery chemistry.
The dynamic identiﬁcation algorithm used in this work is based on the architecture
of LMNs, [9]. For practical application, both the integration of prior knowledge and
the interpretability of the individual local models are of great interest. The construc-
tion of LMNs is based on partitioning the operating space into a number of operating
regimes, see Fig. 7.2. The global model output is then formed by a weighted com-
bination of local models, each of which is valid in a certain operating regime. The
architecture of LMNs represents an excellent approach for the integration of various
knowledge sources. Accordingly, the complexity of the identiﬁcation procedure can
be reduced signiﬁcantly when prior knowledge about the underlying system is avail-
able. In practice, this means that some expected behaviour of the modelled system
helps to choose a suitable scheduling variable (e.g. ˜x1 and ˜x2 in Fig. 7.2), select the
structure and ﬁnd appropriate parameters for the model.

This section brieﬂy reviews the proposed LMN and the identiﬁcation of the battery
model for the purpose of SoC estimation. The nonlinear model describes the dynamic
behaviour of the terminal voltage U (t) based on the charge/discharge current I (t) and
other factors (e.g. temperature and SoC). The LMN interpolates between different
local models, each of which valid in a certain region of the input space. Thus, the
battery cell model is based on a partitioning into several local operating regimes (local

118

Fig. 7.3 Logistic discrimi-
nant tree

C. Hametner and S. Jakubek

linear impedance models), represented by the dominant inﬂuence of the scheduling
variables, such as SoC, temperature, etc. This strategy makes it possible to capture
the highly nonlinear dynamic complexity in a computationally efﬁcient way.

In general, each local model of the LMN—indicated by subscript i—consists of

two parts: The validity function Φi (˜x(k)) and its model parameter vector θi .
Thereby, Φi deﬁnes the region of validity of the i-th local model.

The local estimate for the output is obtained by

ˆyi (k) = xT (k)θi ,

(7.3)

where xT (k) denotes the regressor vector. In dynamic system identiﬁcation, the
regressor vector x(k) comprises past system inputs and outputs.

All local estimations ˆyi (k) are used to form the global model output ˆy(k) by

weighted aggregation

where

ˆy(k) =

Φi (k) ˆyi (k),

M(cid:2)

i=1

Φi (k) = Φi (˜x(k))

(7.4)

(7.5)

and M denotes the number of local linear models. Thereby, the elements in ˜x(k) span
the so-called partition space and are chosen on the basis of prior knowledge about
the process and the expected structure of its nonlinearities.

The computation of the validity functions Φi is based on a logistic discriminant
tree. Figure 7.3 depicts a model tree with three local models. Each node corresponds to
a split of the partition space into two parts, and the free ends of the branches represent
the actual local models with their parameter vector θi and their validity functions Φi .
The overall nonlinear model thus comprises M local models and M − 1 nodes that
determine their regions of validity.

7 Data-Driven Methodologies for Battery State-of-Charge Observer Design

119

data
model

3.7

3.6

3.5

3.4

3.3

3.2

3.1

3

V
n
i

e
g
a
t
l

Vo

0

1000

2000

3000

4000

time in s

Fig. 7.4 Model validation/generalisation: Comparison of simulated model output and measured
terminal voltage

Φ1 = ϕ1ϕ2,

Φ2 = 1 − ϕ1,

Φ3 = ϕ1(1 − ϕ2).

(7.6)

(7.7)

(7.8)

(7.9)

(7.10)

For the representation of the discriminant function in the d-th node, a logistic

sigmoid activation function is chosen, c.f. [3]:

with

ϕd (˜x(k)) =

1
1 + exp(−ad (˜x(k)))

ad (˜x(k)) =

(cid:3)
1 ˜xT (k)

(cid:4)

(cid:6)

(cid:5)
ψd0
˜ψd

.

(cid:3)
ψd1 . . . ψd p

(cid:4)

=

Here, ˜ψ T
denotes the weight vector, and ψd0 is called the bias
d
term. The discriminant functions ϕd are used to calculate the validity functions Φi ,
c.f. [26]. The validity functions for the layout in Fig. 7.3 are obtained by (7.6), (7.7)
and (7.8).

The training (i.e. the parametrisation) of the battery model (the LMN) is then
based on a nonlinear optimisation algorithm (for a more detailed description, please
refer to [9] and [10]). The performance of the LMN is highlighted using real mea-
surement data from the lithium-ion cell in Fig. 7.4, which depicts a comparison of

120

C. Hametner and S. Jakubek

measured and simulated model output (validation data). The results indicate the
excellent generalisation capabilities of the proposed LMN training algorithm.

7.3.3 Nonlinear Observer Design

LMNs provide a basis for the development of systematic approaches to stability
analysis and controller/observer design in view of powerful conventional control
theory. Thus, one immediate advantage of using a model-based approach for con-
troller and observer design lies in the fact that the task can be accomplished without
using the actual plant. In [13], LMN-based controller design and associated stability
analysis methodologies for LMNs, which are typically based on an associated local
controller for every local model, are described. In combination with the proposed
LMN, different observer structures can be used, whereby the architecture and inter-
pretability of the local models as a local linearisation of the process helps to reduce the
model/observer complexity. These observer structures include the extended Kalman
ﬁlter (EKF) and the fuzzy observer:
• One widely used approach for SoC estimation of batteries is the extended Kalman
ﬁlter in combination with equivalent circuit models, see e.g. [2, 15, 31, 32]. The
idea of the EKF is to apply conventional Kalman ﬁltering to a nonlinear system
whereby the ﬁlter gain is computed using the local Jacobian of the nonlinear model.
• Similar to the design of local controllers, a fuzzy observer can be used for state
estimation with LMNs, see e.g. [5, 24, 27, 28]. A local observer is designed
for each local linear model using standard Kalman ﬁlter theory. The global ﬁlter
is then derived from a linear combination of the local ﬁlters, [28]. Thus, com-
pared to the EKF, the local observers are time-invariant, which greatly reduces the
computational complexity of the global ﬁlter. Another important advantage of the
fuzzy observer architecture is that the stability analysis of the nonlinear observer
is possible based on Lyapunov stability theory, see e.g. [20, 30].

This section describes the design of a fuzzy observer for SoC estimation. The SoC
observer is based on a combination of the terminal voltage model (as described in
Sect. 7.3.2) and a relative SoC model

SoC(t) = SoC0 +

(cid:7)

t

τ =0

ηI (I )I (τ )
Cn

dτ

(7.11)

where SoC0 denotes the initial SoC, I (t) is the instantaneous cell current, Cn is
the nominal cell capacity, and ηI (I ) is the coulombic efﬁciency (see also [11]). A
schematic of this approach is given in Fig. 7.5, where TBat represents the measured
temperature, and UBat and ˆUBat deﬁne the measured and predicted (simulated) bat-
tery voltage, respectively. Thus, the SoC correction is obtained from a comparison
of the actual terminal voltage to the output of the model.

7 Data-Driven Methodologies for Battery State-of-Charge Observer Design

121

Fig. 7.5 Schematic of SoC observer architecture

The nonlinear observer design involves representation of the nonlinear system as
a local linear state space model, [27]. In combination with the (relative) SoC model
(7.11), an augmented state-space formulation of the nonlinear model is obtained.
Using the relation S OC(k) = S OC(k − 1) + Ts
i(k), the augmented state vector
Cn
(7.12) also comprises SoC, which was originally used as a model input for the
training of the LMN. In addition, the state vector comprises past elements of the
system output:

For each local model, the system matrix

z(k − 1) =

(7.12)



⎢
⎢
⎢
⎢
⎢
⎡

y(k − 1)
y(k − 2)
...
y(k − n)
S OC(k − 1)

⎣

⎤
⎤
⎤
⎤
⎤
⎦

.



⎢
⎢
⎢
⎢
⎢
⎡

a1,i a2,i . . . an,i bS OC,i
0 . . . 0
1
1 . . . 0
0
...
...
...
. . .
0 . . . 0
0

0
0
...
1

⎣

⎤
⎤
⎤
⎤
⎤
⎦

Ai =

(7.13)

and the input matrix

122

C. Hametner and S. Jakubek



⎢
⎢
⎢
⎡

Bi =

b10,i b11,i . . . b20,i b21,i . . . b2m,i ci
0
...
0

0 . . . 0
...
...
. . .
0 . . . 0

0 . . .
...
. . .
0 . . .

0
...
0

0
...

Ts
Cn

⎣

⎤
⎤
⎤
⎦

(7.14)

is obtained from the associated model parameter vector θi (i.e. from the elements of
the numerator and denominator polynomials and the afﬁne term ci of the local afﬁne
models). Accordingly, the input vector u(k) contains current and past elements of
the inputs.

(cid:4)
, the global model output is deﬁned by the output equation

(cid:3)
1 0 . . . 0 0

With C =

y(k) = Cz(k)

(7.15)

and the state equation (of the local models):

z(k) =

Φi (k − 1) {Ai z(k − 1) + Bi u(k)} .

(7.16)

M(cid:2)

i=1

Based on the augmented state-space formulation of the LMN, the state estimate

ˆz(k) is given by the following equations:

∗
z
i

(k) = Ai ˆz(k − 1) + Bi u(k)

(7.17)

ˆz(k) =

Φi (k − 1)

(k) + Ki [y(k) − ˆy(k)]

(7.18)

(cid:15)

M(cid:2)

i=1

(cid:14)

∗
z
i

and

where

ˆy(k) =

∗
Φi (k − 1)Cz
i

(k)

M(cid:2)

i=1

In (7.18), the matrix Ki deﬁnes the Kalman ﬁlter gain of the i-th local model, which
is obtained from

Ki = Ai PT

i CT (CPT

i CT + RT )−1

where Pi is the solution of the discrete-time algebraic Riccati equation (DARE)

Ai Pi AT
i

− Pi − Ai Pi CT (CPi CT + R)−1CPi AT
i

+ Q = 0.

(7.21)

with the covariance matrices of the measurement noise denoted by Q and R.

The performance of the fuzzy observer for SoC estimation is again demonstrated
by means of the validation data record. Now, the SoC is assumed to be unknown,
and the initial state of SoC is chosen at random. The upper graph in Fig. 7.6 shows

(7.19)

(7.20)

7 Data-Driven Methodologies for Battery State-of-Charge Observer Design

123

meas.
est.

%
n
i

C
o
S

100

80

60

40

20

0

100

%
n
i

r
o
r
r
e

50

0

−50

0

1000

2000

3000

4000

time in s

Fig. 7.6 Generalisation data: SoC estimation/correction after random initialisation

a comparison of the actual and estimated SoC of the lithium-ion cell. The estimated
SoC converges to the correct value and the LMN-based fuzzy observer accurately
estimates the unknown SoC.

7.4 Conclusion

This chapter addressed the topic of data-based battery modelling and the associated
state of charge observer design. The complete data-driven calibration workﬂow,
which consists of the experiment design, nonlinear system identiﬁcation and observer
design, was described.

As an important prerequisite for data-based modelling techniques, the target of
the experiment design is a proper excitation of the unknown system. A model-based
experiment design approach, which itself is based on a simple battery model, was
chosen in order to increase the information content of the data while simultaneously
reducing the testing time. Based on the measured data record, the structure and para-
meters of the nonlinear battery model were identiﬁed using the proposed local model
network training algorithm. One important feature of LMNs is that they provide a
basis for systematic approaches to stability analysis and observer design. Based on
an augmented state space representation of the LMN, a fuzzy observer for SoC esti-
mation is designed. The greatest advantage over the widely used extended Kalman
ﬁlter is that the local observers are time-invariant, and linearisation at every sampling
instance is not required, which greatly reduces the computational complexity of the
global ﬁlter.

The performance of the proposed concepts was highlighted using measurement
data from the lithium-ion cell. The results indicate that the battery model provides
excellent generalisation capabilities, and fuzzy observer accurately estimates the
SoC.